<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>هوش آرا | سایت آموزش ریاضی</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* استایل‌های پایه */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        :root {
            --primary-color: #0066cc;
            --hover-color: #0055b3;
            --bg-color: #f9f3e6;
            --text-color: #333;
            --card-bg: #fff;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        /* تم تاریک */
        body.dark-theme {
            --primary-color: #4d94ff;
            --hover-color: #66a3ff;
            --bg-color: #1a1a1a;
            --text-color: #f0f0f0;
            --card-bg: #2a2a2a;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            --hover-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }

        body {
            font-family: 'Vazirmatn', 'Vazir', 'Tahoma', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            direction: rtl;
            position: relative;
            overflow-x: hidden;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 300px;
            min-height: 100vh;
        }

        /* منوی کناری */
        .sidebar {
            background-color: var(--card-bg);
            padding: 20px;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.05);
            z-index: 10;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 30px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            margin-left: 10px;
            animation: pulse 2s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .logo h2 {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.5rem;
        }

        .section-title {
            color: var(--text-color);
            font-size: 1.2rem;
            margin: 15px 0 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #f0f0f0;
            position: relative;
        }

        .section-title:before {
            content: '';
            position: absolute;
            right: 0;
            bottom: -2px;
            width: 50px;
            height: 2px;
            background-color: var(--primary-color);
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            color: var(--text-color);
            text-decoration: none;
            display: block;
            padding: 8px 10px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .sidebar-menu a:hover {
            background-color: rgba(0, 102, 204, 0.1);
            color: var(--primary-color);
            padding-right: 15px;
        }

        /* محتوای اصلی */
        .main-content {
            padding: 30px;
            position: relative;
        }

        /* آیکون تنظیمات و منوی آن */
        .settings-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background-color: var(--card-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            z-index: 100;
        }

        .settings-icon svg {
            width: 24px;
            height: 24px;
            color: var(--primary-color);
            transition: transform 0.5s ease;
        }

        .settings-icon:hover {
            box-shadow: var(--hover-shadow);
        }

        .settings-icon.active svg {
            transform: rotate(180deg);
        }

        .settings-menu {
            position: absolute;
            top: 70px;
            left: 20px;
            width: 180px;
            background-color: var(--card-bg);
            border-radius: 10px;
            box-shadow: var(--hover-shadow);
            padding: 10px 0;
            z-index: 99;
            opacity: 0;
            transform: translateY(-20px);
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .settings-menu.active {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }

        .settings-menu a {
            display: block;
            padding: 10px 15px;
            color: var(--text-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .settings-menu a:hover {
            background-color: rgba(0, 102, 204, 0.1);
            color: var(--primary-color);
        }

        .welcome-header {
            text-align: right;
            margin-bottom: 40px;
        }

        .welcome-header h1 {
            font-size: 2rem;
            color: var(--text-color);
            font-weight: normal;
        }

        /* گرید آیکون‌ها */
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 50px;
        }

        .icon-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.4s ease;
        }

        .icon-container {
            width: 80px;
            height: 80px;
            background-color: var(--primary-color);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .icon-container:after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .icon-button:hover .icon-container:after {
            left: 100%;
        }

        .icon-button:hover {
            transform: translateY(-8px);
        }

        .icon-button:hover .icon-container {
            box-shadow: 0 15px 25px rgba(0, 102, 204, 0.4);
        }

        .icon-button span {
            color: var(--text-color);
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .icon-button:hover span {
            color: var(--primary-color);
        }

        /* بخش آزمون‌ها */
        .exams-section {
            margin-top: 50px;
        }

        .exams-section h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--text-color);
            text-align: right;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .chapter-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 15px;
            box-shadow: var(--shadow);
            transition: all 0.4s ease;
        }

        .chapter-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--hover-shadow);
        }

        .chapter-card h3 {
            margin-bottom: 15px;
            color: var(--text-color);
            font-size: 1rem;
            text-align: center;
        }

        .download-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            font-family: inherit;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .download-button .download-icon {
            margin-left: 5px;
            transition: transform 0.3s ease;
        }

        .download-button:hover {
            background-color: var(--hover-color);
        }

        .download-button:hover .download-icon {
            transform: translateY(3px);
        }

        .download-button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .download-button:hover::after {
            left: 100%;
        }

        .purchase-button {
            background-color: #ff9800;
        }

        .purchase-button:hover {
            background-color: #f57c00;
        }

        .chapter-info {
            font-size: 0.8rem;
            color: #777;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .icons-row {
            display: flex;
            gap: 5px;
        }

        .icons-row svg {
            color: #777;
        }

        /* صفحه درباره ما */
        .about-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .about-page.active {
            opacity: 1;
            visibility: visible;
        }

        .close-about {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--card-bg);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            z-index: 1001;
        }

        .close-about:hover {
            transform: rotate(90deg);
            box-shadow: var(--hover-shadow);
        }

        /* هیرو سکشن */
        .about-hero {
            height: 100vh;
            width: 100%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .particles-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0,102,204,0.9) 0%, rgba(0,46,93,0.9) 100%);
            opacity: 0.8;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
            max-width: 800px;
            padding: 0 20px;
        }

        .logo-animation {
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }

        .animated-logo {
            width: 100%;
            height: 100%;
        }

        .logo-circle {
            animation: pulse 2s infinite ease-in-out;
        }

        .logo-path {
            animation: float 3s infinite ease-in-out;
        }

        .animated-title {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 1s forwards 0.5s;
        }

        .animated-subtitle {
            font-size: 1.5rem;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 1s forwards 0.8s;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white;
            opacity: 0;
            animation: fadeIn 1s forwards 1.5s;
        }

        .scroll-arrow {
            margin-top: 10px;
            animation: bounce 2s infinite;
        }

        /* سکشن‌های محتوا */
        .about-sections {
            padding: 50px 0;
        }

        .about-section {
            display: flex;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto 100px;
            padding: 0 20px;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .about-section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .section-content {
            flex: 1;
            padding: 0 30px;
        }

        .section-image {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
        }

        .section-title {
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
        }

        .section-title:after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary-color);
            transition: width 0.5s ease;
        }

        html[lang="en"] .section-title:after {
            right: auto;
            left: 0;
        }

        .about-section:hover .section-title:after {
            width: 100%;
        }

        .about-section p {
            line-height: 1.8;
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        /* سکشن ماموریت */
        .floating-shapes {
            position: relative;
            width: 300px;
            height: 300px;
        }

        .shape {
            position: absolute;
            font-size: 3rem;
            color: var(--primary-color);
            opacity: 0.8;
            animation: float 6s infinite ease-in-out;
        }

        .shape-1 {
            top: 20%;
            left: 20%;
            animation-delay: 0s;
        }

        .shape-2 {
            top: 70%;
            left: 30%;
            animation-delay: 1s;
        }

        .shape-3 {
            top: 40%;
            left: 70%;
            animation-delay: 2s;
        }

        .shape-4 {
            top: 10%;
            left: 60%;
            animation-delay: 3s;
        }

        .shape-5 {
            top: 80%;
            left: 60%;
            animation-delay: 4s;
        }

        /* سکشن دبیر ریاضی - طراحی جدید */
        .teacher-section {
            position: relative;
            padding: 50px 0;
            background: linear-gradient(to bottom, transparent, rgba(144, 12, 63, 0.05), transparent);
            border-radius: 20px;
            margin: 80px 0;
        }

        .teacher-profile {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .teacher-image-container {
            width: 220px;
            height: 220px;
            position: relative;
            z-index: 2;
        }

        .teacher-portrait {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(144, 12, 63, 0.3);
            position: relative;
            transition: all 0.5s ease;
        }

        .teacher-portrait:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(144, 12, 63, 0.4);
        }

        .teacher-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s ease;
        }

        .math-symbols {
            position: absolute;
            width: 300px;
            height: 300px;
        }

        .math-symbol {
            position: absolute;
            font-size: 2rem;
            color: #900c3f;
            opacity: 0.7;
            animation: floatSymbol 8s infinite ease-in-out;
        }

        @keyframes floatSymbol {
            0% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -15px) rotate(10deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        .math-symbol:nth-child(1) { top: -30px; left: 20px; animation-delay: 0s; }
        .math-symbol:nth-child(2) { top: 20px; right: -20px; animation-delay: 1s; }
        .math-symbol:nth-child(3) { bottom: 0; left: 50px; animation-delay: 2s; }
        .math-symbol:nth-child(4) { bottom: 50px; right: 0; animation-delay: 3s; }
        .math-symbol:nth-child(5) { top: 50px; left: -20px; animation-delay: 4s; }

        .teacher-info {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .teacher-name {
            font-size: 2rem;
            font-weight: bold;
            color: #900c3f;
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }

        .teacher-name:after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(to right, #900c3f, #f27a9e);
            transition: width 0.5s ease;
        }

        .teacher-profile:hover .teacher-name:after {
            width: 100%;
        }

        .teacher-title {
            font-size: 1.2rem;
            color: var(--text-color);
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .teacher-bio {
            line-height: 1.8;
            margin-bottom: 25px;
            position: relative;
            padding-right: 20px;
            border-right: 3px solid rgba(144, 12, 63, 0.3);
        }

        .math-formula-showcase {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .formula-card {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            width: calc(33.333% - 10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 120px;
        }

        .formula-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: var(--hover-shadow);
        }

        .formula {
            font-size: 1.5rem;
            font-weight: bold;
            color: #900c3f;
            margin-bottom: 10px;
        }

        .formula-name {
            font-size: 0.9rem;
            color: var(--text-color);
            text-align: center;
        }

     /* استایل‌های بخش برنامه‌نویس */
.developer-section {
  position: relative;
  overflow: hidden;
}

.developer-section::before {
  content: '';
  position: absolute;
  width: 400px;
  height: 400px;
  background: radial-gradient(circle, rgba(0,102,204,0.08) 0%, transparent 70%);
  top: -100px;
  right: -200px;
  border-radius: 50%;
  z-index: 0;
}

.developer-section::after {
  content: '';
  position: absolute;
  width: 300px;
  height: 300px;
  background: radial-gradient(circle, rgba(0,102,204,0.06) 0%, transparent 70%);
  bottom: -150px;
  left: -150px;
  border-radius: 50%;
  z-index: 0;
}

.developer-profile {
  display: flex;
  gap: 35px;
  margin-bottom: 40px;
  align-items: center;
  position: relative;
  z-index: 1;
}

.developer-image-container {
  width: 220px;
  height: 220px;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: var(--shadow);
  position: relative;
  perspective: 1000px;
  transform-style: preserve-3d;
  transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  border: 5px solid var(--card-bg);
}

.developer-image-container:hover {
  transform: rotateY(10deg) rotateX(5deg) scale(1.05);
  box-shadow: var(--hover-shadow);
}

.developer-image-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, rgba(0,102,204,0.5) 0%, transparent 70%);
  z-index: 1;
}

.developer-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.developer-image-container:hover .developer-image {
  transform: scale(1.08);
}

.developer-info {
  flex: 1;
}

.developer-name {
  font-size: 1.8rem;
  font-weight: bold;
  color: var(--primary-color);
  margin-bottom: 12px;
  position: relative;
  display: inline-block;
}

.developer-name::after {
  content: '';
  position: absolute;
  bottom: -5px;
  right: 0;
  width: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--primary-color), transparent);
  transition: width 0.5s ease;
}

.developer-section:hover .developer-name::after {
  width: 100%;
}

.developer-title {
  font-size: 1.1rem;
  color: var(--text-color);
  opacity: 0.8;
  margin-bottom: 15px;
  display: inline-block;
  padding: 5px 15px;
  background-color: rgba(0, 102, 204, 0.08);
  border-radius: 20px;
}

.social-links {
  display: flex;
  gap: 15px;
  margin-top: 20px;
}

.social-link {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background-color: var(--card-bg);
  color: var(--primary-color);
  box-shadow: var(--shadow);
  transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.3s ease;
}

.social-link:hover {
  transform: translateY(-8px) scale(1.1);
  box-shadow: 0 12px 20px rgba(0, 102, 204, 0.2);
}

/* استایل‌های نمایش کد */
.coding-showcase {
  width: 100%;
  margin-top: 40px;
  position: relative;
}

.language-tabs {
  display: flex;
  margin-bottom: 25px;
  position: relative;
  z-index: 5;
  flex-wrap: wrap;
  gap: 12px;
}

.language-tab {
  padding: 14px 22px;
  background-color: var(--card-bg);
  color: var(--text-color);
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-family: inherit;
  font-size: 1rem;
  font-weight: 500;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  transform-origin: bottom;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
}

.language-tab::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(0,102,204,0.05) 0%, transparent 100%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.language-tab.active {
  background-color: var(--primary-color);
  color: white;
  transform: translateY(-5px) scale(1.05);
  box-shadow: 0 10px 25px rgba(0, 102, 204, 0.25);
  z-index: 2;
}

.language-tab:hover:not(.active) {
  background-color: rgba(0, 102, 204, 0.08);
  transform: translateY(-3px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
}

.language-tab:hover::before {
  opacity: 1;
}

.language-tab .language-icon {
  width: 24px;
  height: 24px;
  margin-left: 10px;
  vertical-align: middle;
  transition: transform 0.3s ease;
}

.language-tab:hover .language-icon {
  transform: rotate(10deg);
}

.code-window {
  width: 100%;
  height: 360px;
  background-color: #1e1e1e;
  border-radius: 15px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
  transition: all 0.5s ease;
  transform: translateY(0);
}

.code-window:hover {
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
  transform: translateY(-5px);
}

.code-window-header {
  height: 40px;
  background-color: #2d2d2d;
  display: flex;
  align-items: center;
  padding: 0 15px;
  position: relative;
  z-index: 2;
}

.window-controls {
  display: flex;
  gap: 8px;
}

.control-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  transition: transform 0.3s ease;
}

.control-dot:hover {
  transform: scale(1.2);
}

.control-dot.red {
  background-color: #ff5f56;
}

.control-dot.yellow {
  background-color: #ffbd2e;
}

.control-dot.green {
  background-color: #27c93f;
}

.window-title {
  flex: 1;
  text-align: center;
  color: #ddd;
  font-size: 0.9rem;
  font-weight: 500;
}

.code-content {
  padding: 20px;
  font-family: 'Consolas', 'Monaco', monospace;
  font-size: 14px;
  line-height: 1.6;
  color: #d4d4d4;
  height: calc(100% - 40px);
  overflow: auto;
  position: relative;
  display: none;
  background-color: #1e1e1e;
  background-image: linear-gradient(rgba(255, 255, 255, 0.02) 50%, transparent 50%), linear-gradient(90deg, rgba(255, 255, 255, 0.01), transparent 20px);
  background-size: 100% 3em, 100% 100%;
}

.code-content.active {
  display: block;
  animation: fadeIn 0.5s ease;
}

.code-line {
  display: flex;
  margin-bottom: 5px;
  white-space: nowrap;
  opacity: 0;
  transform: translateX(-20px);
  animation: slideInCode 0.5s forwards;
  position: relative;
}

.line-number {
  color: #858585;
  min-width: 30px;
  text-align: right;
  margin-left: 15px;
  user-select: none;
  opacity: 0.6;
}

.code-text {
  flex: 1;
  position: relative;
}

.keyword { color: #569cd6; }
.function { color: #dcdcaa; }
.string { color: #ce9178; }
.comment { color: #6a9955; }
.variable { color: #9cdcfe; }
.property { color: #9cdcfe; }
.number { color: #b5cea8; }
.tag { color: #569cd6; }
.attribute { color: #9cdcfe; }
.value { color: #ce9178; }
.selector { color: #d7ba7d; }

.typing-cursor {
  display: inline-block;
  width: 2px;
  height: 18px;
  background-color: #d4d4d4;
  animation: blink 1s infinite;
  vertical-align: middle;
  margin-left: 2px;
}

/* استایل‌های نمایش ترکیب کدهای سایت */
.language-progress {
  margin-top: 50px;
  background-color: var(--card-bg);
  border-radius: 18px;
  padding: 30px;
  box-shadow: var(--shadow);
  transition: all 0.5s ease;
  position: relative;
  overflow: hidden;
  z-index: 1;
}

.language-progress:hover {
  box-shadow: var(--hover-shadow);
  transform: translateY(-8px);
}

.language-progress::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(0,102,204,0.03) 0%, transparent 70%);
  animation: rotate 60s linear infinite;
  z-index: 0;
}

.progress-title {
  font-size: 1.5rem;
  margin-bottom: 25px;
  color: var(--primary-color);
  position: relative;
  z-index: 2;
  display: inline-block;
}

.progress-title::after {
  content: '';
  position: absolute;
  bottom: -8px;
  right: 0;
  height: 3px;
  width: 40px;
  background-color: var(--primary-color);
  transition: width 0.5s ease;
}

.language-progress:hover .progress-title::after {
  width: 100%;
}

.progress-bars {
  display: flex;
  flex-direction: column;
  gap: 25px;
  position: relative;
  z-index: 2;
}

.progress-item {
  display: flex;
  flex-direction: column;
  transition: transform 0.3s ease;
}

.progress-item:hover {
  transform: translateX(5px);
}

.progress-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: 12px;
  align-items: center;
}

.progress-name {
  font-weight: 500;
  display: flex;
  align-items: center;
  font-size: 1.1rem;
}

.progress-name img {
  width: 24px;
  height: 24px;
  margin-left: 12px;
  transition: transform 0.3s ease;
}

.progress-item:hover .progress-name img {
  transform: rotate(15deg) scale(1.2);
}

.progress-percentage {
  font-weight: 600;
  color: var(--primary-color);
  font-size: 1.1rem;
  background: rgba(0, 102, 204, 0.1);
  padding: 5px 12px;
  border-radius: 30px;
  min-width: 60px;
  text-align: center;
  transition: all 0.3s ease;
}

.progress-item:hover .progress-percentage {
  background: rgba(0, 102, 204, 0.2);
  box-shadow: 0 3px 10px rgba(0, 102, 204, 0.1);
  transform: scale(1.05);
}

.progress-bar {
  height: 12px;
  background-color: rgba(0, 0, 0, 0.05);
  border-radius: 10px;
  overflow: hidden;
  position: relative;
  z-index: 1;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

.progress-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  background: linear-gradient(90deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 100%);
  animation: shine 3s infinite linear;
  transform: translateX(-100%);
  pointer-events: none;
}

.progress-fill {
  height: 100%;
  width: 0;
  border-radius: 6px;
  transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1);
  position: relative;
  background-image: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.1) 75%);
  background-size: 20px 100%;
  animation: moveStripes 40s linear infinite;
}

@keyframes moveStripes {
  from { background-position: 0 0; }
  to { background-position: 1000px 0; }
}

.progress-fill.html { background-color: #e34f26; }
.progress-fill.css { background-color: #264de4; }
.progress-fill.js { background-color: #f7df1e; }
.progress-fill.svg { background-color: #ffb13b; }

.progress-info {
  margin-top: 10px;
  font-size: 0.95rem;
  color: var(--text-color);
  opacity: 0.85;
  transition: opacity 0.3s ease;
}

.progress-item:hover .progress-info {
  opacity: 1;
}

@keyframes slideInCode {
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes blink {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}

@keyframes shine {
  to {
    transform: translateX(100%);
  }
}


        /* Designer Section - Completely Redesigned */
        .designer-section {
            position: relative;
            background: linear-gradient(to bottom, transparent, rgba(255, 152, 0, 0.05), transparent);
            padding: 50px 0;
            border-radius: 30px;
            margin: 80px 0;
        }

        .designer-profile {
            display: flex;
            gap: 40px;
            margin-bottom: 50px;
            align-items: center;
            position: relative;
        }

        .designer-image-container {
            width: 250px;
            height: 250px;
            position: relative;
            z-index: 2;
        }

        .designer-portrait {
            width: 100%;
            height: 100%;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.5s ease;
        }

        .designer-portrait:hover {
            transform: perspective(1000px) rotateY(10deg) rotateX(5deg);
        }

        .designer-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s ease;
        }

        .designer-portrait:hover .designer-image {
            transform: scale(1.05);
        }

        .designer-frame {
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            border: 3px solid #ff9800;
            border-radius: 25px;
            z-index: -1;
            animation: frameRotate 10s infinite linear;
        }

        @keyframes frameRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .designer-tools {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .tool-icon {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: floatAround 15s infinite linear;
            z-index: 3;
        }

        .tool-icon img {
            width: 25px;
            height: 25px;
        }

        .tool-icon:nth-child(1) {
            top: -20px;
            left: 20%;
            animation-delay: 0s;
        }

        .tool-icon:nth-child(2) {
            top: 30%;
            right: -20px;
            animation-delay: -3s;
        }

        .tool-icon:nth-child(3) {
            bottom: -10px;
            left: 30%;
            animation-delay: -6s;
        }

        .tool-icon:nth-child(4) {
            top: 20%;
            left: -20px;
            animation-delay: -9s;
        }

        .tool-icon:nth-child(5) {
            bottom: 30%;
            right: -10px;
            animation-delay: -12s;
        }

        @keyframes floatAround {
            0% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(10px, -10px) scale(1.1); }
            50% { transform: translate(0, 0) scale(1); }
            75% { transform: translate(-10px, 10px) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }

        .designer-info {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .designer-name {
            font-size: 2rem;
            font-weight: bold;
            color: #ff9800;
            margin-bottom: 15px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
            display: inline-block;
        }

        .designer-name::after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff9800, #ffcc80);
            transition: width 0.5s ease;
        }

        .designer-profile:hover .designer-name::after {
            width: 100%;
        }

        .designer-title {
            font-size: 1.2rem;
            color: var(--text-color);
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .designer-bio {
            line-height: 1.8;
            margin-bottom: 25px;
            position: relative;
            padding-right: 20px;
            border-right: 3px solid rgba(255, 152, 0, 0.3);
        }

        .designer-social {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .designer-social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: var(--card-bg);
            color: #ff9800;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .designer-social-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff9800, #ffcc80);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .designer-social-link:hover {
            transform: translateY(-8px) rotate(360deg);
            color: white;
            box-shadow: 0 10px 20px rgba(255, 152, 0, 0.3);
        }

        .designer-social-link:hover::before {
            opacity: 1;
        }

        /* Design Showcase */
        .design-showcase {
            margin-top: 50px;
            position: relative;
        }

        .design-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 200px);
            gap: 20px;
            margin-bottom: 30px;
        }

        .design-item {
            background-color: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow);
            transition: all 0.5s ease;
            cursor: pointer;
        }

        .design-item:hover {
            transform: scale(1.03);
            box-shadow: var(--hover-shadow);
            z-index: 2;
        }

        .design-item:nth-child(1) {
            grid-column: 1 / 2;
            grid-row: 1 / 3;
        }

        .design-item:nth-child(4) {
            grid-column: 3 / 4;
            grid-row: 1 / 3;
        }

        .design-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s ease;
        }

        .design-item:hover .design-image {
            transform: scale(1.1);
        }

        .design-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
            opacity: 0;
            transition: opacity 0.5s ease;
            display: flex;
            align-items: flex-end;
            padding: 20px;
            color: white;
        }

        .design-item:hover .design-overlay {
            opacity: 1;
        }

        .design-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .design-tag {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* استایل‌های صفحه محاسبات عددی - هماهنگ با تم سایت */
        .calculation-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color, #f9f9f9);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease;
            overflow-y: auto;
            font-family: var(--font-family, 'Vazirmatn', 'Tahoma', Arial, sans-serif);
        }

        .calculation-page.active {
            opacity: 1;
            visibility: visible;
        }

        .calculation-header {
            background-color: var(--card-bg, #ffffff);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .calculation-title {
            font-size: 1.5rem;
            color: var(--primary-color, #0066cc);
            font-weight: bold;
            position: relative;
            padding-right: 15px;
        }

        .calculation-title::before {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 70%;
            background-color: var(--primary-color, #0066cc);
            border-radius: 3px;
        }

        .back-button {
            display: flex;
            align-items: center;
            background: none;
            border: none;
            color: var(--text-color, #333333);
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 8px;
        }

        .back-button:hover {
            color: var(--primary-color, #0066cc);
            background-color: rgba(0,0,0,0.05);
        }

        .back-button svg {
            margin-left: 8px;
        }

        .calculation-content {
            flex: 1;
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        /* تب‌های محاسبات */
        .calculation-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .calc-tab-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px 25px;
            background-color: var(--card-bg, #ffffff);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            min-width: 200px;
            flex: 1;
            color: var(--text-color, #333333);
        }

        .calc-tab-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .calc-tab-btn.active {
            background-color: var(--primary-color, #0066cc);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,102,204,0.3);
        }

        .calc-tab-btn i {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .calc-tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .calc-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Container استایل‌های عمومی */
        .calculator-container,
        .geometry-container,
        .equations-container {
            background-color: var(--card-bg, #ffffff);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .calculator-header,
        .geometry-header,
        .equations-header {
            margin-bottom: 25px;
            text-align: center;
        }

        .calculator-header h2,
        .geometry-header h2,
        .equations-header h2 {
            font-size: 1.8rem;
            color: var(--primary-color, #0066cc);
            margin-bottom: 10px;
        }

        .calculator-header p,
        .geometry-header p,
        .equations-header p {
            color: var(--text-color, #333333);
            opacity: 0.8;
        }

        /* فرم‌های ورودی */
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-bottom: 15px;
        }

        .form-group label {
            font-weight: 500;
            color: var(--text-color, #333333);
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: var(--card-bg, #ffffff);
            color: var(--text-color, #333333);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color, #0066cc);
            box-shadow: 0 0 0 3px rgba(0,102,204,0.2);
        }

        .unit {
            font-weight: 500;
            color: var(--gray-600, #6c757d);
        }

        /* دکمه محاسبه */
        .calculate-btn {
            background-color: var(--primary-color, #0066cc);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            box-shadow: 0 4px 10px rgba(0,102,204,0.2);
            width: 100%;
        }

        .calculate-btn:hover {
            background-color: var(--primary-dark, #004c99);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,102,204,0.3);
        }

        /* نتایج */
        .result-container,
        .shape-results,
        .equation-results {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .result-item {
            background-color: var(--gray-100, #f8f9fa);
            border-radius: 12px;
            padding: 15px;
            min-width: 200px;
            flex: 1;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            text-align: center;
            transition: all 0.3s ease;
        }

        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .result-label {
            font-weight: 600;
            color: var(--primary-color, #0066cc);
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-color, #333333);
            margin-bottom: 10px;
        }

        .result-formula {
            font-size: 0.9rem;
            color: var(--gray-600, #6c757d);
            font-family: 'Courier New', monospace;
        }

       /* استایل‌های ماشین حساب مهندسی */
.calculator-body {
    max-width: 500px;
    margin: 0 auto;
    background-color: var(--card-bg, #ffffff);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.calculator-screen {
    background-color: var(--gray-100, #f8f9fa);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    text-align: right;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
    min-height: 100px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.calculator-history {
    font-size: 0.9rem;
    color: var(--gray-600, #6c757d);
    min-height: 20px;
    margin-bottom: 10px;
    overflow-x: auto;
    white-space: nowrap;
}

.calculator-display {
    font-size: 2.5rem;
    font-weight: bold;
    color: var(--text-color, #333333);
    min-height: 50px;
    overflow-x: auto;
    white-space: nowrap;
}

.calculator-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-gap: 12px;
    margin-bottom: 20px;
}

.calculator-btn {
    background-color: var(--gray-100, #f8f9fa);
    border: none;
    border-radius: 12px;
    padding: 15px;
    font-size: 1.3rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 60px;
}

.calculator-btn:hover {
    background-color: var(--gray-200, #e9ecef);
    transform: translateY(-3px);
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
}

.calculator-btn:active {
    transform: translateY(1px);
    box-shadow: 0 2px 3px rgba(0,0,0,0.1);
}

.calculator-btn.function {
    background-color: var(--gray-200, #e9ecef);
    color: var(--danger-color, #f44336);
    font-weight: bold;
}

.calculator-btn.operator {
    background-color: var(--primary-light, #e6f0ff);
    color: var(--primary-color, #0066cc);
    font-weight: bold;
    font-size: 1.5rem;
}

.calculator-btn.equal {
    background-color: var(--primary-color, #0066cc);
    color: white;
    grid-column: span 2;
    font-size: 1.5rem;
}

.scientific-functions {
    margin-top: 20px;
    border-top: 1px solid var(--gray-200, #e9ecef);
    padding-top: 20px;
}

.scientific-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-gap: 12px;
}

.scientific-btn {
    background-color: var(--primary-light, #e6f0ff);
    border: none;
    border-radius: 12px;
    padding: 12px;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--primary-color, #0066cc);
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.scientific-btn:hover {
    background-color: rgba(0,102,204,0.2);
    transform: translateY(-3px);
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
}

.scientific-btn:active {
    transform: translateY(1px);
    box-shadow: 0 2px 3px rgba(0,0,0,0.1);
}

/* استایل برای حالت تاریک */
body.dark-theme .calculator-screen {
    background-color: rgba(255, 255, 255, 0.05);
    color: var(--text-color, #f0f0f0);
}

body.dark-theme .calculator-btn {
    background-color: rgba(255, 255, 255, 0.05);
    color: var(--text-color, #f0f0f0);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

body.dark-theme .calculator-btn.function {
    background-color: rgba(244, 67, 54, 0.2);
    color: #ff8a80;
}

body.dark-theme .calculator-btn.operator {
    background-color: rgba(0, 102, 204, 0.2);
    color: #66b0ff;
}

body.dark-theme .scientific-btn {
    background-color: rgba(0, 102, 204, 0.15);
    color: #66b0ff;
    border: 1px solid rgba(0, 102, 204, 0.2);
}

/* واکنش‌گرایی برای ماشین حساب */
@media (max-width: 576px) {
    .calculator-body {
        padding: 15px;
    }

    .calculator-screen {
        padding: 15px;
    }

    .calculator-display {
        font-size: 2rem;
    }

    .calculator-grid {
        grid-gap: 8px;
    }

    .calculator-btn {
        padding: 10px;
        font-size: 1.1rem;
        height: 50px;
    }

    .scientific-grid {
        grid-gap: 8px;
    }

    .scientific-btn {
        padding: 8px;
        font-size: 0.9rem;
        height: 40px;
    }
}


        /* محاسبه مساحت و محیط */
        .geometry-body {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .shape-selector {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 10px;
        }

        .shape-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100px;
            height: 100px;
            background-color: var(--gray-100, #f8f9fa);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .shape-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .shape-option.active {
            background-color: var(--primary-color, #0066cc);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,102,204,0.3);
        }

        .shape-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .shape-calculator {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
        }

        .shape-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .shape-form.active {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .shape-illustration {
            flex: 1;
            min-width: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--gray-100, #f8f9fa);
            border-radius: 12px;
            padding: 20px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .shape-inputs {
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* حل معادلات */
        .equations-body {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .equation-type-selector {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }

        .equation-type-btn {
            background-color: var(--gray-100, #f8f9fa);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 12px;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            text-align: center;
            min-width: 200px;
            flex: 1;
        }

        .equation-type-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .equation-type-btn.active {
            background-color: var(--primary-color, #0066cc);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,102,204,0.3);
        }

        .equation-preview {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            margin-top: 10px;
            color: var(--gray-600, #6c757d);
        }

        .equation-type-btn.active .equation-preview {
            color: rgba(255, 255, 255, 0.8);
        }

        .equation-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .equation-form.active {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .equation-illustration {
            flex: 1;
            min-width: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--gray-100, #f8f9fa);
            border-radius: 12px;
            padding: 20px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .equation-display {
            font-family: 'Courier New', monospace;
            font-size: 2rem;
            color: var(--text-color, #333333);
        }

        .coefficient {
            color: var(--primary-color, #0066cc);
            font-weight: bold;
        }

        .variable {
            color: #e91e63;
            font-style: italic;
        }

        .operator {
            color: var(--gray-600, #6c757d);
            margin: 0 5px;
        }

        .constant {
            color: #4caf50;
            font-weight: bold;
        }

        .equation-inputs {
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* پشتیبانی از زبان انگلیسی */
        .fa-lang {
            display: block;
        }

        .en-lang {
            display: none;
        }

        html[lang="en"] .fa-lang {
            display: none;
        }

        html[lang="en"] .en-lang {
            display: block;
        }

        html[lang="en"] .calculation-page {
            direction: ltr;
        }

        html[lang="en"] .calculation-title::before {
            right: auto;
            left: 0;
        }

        html[lang="en"] .back-button svg {
            margin-left: 0;
            margin-right: 8px;
        }

        /* واکنش‌گرایی */
        @media (max-width: 992px) {
            .calculation-content {
                padding: 20px;
            }

            .calc-tab-btn {
                min-width: 150px;
            }

            .shape-option {
                width: 80px;
                height: 80px;
            }
        }

        @media (max-width: 768px) {
            .calculation-header {
                padding: 15px;
            }

            .calculation-title {
                font-size: 1.3rem;
            }

            .calculator-container,
            .geometry-container,
            .equations-container {
                padding: 20px;
            }

            .calculator-header h2,
            .geometry-header h2,
            .equations-header h2 {
                font-size: 1.5rem;
            }

            .calculator-display {
                font-size: 1.8rem;
            }

            .calculator-btn {
                padding: 12px;
                font-size: 1.1rem;
            }

            .scientific-btn {
                padding: 10px;
                font-size: 0.9rem;
            }

            .equation-display {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 576px) {
            .calculation-content {
                padding: 15px;
            }

            .calc-tab-btn {
                flex: 100%;
            }

            .shape-option {
                width: 70px;
                height: 70px;
                font-size: 0.9rem;
            }

            .shape-icon {
                font-size: 1.5rem;
            }

            .shape-form.active,
            .equation-form.active {
                flex-direction: column;
            }

            .calculator-btn {
                padding: 10px;
                font-size: 1rem;
            }

            .scientific-btn {
                padding: 8px;
                font-size: 0.8rem;
            }

            .result-value {
                font-size: 1.3rem;
            }
        }

        /* تم تاریک */
        body.dark-theme .calculation-page {
            background-color: var(--bg-color, #1a1a1a);
        }

        body.dark-theme .calculation-header,
        body.dark-theme .calculator-container,
        body.dark-theme .geometry-container,
        body.dark-theme .equations-container {
            background-color: var(--card-bg, #2a2a2a);
        }

        body.dark-theme .calculator-screen,
        body.dark-theme .shape-illustration,
        body.dark-theme .equation-illustration {
            background-color: rgba(255, 255, 255, 0.05);
        }

        body.dark-theme .calculator-btn,
        body.dark-theme .shape-option,
        body.dark-theme .equation-type-btn {
            background-color: var(--card-bg, #2a2a2a);
            border-color: rgba(255, 255, 255, 0.1);
        }

        body.dark-theme .calculator-btn.function {
            background-color: rgba(255, 255, 255, 0.1);
        }

        body.dark-theme .calculator-btn.operator {
            background-color: rgba(0, 102, 204, 0.3);
        }

        body.dark-theme .scientific-btn {
            background-color: rgba(0, 102, 204, 0.2);
            border-color: rgba(0, 102, 204, 0.3);
        }

        body.dark-theme .result-item {
            background-color: rgba(255, 255, 255, 0.05);
        }

        body.dark-theme .input-group input {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color, #f0f0f0);
        }

/* استایل‌های صفحه رسم نمودار */
.graph-page {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-color);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease;
    overflow-y: auto;
    font-family: var(--font-family);
    color: var(--text-color);
    line-height: 1.6;
    direction: rtl;
}

.graph-page.active {
    opacity: 1;
    visibility: visible;
}

.graph-page .graph-header {
    background-color: var(--card-bg);
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.graph-page .graph-title {
    font-size: 1.5rem;
    color: var(--primary-color);
    font-weight: bold;
}

.graph-page .back-button {
    display: flex;
    align-items: center;
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    font-family: inherit;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.graph-page .back-button:hover {
    color: var(--primary-color);
}

.graph-page .back-button svg {
    margin-left: 8px;
}

.graph-page .graph-content {
    flex: 1;
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
}

/* برای پشتیبانی از زبان انگلیسی */
.graph-page .fa-lang {
    display: block;
}

.graph-page .en-lang {
    display: none;
}

html[lang="en"] .graph-page .fa-lang {
    display: none;
}

html[lang="en"] .graph-page .en-lang {
    display: block;
}

html[lang="en"] .graph-page {
    direction: ltr;
}

html[lang="en"] .graph-page .back-button svg {
    margin-left: 0;
    margin-right: 8px;
}

/* هدر */
.graph-page .logo {
    display: flex;
    align-items: center;
    gap: 12px;
}

.graph-page .logo-icon {
    width: 40px;
    height: 40px;
    animation: graph-pulse 2s infinite ease-in-out;
}

@keyframes graph-pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.graph-page .logo h1 {
    font-size: 1.8rem;
    color: var(--primary-color);
    font-weight: 700;
}

/* کارت‌ها */
.graph-page .card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    box-shadow: var(--card-shadow);
    margin-bottom: 20px;
    overflow: hidden;
    transition: box-shadow var(--transition-speed), transform var(--transition-speed);
}

.graph-page .card:hover {
    box-shadow: var(--card-shadow-hover);
}

.graph-page .card-header {
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--gray-200);
}

.graph-page .card-header h2 {
    font-size: 1.4rem;
    color: var(--primary-color);
    font-weight: 600;
}

.graph-page .card-body {
    padding: 20px;
}

/* کارت تابع */
.graph-page .function-tabs {
    display: flex;
    gap: 5px;
}

.graph-page .tab-btn {
    background-color: var(--gray-100);
    border: none;
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-family: var(--font-family);
    font-size: 0.9rem;
    color: var(--text-color);
    transition: all var(--transition-speed);
}

.graph-page .tab-btn.active {
    background-color: var(--primary-color);
    color: white;
}

.graph-page .tab-btn:hover:not(.active) {
    background-color: var(--gray-200);
}

.graph-page .tab-content {
    display: none;
}

.graph-page .tab-content.active {
    display: block;
    animation: graph-fadeIn 0.5s ease;
}

@keyframes graph-fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.graph-page .function-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
}

.graph-page .function-label {
    font-size: 1.2rem;
    font-weight: 500;
    min-width: 60px;
}

.graph-page .function-input-wrapper {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
}

.graph-page .function-input {
    width: 100%;
    padding: 10px 15px;
    border: 1px solid var(--gray-300);
    border-radius: 25px;
    font-family: var(--font-family);
    font-size: 1rem;
    background-color: var(--card-bg);
    color: var(--text-color);
    transition: all var(--transition-speed);
}

.graph-page .function-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px var(--primary-light);
}

.graph-page .function-color-picker {
    margin-right: 10px;
}

.graph-page .function-color-picker input[type="color"] {
    width: 30px;
    height: 30px;
    border: none;
    border-radius: 50%;
    background: none;
    cursor: pointer;
}

.graph-page .draw-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 25px;
    padding: 10px 20px;
    font-family: var(--font-family);
    font-size: 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all var(--transition-speed);
}

.graph-page .draw-btn:hover {
    background-color: var(--primary-dark);
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.graph-page .draw-btn:active {
    transform: translateY(1px);
}

.graph-page .function-list {
    margin: 15px 0;
    max-height: 150px;
    overflow-y: auto;
}

.graph-page .function-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 15px;
    background-color: var(--gray-100);
    border-radius: 8px;
    margin-bottom: 8px;
    transition: all var(--transition-speed);
}

.graph-page .function-item:hover {
    background-color: var(--gray-200);
}

.graph-page .function-item-color {
    width: 15px;
    height: 15px;
    border-radius: 50%;
    margin-right: 10px;
}

.graph-page .function-item-text {
    flex: 1;
    font-family: 'Courier New', monospace;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.graph-page .function-item-actions {
    display: flex;
    gap: 5px;
}

.graph-page .function-item-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--gray-600);
    transition: color var(--transition-speed);
}

.graph-page .function-item-btn:hover {
    color: var(--primary-color);
}

.graph-page .function-item-btn.delete-btn:hover {
    color: var(--danger-color);
}

.graph-page .function-actions {
    display: flex;
    gap: 10px;
}

.graph-page .action-btn {
    background-color: var(--gray-200);
    border: none;
    border-radius: 20px;
    padding: 8px 15px;
    font-family: var(--font-family);
    font-size: 0.9rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all var(--transition-speed);
    color: var(--text-color);
}

.graph-page .action-btn:hover {
    background-color: var(--gray-300);
    transform: translateY(-2px);
}

.graph-page #add-function-btn {
    color: var(--success-color);
}

.graph-page #clear-all-btn {
    color: var(--danger-color);
}

.graph-page .range-row {
    align-items: center;
}

.graph-page .range-inputs {
    display: flex;
    align-items: center;
    gap: 10px;
}

.graph-page .range-inputs input {
    width: 70px;
    padding: 8px;
    border: 1px solid var(--gray-300);
    border-radius: 5px;
    font-family: var(--font-family);
    background-color: var(--card-bg);
    color: var(--text-color);
}

.graph-page .range-inputs span {
    color: var(--gray-600);
}

.graph-page .parametric-inputs {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

/* کارت نمودار */
.graph-page .graph-tools {
    padding: 10px 15px;
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
}

.graph-page .tool-group {
    display: flex;
    gap: 5px;
}

.graph-page .tool-btn {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background-color: var(--gray-100);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--gray-700);
    cursor: pointer;
    transition: all var(--transition-speed);
}

.graph-page .tool-btn:hover {
    background-color: var(--gray-200);
    color: var(--primary-color);
}

.graph-page .tool-btn.active {
    background-color: var(--primary-light);
    color: var(--primary-color);
}

.graph-page .graph-container {
    position: relative;
    height: 500px;
    background-color: var(--card-bg);
    border-radius: 0 0 var(--border-radius) var(--border-radius);
    overflow: hidden;
}

.graph-page #graph-canvas {
    width: 100%;
    height: 100%;
    cursor: grab;
}

.graph-page #graph-canvas:active {
    cursor: grabbing;
}

.graph-page .graph-info {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background-color: rgba(255, 255, 255, 0.8);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 0.9rem;
    display: flex;
    gap: 15px;
    color: var(--gray-800);
    backdrop-filter: blur(4px);
}

.graph-page .loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-speed);
    z-index: 10;
}

.graph-page .loading-overlay.active {
    opacity: 1;
    visibility: visible;
}

.graph-page .spinner {
    width: 50px;
    height: 50px;
    border: 5px solid var(--primary-light);
    border-top-color: var(--primary-color);
    border-radius: 50%;
    animation: graph-spin 1s linear infinite;
}

@keyframes graph-spin {
    to { transform: rotate(360deg); }
}

.graph-page .loading-overlay p {
    margin-top: 15px;
    color: var(--primary-color);
    font-weight: 500;
}

/* کارت تنظیمات */
.graph-page .collapse-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--primary-color);
    font-size: 1.2rem;
    transition: transform var(--transition-speed);
}

.graph-page .collapse-btn.collapsed {
    transform: rotate(180deg);
}

.graph-page .settings-body {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}

.graph-page .settings-body.collapsed {
    display: none;
}

.graph-page .settings-group {
    flex: 1;
    min-width: 300px;
}

.graph-page .settings-group h3 {
    font-size: 1.1rem;
    color: var(--primary-color);
    margin-bottom: 15px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--gray-200);
}

.graph-page .settings-row {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
}

.graph-page .settings-row label {
    min-width: 120px;
    font-weight: 500;
}

.graph-page .slider {
    flex: 1;
    height: 5px;
    background-color: var(--gray-300);
    outline: none;
    border-radius: 5px;
    -webkit-appearance: none;
}

.graph-page .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background-color: var(--primary-color);
    cursor: pointer;
    transition: all var(--transition-speed);
}

.graph-page .slider::-webkit-slider-thumb:hover {
    transform: scale(1.2);
}

.graph-page .settings-row span {
    margin-left: 10px;
    min-width: 30px;
    text-align: center;
}

.graph-page .quality-select {
    flex: 1;
    padding: 8px 10px;
    border: 1px solid var(--gray-300);
    border-radius: 5px;
    font-family: var(--font-family);
    background-color: var(--card-bg);
    color: var(--text-color);
}

.graph-page .apply-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 15px;
    font-family: var(--font-family);
    cursor: pointer;
    transition: all var(--transition-speed);
    margin-top: 10px;
}

.graph-page .apply-btn:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
}

.graph-page .preset-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.graph-page .preset-btn {
    background-color: var(--gray-100);
    border: none;
    border-radius: 20px;
    padding: 8px 15px;
    font-family: var(--font-family);
    cursor: pointer;
    transition: all var(--transition-speed);
    color: var(--text-color);
}

.graph-page .preset-btn:hover {
    background-color: var(--primary-light);
    color: var(--primary-color);
    transform: translateY(-2px);
}

/* اعلان‌ها */
.graph-page .toast-container {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.graph-page .toast {
    background-color: var(--card-bg);
    border-radius: 8px;
    padding: 15px 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    gap: 10px;
    min-width: 300px;
    max-width: 400px;
    animation: graph-slideIn 0.3s ease, graph-fadeOut 0.3s ease 2.7s;
    opacity: 0;
    transform: translateX(-100%);
}

.graph-page .toast.show {
    opacity: 1;
    transform: translateX(0);
}

@keyframes graph-slideIn {
    from { opacity: 0; transform: translateX(-100%); }
    to { opacity: 1; transform: translateX(0); }
}

@keyframes graph-fadeOut {
    from { opacity: 1; transform: translateX(0); }
    to { opacity: 0; transform: translateX(-100%); }
}

.graph-page .toast-icon {
    font-size: 1.5rem;
}

.graph-page .toast-content {
    flex: 1;
}

.graph-page .toast-title {
    font-weight: 600;
    margin-bottom: 3px;
}

.graph-page .toast-message {
    font-size: 0.9rem;
    color: var(--gray-700);
}

.graph-page .toast-close {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--gray-600);
    font-size: 1.2rem;
}

.graph-page .toast-success .toast-icon {
    color: var(--success-color);
}

.graph-page .toast-error .toast-icon {
    color: var(--danger-color);
}

.graph-page .toast-warning .toast-icon {
    color: var(--warning-color);
}

.graph-page .toast-info .toast-icon {
    color: var(--primary-color);
}

/* واکنش‌گرایی */
@media (max-width: 992px) {
    .graph-page .graph-container {
        height: 400px;
    }

    .graph-page .settings-body {
        flex-direction: column;
    }

    .graph-page .settings-group {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .graph-page .graph-content {
        padding: 10px;
    }

    .graph-page .logo h1 {
        font-size: 1.5rem;
    }

    .graph-page .graph-tools {
        flex-wrap: wrap;
        justify-content: center;
    }

    .graph-page .function-row {
        flex-wrap: wrap;
    }

    .graph-page .function-label {
        min-width: 100%;
        margin-bottom: 5px;
    }

    .graph-page .draw-btn {
        width: 100%;
        margin-top: 10px;
    }

    .graph-page .range-inputs {
        flex-wrap: wrap;
    }

    .graph-page .graph-container {
        height: 350px;
    }
}

@media (max-width: 576px) {
    .graph-page .card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .graph-page .function-tabs {
        width: 100%;
        justify-content: space-between;
    }

    .graph-page .tab-btn {
        flex: 1;
        text-align: center;
    }

    .graph-page .tool-group {
        margin-bottom: 5px;
    }

    .graph-page .graph-container {
        height: 300px;
    }
}

 /* انیمیشن تغییر تم */
.theme-switch-animation {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease;
}

.theme-switch-animation.active {
  opacity: 1;
  visibility: visible;
}

/* افزایش اندازه توپ (خورشید/ماه) */
.theme-ball {
  width: 120px;  /* از 60px به 120px افزایش یافت */
  height: 120px; /* از 60px به 120px افزایش یافت */
  border-radius: 50%;
  background-color: #ffcc00;
  position: relative;
  transition: all 1s ease;
  animation: pulse 2s infinite alternate ease-in-out;
}

/* بهبود سایه داخلی ماه */
.theme-ball.moon {
  background-color: #e0e0e0;
  box-shadow: inset -30px -30px 0 0 #aaa, 0 0 20px rgba(255, 255, 255, 0.8);
}

/* بهبود درخشش خورشید */
.theme-ball.sun {
  background-color: #ffcc00;
  box-shadow: 0 0 60px #ffcc00, 0 0 100px rgba(255, 204, 0, 0.4);
}

/* انیمیشن ضربان برای افزایش جذابیت بصری */
@keyframes pulse {
  0% {
    transform: scale(1);
  }
  100% {
    transform: scale(1.05);
  }
}

        /* واکنش‌گرایی */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr 250px;
            }

            .examples-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .code-features {
                grid-template-columns: repeat(2, 1fr);
            }

            .design-gallery {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 992px) {
            .container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .icon-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .chapters-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .about-section, .designer-profile, .developer-profile, .teacher-profile {
                flex-direction: column;
                text-align: center;
            }

            .section-content {
                order: 1;
            }

            .section-image, .designer-image-container, .developer-image-container, .teacher-image-container {
                order: 2;
                margin-top: 30px;
            }

            .section-title:after {
                right: 50%;
                transform: translateX(50%);
            }

            html[lang="en"] .section-title:after {
                left: 50%;
                transform: translateX(-50%);
            }

            .social-links, .designer-social {
                justify-content: center;
            }

            .designer-bio, .teacher-bio {
                padding-right: 0;
                padding-left: 0;
                border-right: none;
                border-left: none;
                border-top: 3px solid rgba(255, 152, 0, 0.3);
                padding-top: 20px;
            }

            .teacher-bio {
                border-top-color: rgba(144, 12, 63, 0.3);
            }
        }

        @media (max-width: 768px) {
            .icon-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .animated-title {
                font-size: 2.5rem;
            }

            .animated-subtitle {
                font-size: 1.2rem;
            }

            .examples-grid {
                grid-template-columns: 1fr;
            }

            .newsletter-form {
                flex-direction: column;
            }

            .code-features {
                grid-template-columns: 1fr;
            }

            .design-gallery {
                grid-template-columns: 1fr;
            }

            .design-item:nth-child(1),
            .design-item:nth-child(4) {
                grid-column: auto;
                grid-row: auto;
            }

            .chart-container {
                gap: 20px;
            }

            .chart-bar {
                width: 60px;
            }

            .math-formula-showcase {
                gap: 10px;
            }

            .formula-card {
                width: calc(50% - 10px);
            }
        }

        @media (max-width: 576px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .animated-title {
                font-size: 2rem;
            }

            .designer-frame {
                display: none;
            }

            .chart-container {
                flex-wrap: wrap;
                height: auto;
                justify-content: center;
                gap: 40px;
            }

            .chart-bar {
                margin-bottom: 40px;
            }

            .formula-card {
                width: 100%;
            }
        }

        .fa-lang {
            display: block;
        }

        .en-lang {
            display: none;
        }

        html[lang="en"] .fa-lang {
            display: none;
        }

        html[lang="en"] .en-lang {
            display: block;
        }

        html[lang="en"] {
            direction: ltr;
        }

        html[lang="en"] .sidebar {
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
        }

/* استایل‌های صفحه هوش مصنوعی */
.ai-page {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-color);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease, visibility 0.5s ease;
    overflow-y: auto;
}

.ai-page.active {
    opacity: 1;
    visibility: visible;
}

.ai-header {
    background-color: var(--card-bg);
    padding: 15px 30px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.ai-title {
    font-size: 1.5rem;
    color: var(--primary-color);
    font-weight: bold;
    flex: 1;
    text-align: center; /* مرکز کردن عنوان */
}

.back-button {
    display: flex;
    align-items: center;
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    font-family: inherit;
    font-size: 1rem;
    transition: all 0.3s ease;
    padding: 8px 15px;
    border-radius: 8px;
}

.back-button:hover {
    color: var(--primary-color);
    background-color: rgba(0, 102, 204, 0.1);
}

.back-button svg {
    margin-left: 8px;
}

.info-icon {
    position: relative;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 50%;
    background-color: #ff5555;
    transition: all 0.3s ease;
    animation: pulse 2s infinite;
    margin-left: 0;
}

.info-icon::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.7) 0%, rgba(255, 215, 0, 0) 70%);
    border-radius: 50%;
    z-index: -1;
    animation: glow 1.5s infinite alternate;
}

@keyframes glow {
    0% {
        opacity: 0.5;
    }
    100% {
        opacity: 1;
    }
}

.info-icon svg {
    color: white;
    transition: all 0.3s ease;
}

.info-icon:hover {
    transform: scale(1.1);
}

.info-tooltip {
    position: absolute;
    top: 45px;
    right: -10px;
    width: 300px;
    background-color: var(--card-bg);
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 10;
    transform: translateY(-10px);
}

.info-icon:hover .info-tooltip {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.info-tooltip:before {
    content: '';
    position: absolute;
    top: -10px;
    right: 20px;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-bottom: 10px solid var(--card-bg);
}

.info-tooltip p {
    margin: 0;
    line-height: 1.5;
    color: var(--text-color);
}

.ai-content {
    flex: 1;
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
}

.ai-intro {
    text-align: center;
    max-width: 800px;
    margin: 40px auto;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.ai-intro.hidden {
    opacity: 0;
    transform: translateY(-20px);
    display: none !important;
}

.ai-robot-image {
    width: 150px; /* اندازه تصویر ربات */
    height: auto; /* حفظ نسبت ابعاد */
}

.chat-interface {
    display: none;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    width: 100%;
    max-width: 900px;
}

.chat-interface.active {
    display: block;
    opacity: 1;
    transform: translateY(0);
}

.chat-container {
    background-color: var(--card-bg);
    border-radius: 15px;
    box-shadow: 0 5px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 600px;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.message {
    display: flex;
    gap: 15px;
    max-width: 80%;
}

.user-message {
    align-self: flex-end;
    flex-direction: row-reverse;
}

.bot-message {
    align-self: flex-start;
}

.message-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
}

.message-content {
    background-color: rgba(0, 102, 204, 0.1);
    padding: 15px;
    border-radius: 15px;
    color: var(--text-color);
    position: relative;
}

.chat-input-container {
    padding: 15px;
    display: flex;
    gap: 10px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    background-color: rgba(0, 102, 204, 0.05);
}

.chat-input {
    flex: 1;
    padding: 15px;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 25px;
    resize: none;
    font-family: inherit;
    font-size: 1rem;
    background-color: var(--card-bg);
    color: var(--text-color);
    transition: all 0.3s ease;
    max-height: 150px;
    overflow-y: auto;
}

.chat-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
}

.send-button {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: var(--primary-color);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 3px 10px rgba(0, 102, 204, 0.3);
}

.send-button svg {
    color: white;
    transform: rotate(45deg);
    transition: all 0.3s ease;
}

.send-button:hover {
    background-color: var(--hover-color);
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 102, 204, 0.4);
}

.send-button:active {
    transform: translateY(0);
}

/* استایل نشانگر تایپ */
.typing-indicator {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 5px 10px;
}

.typing-dot {
    width: 8px;
    height: 8px;
    background-color: var(--primary-color);
    border-radius: 50%;
    animation: typingAnimation 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) {
    animation-delay: 0s;
}

.typing-dot:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-dot:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typingAnimation {
    0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.6;
    }
    30% {
        transform: translateY(-5px);
        opacity: 1;
    }
}

/* استایل برای منوی انتخاب مدل */
.model-selector {
    position: relative;
    margin-bottom: 15px;
}

.model-select-btn {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 15px;
    background-color: var(--card-bg);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    cursor: pointer;
    font-family: inherit;
    font-size: 1rem;
    transition: all 0.3s ease;
    width: 100%;
}

.model-select-btn:hover {
    border-color: var(--primary-color);
}

.model-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: var(--card-bg);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    padding: 10px;
    margin-top: 5px;
    z-index: 10;
    display: none;
    max-height: 300px;
    overflow-y: auto;
}

.model-dropdown.active {
    display: block;
}

.model-group {
    margin-bottom: 15px;
}

.model-group h3 {
    font-size: 0.9rem;
    margin-bottom: 8px;
    color: var(--text-color);
    opacity: 0.8;
}

.model-option {
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 5px;
}

.model-option:hover {
    background-color: rgba(0, 102, 204, 0.1);
}

.model-option.active {
    background-color: var(--primary-color);
    color: white;
}

/* استایل برای دکمه شروع گفتگو */
.start-chat-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 30px;
    padding: 12px 35px;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
    box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
}

.start-chat-btn:hover {
    background-color: var(--hover-color);
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 102, 204, 0.4);
}

/* واکنش‌گرایی */
@media (max-width: 992px) {
    .ai-content {
        padding: 20px;
    }
    .ai-intro h1 {
        font-size: 2rem;
    }
    .chat-container {
        height: 500px;
    }
}

@media (max-width: 768px) {
    .ai-header {
        padding: 15px;
    }
    .ai-title {
        font-size: 1.2rem;
    }
    .ai-intro h1 {
        font-size: 1.8rem;
    }
    .ai-intro p {
        font-size: 1rem;
    }
    .chat-container {
        height: 450px;
    }
    .message {
        max-width: 90%;
    }
}

@media (max-width: 576px) {
    .ai-content {
        padding: 15px;
    }
    .ai-robot-image {
        width: 120px; /* اندازه تصویر ربات */
    }
    .start-chat-btn {
        padding: 12px 30px;
        font-size: 1rem;
    }
    .chat-container {
        height: 400px;
    }
    .message {
        max-width: 95%;
    }
}


    </style>
</head>
    <div class="container">
        <main class="main-content">
            <div class="settings-icon" id="settingsIcon" onclick="toggleSettingsMenu()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </div>

            <div class="settings-menu" id="settingsMenu">
                <a href="#" onclick="showAboutPage()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
                    <span class="fa-lang">درباره ما</span>
                    <span class="en-lang">About Us</span>
                </a>
                <a href="#" onclick="toggleTheme()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2"></path><path d="M12 21v2"></path><path d="M4.22 4.22l1.42 1.42"></path><path d="M18.36 18.36l1.42 1.42"></path><path d="M1 12h2"></path><path d="M21 12h2"></path><path d="M4.22 19.78l1.42-1.42"></path><path d="M18.36 5.64l1.42-1.42"></path></svg>
                    <span class="fa-lang">روشن / تیره</span>
                    <span class="en-lang">Light / Dark</span>
                </a>
                <a href="#" onclick="toggleLanguage()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;"><path d="M2 12h1"></path><path d="M6 12h1"></path><path d="M10 12h11"></path><path d="M5 8l-3 4 3 4"></path></svg>
                    <span class="fa-lang">فا / En</span>
                    <span class="en-lang">En / فا</span>
                </a>
            </div>

            <header class="welcome-header">
                <h1 class="fa-lang">خوش آمدید</h1>
                <h1 class="en-lang">Welcome</h1>
            </header>

            <div class="icon-grid">
                <div class="icon-button" onclick="showCalculationPage()">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <rect x="25" y="25" width="50" height="50" fill="white" opacity="0.8" rx="5" />
                            <line x1="25" y1="40" x2="75" y2="40" stroke="blue" stroke-width="2" />
                            <line x1="40" y1="25" x2="40" y2="75" stroke="blue" stroke-width="2" />
                            <line x1="60" y1="25" x2="60" y2="75" stroke="blue" stroke-width="2" />
                            <line x1="25" y1="55" x2="75" y2="55" stroke="blue" stroke-width="2" />
                        </svg>
                    </div>
                    <span class="fa-lang">محاسبات</span>
                    <span class="en-lang">Calculations</span>
                </div>

                <div class="icon-button">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="35" cy="50" r="30" fill="white" opacity="0.8" />
                            <circle cx="65" cy="50" r="30" fill="white" opacity="0.8" />
                            <path d="M35 25 L35 75 M25 35 L45 35 M25 65 L45 65" stroke="white" stroke-width="2" fill="none" />
                            <path d="M65 25 L65 75 M55 35 L75 35 M55 65 L75 65" stroke="white" stroke-width="2" fill="none" />
                        </svg>
                    </div>
                    <span class="fa-lang">مجموعه ها</span>
                    <span class="en-lang">Sets</span>
                </div>

                <div class="icon-button">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <path d="M30 30 Q50 20 70 30 Q80 50 70 70 Q50 80 30 70 Q20 50 30 30 Z" fill="white" opacity="0.8" />
                            <path d="M40 40 L60 60 M40 60 L60 40" stroke="white" stroke-width="3" />
                        </svg>
                    </div>
                    <span class="fa-lang">روابط طولی</span>
                    <span class="en-lang">Relations</span>
                </div>

                <div class="icon-button">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <text x="30" y="60" font-size="40" fill="white">x²</text>
                        </svg>
                    </div>
                    <span class="fa-lang">فرمول ها</span>
                    <span class="en-lang">Formulas</span>
                </div>

                <div class="icon-button" onclick="showAIPage()">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="25" fill="white" opacity="0.8" />
                            <path d="M35 50 Q50 65 65 50" stroke="blue" stroke-width="3" fill="none" />
                            <circle cx="40" cy="40" r="3" fill="blue" />
                            <circle cx="60" cy="40" r="3" fill="blue" />
                        </svg>
                    </div>
                    <span class="fa-lang">هوش مصنوعی</span>
                    <span class="en-lang">AI</span>
                </div>

                <div class="icon-button">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <text x="30" y="65" font-size="45" fill="white">√</text>
                        </svg>
                    </div>
                    <span class="fa-lang">رادیکال</span>
                    <span class="en-lang">Radical</span>
                </div>

                <div class="icon-button">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <path d="M25 75 L75 75 L50 25 Z" fill="white" opacity="0.8" />
                            <path d="M50 75 L50 25" stroke="blue" stroke-width="2" />
                            <path d="M25 75 L75 75" stroke="blue" stroke-width="2" />
                        </svg>
                    </div>
                    <span class="fa-lang">مثلثات</span>
                    <span class="en-lang">Trigonometry</span>
                </div>

                <div class="icon-button" onclick="showGraphPage()">
                    <div class="icon-container">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <path d="M25 25 L25 75 L75 75" stroke="white" stroke-width="3" fill="none" />
                            <path d="M25 75 L75 25" stroke="white" stroke-width="3" fill="none" />
                            <circle cx="40" cy="60" r="3" fill="white" />
                            <circle cx="55" cy="45" r="3" fill="white" />
                            <circle cx="65" cy="35" r="3" fill="white" />
                        </svg>
                    </div>
                    <span class="fa-lang">رسم نمودار</span>
                    <span class="en-lang">Graph Drawing</span>
                </div>
            </div>

            <div class="exams-section">
                <h2 class="fa-lang">آزمون ها</h2>
                <h2 class="en-lang">Exams</h2>
                <div class="chapters-grid">
                    <div class="chapter-card">
                        <h3 class="fa-lang">فصل اول</h3>
                        <h3 class="en-lang">Chapter 1</h3>
                        <button class="download-button">
                            <span class="download-icon">⬇️</span>
                            <span class="fa-lang">دانلود</span>
                            <span class="en-lang">Download</span>
                        </button>
                        <div class="chapter-info">
                            <span class="fa-lang">طراح: سیمین جعفری</span>
                            <span class="en-lang">Author: Simin Jafari</span>
                            <div class="icons-row">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                            </div>
                        </div>
                    </div>

                    <div class="chapter-card">
                        <h3 class="fa-lang">فصل دوم</h3>
                        <h3 class="en-lang">Chapter 2</h3>
                        <button class="download-button">
                            <span class="download-icon">⬇️</span>
                            <span class="fa-lang">دانلود</span>
                            <span class="en-lang">Download</span>
                        </button>
                        <div class="chapter-info">
                            <span class="fa-lang">طراح: اکبر موسوی</span>
                            <span class="en-lang">Author: Akbar Mousavi</span>
                            <div class="icons-row">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                            </div>
                        </div>
                    </div>

                    <div class="chapter-card">
                        <h3 class="fa-lang">فصل سوم</h3>
                        <h3 class="en-lang">Chapter 3</h3>
                        <button class="download-button">
                            <span class="download-icon">⬇️</span>
                            <span class="fa-lang">دانلود</span>
                            <span class="en-lang">Download</span>
                        </button>
                        <div class="chapter-info">
                            <span class="fa-lang">طراح: علی جعفری</span>
                            <span class="en-lang">Author: Ali Jafari</span>
                            <div class="icons-row">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                            </div>
                        </div>
                    </div>

                    <div class="chapter-card">
                        <h3 class="fa-lang">فصل چهارم</h3>
                        <h3 class="en-lang">Chapter 4</h3>
                        <button class="download-button purchase-button">
                            <span class="download-icon">⬇️</span>
                            <span class="fa-lang">خرید فایل</span>
                            <span class="en-lang">Buy File</span>
                        </button>
                        <div class="chapter-info">
                            <span class="fa-lang">طراح: مهدی عباسی</span>
                            <span class="en-lang">Author: Mehdi Abbasi</span>
                            <div class="icons-row">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="40" fill="#0066cc" />
                        <path d="M30 50 Q50 20 70 50 Q50 80 30 50 Z" fill="white" />
                    </svg>
                </div>
                <h2 class="fa-lang">هوش آرا</h2>
                <h2 class="en-lang">Hoosh Ara</h2>
            </div>

            <div class="sidebar-section">
                <h3 class="section-title fa-lang">محاسبات</h3>
                <h3 class="section-title en-lang">Calculations</h3>
                <ul class="sidebar-menu">
                    <li><a href="#" onclick="showCalculationPage()">
                        <span class="fa-lang">محاسبات عددی</span>
                        <span class="en-lang">Numerical Calculations</span>
                    </a></li>
                    <li><a href="#" onclick="showGraphPage()">
                        <span class="fa-lang">کشیدن نمودارها</span>
                        <span class="en-lang">Drawing Graphs</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">روابط طولی و مثلثات</span>
                        <span class="en-lang">Relations & Trigonometry</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">مجموعه‌ها و نمودار ون</span>
                        <span class="en-lang">Sets & Venn Diagrams</span>
                    </a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="section-title fa-lang">اثبات ها</h3>
                <h3 class="section-title en-lang">Proofs</h3>
                <ul class="sidebar-menu">
                    <li><a href="#">
                        <span class="fa-lang">اثبات‌های هندسی</span>
                        <span class="en-lang">Geometric Proofs</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">اثبات‌های جبری کاربردی</span>
                        <span class="en-lang">Applied Algebraic Proofs</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">اثبات قضیه فیثاغورث</span>
                        <span class="en-lang">Pythagoras Theorem Proof</span>
                    </a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="section-title fa-lang">فرمول ها</h3>
                <h3 class="section-title en-lang">Formulas</h3>
                <ul class="sidebar-menu">
                    <li><a href="#">
                        <span class="fa-lang">فصل ۱: مجموعه‌ها</span>
                        <span class="en-lang">Chapter 1: Sets</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">فصل ۲: اعداد حقیقی</span>
                        <span class="en-lang">Chapter 2: Real Numbers</span>
                    </a></li>
                    <li><a href="#">
                        <span class="fa-lang">فصل ۳: اعداد و روابط در هندسه</span>
                        <span class="en-lang">Chapter 3: Numbers & Geometry</span>
                    </a></li>
                </ul>
            </div>
        </aside>
    </div>

<!-- صفحه هوش مصنوعی -->
<div class="ai-page" id="aiPage">
    <div class="ai-header">
        <div class="info-icon" id="infoIcon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 16v-4"></path>
                <path d="M12 8h.01"></path>
            </svg>
            <div class="info-tooltip">
                <p class="fa-lang">سلام. این نسخه از هوش مصنوعی به صورت تستی فعال است و در آینده ممکن است به دلیل شارژ نداشتن API از کار متوقف شود.</p>
                <p class="en-lang">Hello. This version of AI is activated as a test and may be discontinued in the future due to API charge limitations.</p>
            </div>
        </div>

        <div class="ai-title fa-lang">دستیار هوش مصنوعی ریاضی</div>
        <div class="ai-title en-lang">AI Math Assistant</div>

        <button class="back-button" id="aiBackButton" onclick="closeAIPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span class="fa-lang">بازگشت</span>
            <span class="en-lang">Back</span>
        </button>
    </div>

    <div class="ai-content">
        <div class="ai-intro" id="aiIntro">
            <div class="ai-logo-container">
                <img src="https://example.com/your-image-url.png" alt="Math Robot" class="ai-robot-image" />
            </div>
            <h1 class="fa-lang">دستیار هوشمند ریاضی</h1>
            <h1 class="en-lang">Smart Math Assistant</h1>
            <p class="fa-lang">از من هر سوال ریاضی دارید بپرسید. من اینجا هستم تا به شما در حل مسائل و درک مفاهیم ریاضی کمک کنم.</p>
            <p class="en-lang">Ask me any math question you have. I'm here to help you solve problems and understand mathematical concepts.</p>
            <button class="start-chat-btn fa-lang" id="startChatBtn" onclick="openChatInterface()">شروع گفتگو</button>
            <button class="start-chat-btn en-lang" id="startChatBtnEn" onclick="openChatInterface()">Start Chat</button>
        </div>

        <div class="chat-interface" id="chatInterface">
            <div class="model-selector">
                <button class="model-select-btn" id="modelSelectBtn">
                    <span class="fa-lang">انتخاب مدل</span>
                    <span class="en-lang">Select Model</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="model-dropdown" id="modelDropdown">
                    <div class="model-group">
                        <h3 class="fa-lang">GPT-4O (30 بار در روز)</h3>
                        <h3 class="en-lang">GPT-4O (30 times/day)</h3>
                        <div class="model-option active" data-model="gpt-4o">GPT-4O</div>
                        <div class="model-option" data-model="gpt-4o-2024-05-13">GPT-4O (2024-05-13)</div>
                        <div class="model-option" data-model="gpt-4o-2024-08-06">GPT-4O (2024-08-06)</div>
                        <div class="model-option" data-model="gpt-4o-2024-11-20">GPT-4O (2024-11-20)</div>
                    </div>
                    <div class="model-group">
                        <h3 class="fa-lang">GPT-4O-Mini (200 بار در روز)</h3>
                        <h3 class="en-lang">GPT-4O-Mini (200 times/day)</h3>
                        <div class="model-option" data-model="gpt-4o-mini">GPT-4O-Mini</div>
                        <div class="model-option" data-model="gpt-4o-mini-2024-07-18">GPT-4O-Mini (2024-07-18)</div>
                    </div>
                    <div class="model-group">
                        <h3 class="fa-lang">DeepSeek (30 بار در روز)</h3>
                        <h3 class="en-lang">DeepSeek (30 times/day)</h3>
                        <div class="model-option" data-model="deepseek-r1">DeepSeek-R1</div>
                        <div class="model-option" data-model="deepseek-v3">DeepSeek-V3</div>
                    </div>
                </div>
            </div>

            <div class="chat-container" id="chatContainer">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot-message">
                        <div class="message-avatar">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="50" cy="50" r="40" fill="#0066cc" />
                                <path d="M30 50 Q50 20 70 50 Q50 80 30 50 Z" fill="white" />
                            </svg>
                        </div>
                        <div class="message-content">
                            <p class="fa-lang">سلام! من دستیار هوشمند ریاضی هستم. چه سوالی در مورد ریاضی دارید؟</p>
                            <p class="en-lang">Hello! I'm your smart math assistant. What math question can I help you with?</p>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <textarea id="userInput" class="chat-input" placeholder="سوال ریاضی خود را بنویسید..." rows="1"></textarea>
                    <button class="send-button" id="sendButton">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>



    <!-- صفحه درباره ما با طراحی جدید و انیمیشن‌های پیشرفته -->
    <div class="about-page" id="aboutPage">
        <div class="close-about" onclick="closeAboutPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </div>

        <div class="about-hero">
            <div class="hero-background">
                <div class="particles-container" id="particles-js"></div>
                                <div class="hero-overlay"></div>
                            </div>
                            <div class="hero-content">
                                <div class="logo-animation">
                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="animated-logo">
                                        <circle cx="50" cy="50" r="40" fill="#0066cc" class="logo-circle" />
                                        <path d="M30 50 Q50 20 70 50 Q50 80 30 50 Z" fill="white" class="logo-path" />
                                    </svg>
                                </div>
                                <h1 class="fa-lang animated-title">درباره هوش آرا</h1>
                                <h1 class="en-lang animated-title">About Hoosh Ara</h1>
                                <p class="fa-lang animated-subtitle">آموزش هوشمند ریاضی با نگاهی نو</p>
                                <p class="en-lang animated-subtitle">Smart Math Education with a Fresh Perspective</p>
                            </div>

                            <div class="scroll-indicator">
                                <span class="fa-lang">پایین بروید</span>
                                <span class="en-lang">Scroll Down</span>
                                <div class="scroll-arrow">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 5v14M5 12l7 7 7-7"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="about-sections">
                            <section class="about-section mission-section reveal-section">
                                <div class="section-content">
                                    <h2 class="fa-lang section-title">ماموریت ما</h2>
                                    <h2 class="en-lang section-title">Our Mission</h2>
                                    <p class="fa-lang">هوش آرا با هدف ساده‌سازی یادگیری ریاضی و ارائه روش‌های نوین آموزشی ایجاد شده است. ما معتقدیم ریاضی می‌تواند برای همه جذاب و قابل درک باشد، به شرطی که با روش درست آموزش داده شود. ماموریت ما ایجاد تجربه‌ای لذت‌بخش از یادگیری ریاضی است.</p>
                                    <p class="en-lang">Hoosh Ara was created with the goal of simplifying math learning and providing innovative teaching methods. We believe mathematics can be engaging and understandable for everyone, provided it's taught the right way. Our mission is to create an enjoyable experience of learning mathematics.</p>
                                </div>
                                <div class="section-image">
                                    <div class="floating-shapes">
                                        <div class="shape shape-1">∑</div>
                                        <div class="shape shape-2">π</div>
                                        <div class="shape shape-3">∞</div>
                                        <div class="shape shape-4">√</div>
                                        <div class="shape shape-5">∫</div>
                                    </div>
                                </div>
                            </section>

                            <!-- بخش دبیر ریاضی - طراحی جدید -->
                            <section class="about-section teacher-section reveal-section">
                                <div class="section-content">
                                    <h2 class="fa-lang section-title">دبیر ریاضی</h2>
                                    <h2 class="en-lang section-title">Math Teacher</h2>
                                    <div class="teacher-profile">
                                        <div class="teacher-image-container">
                                            <div class="teacher-portrait">
                                                <img src="https://images.unsplash.com/photo-1580894732444-8ecded7900cd?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80" alt="Math Teacher" class="teacher-image">
                                            </div>
                                            <div class="math-symbols">
                                                <div class="math-symbol">∫</div>
                                                <div class="math-symbol">π</div>
                                                <div class="math-symbol">∑</div>
                                                <div class="math-symbol">√</div>
                                                <div class="math-symbol">∞</div>
                                            </div>
                                        </div>
                                        <div class="teacher-info">
                                            <h3 class="teacher-name fa-lang">دکتر زهرا محمدی</h3>
                                            <h3 class="teacher-name en-lang">Dr. Zahra Mohammadi</h3>
                                            <div class="teacher-title fa-lang">دبیر ارشد ریاضی و مشاور محتوای آموزشی</div>
                                            <div class="teacher-title en-lang">Senior Math Teacher & Educational Content Advisor</div>
                                            <p class="teacher-bio fa-lang">دکتر زهرا محمدی با بیش از 15 سال سابقه تدریس ریاضی در مدارس و دانشگاه‌های معتبر، مشاور اصلی محتوای آموزشی سایت هوش آرا است. تخصص او در ساده‌سازی مفاهیم پیچیده ریاضی و ارائه روش‌های خلاقانه برای حل مسائل، به طراحی بخش‌های محاسباتی و آموزشی سایت کمک شایانی کرده است.</p>
                                            <p class="teacher-bio en-lang">Dr. Zahra Mohammadi, with over 15 years of experience teaching mathematics in reputable schools and universities, is the main advisor for the educational content of Hoosh Ara. Her expertise in simplifying complex mathematical concepts and providing creative methods for problem-solving has greatly contributed to the design of the computational and educational sections of the site.</p>
                                        </div>
                                    </div>
                                    <div class="math-formula-showcase">
                                        <div class="formula-card">
                                            <div class="formula">E = mc²</div>
                                            <div class="formula-name">فرمول انیشتین</div>
                                        </div>
                                        <div class="formula-card">
                                            <div class="formula">a² + b² = c²</div>
                                            <div class="formula-name">قضیه فیثاغورث</div>
                                        </div>
                                        <div class="formula-card">
                                            <div class="formula">∫ f(x) dx</div>
                                            <div class="formula-name">انتگرال نامعین</div>
                                        </div>
                                        <div class="formula-card">
                                            <div class="formula">F = G(m₁m₂/r²)</div>
                                            <div class="formula-name">قانون گرانش نیوتن</div>
                                        </div>
                                        <div class="formula-card">
                                            <div class="formula">e^(iπ) + 1 = 0</div>
                                            <div class="formula-name">اتحاد اویلر</div>
                                        </div>
                                        <div class="formula-card">
                                            <div class="formula">sin²θ + cos²θ = 1</div>
                                            <div class="formula-name">اتحاد مثلثاتی پایه</div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                          <!-- بخش برنامه‌نویس - طراحی بهبود یافته -->
<section class="about-section developer-section reveal-section">
    <div class="section-content">
      <h2 class="fa-lang section-title">برنامه‌نویس سایت</h2>
      <h2 class="en-lang section-title">Site Developer</h2>
      <div class="developer-profile">
        <div class="developer-image-container">
          <img src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80" alt="Developer" class="developer-image">
        </div>
        <div class="developer-info">
          <h3 class="developer-name fa-lang">حسین رضایی</h3>
          <h3 class="developer-name en-lang">Hossein Rezaei</h3>
          <div class="developer-title fa-lang">برنامه‌نویس ارشد فرانت‌اند و بک‌اند</div>
          <div class="developer-title en-lang">Senior Front-end & Back-end Developer</div>
          <p class="fa-lang">مهندس حسین رضایی، برنامه‌نویس ارشد با بیش از 8 سال تجربه در توسعه وب، مسئول کدنویسی و پیاده‌سازی فنی سایت هوش آرا است. تخصص او در زمینه فرانت‌اند و بک‌اند، امکان ایجاد یک پلتفرم آموزشی یکپارچه، روان و کاربرپسند را فراهم کرده است.</p>
          <p class="en-lang">Eng. Hossein Rezaei, a senior developer with over 8 years of experience in web development, is responsible for coding and technical implementation of the Hoosh Ara site. His expertise in front-end and back-end development has enabled the creation of an integrated, smooth, and user-friendly educational platform.</p>

          <div class="social-links">
            <a href="#" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
            </a>
            <a href="#" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
            </a>
            <a href="#" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
            </a>
          </div>
        </div>
      </div>

      <!-- نمایش کدها با طراحی جدید -->
      <div class="coding-showcase">
        <div class="language-tabs">
          <button class="language-tab active" data-tab="html">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/html5/html5-original.svg" alt="HTML5" class="language-icon"> HTML5
          </button>
          <button class="language-tab" data-tab="css">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/css3/css3-original.svg" alt="CSS3" class="language-icon"> CSS3
          </button>
          <button class="language-tab" data-tab="js">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg" alt="JavaScript" class="language-icon"> JavaScript
          </button>
          <button class="language-tab" data-tab="react">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/react/react-original.svg" alt="React" class="language-icon"> React
          </button>
          <button class="language-tab" data-tab="vue">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vuejs/vuejs-original.svg" alt="Vue.js" class="language-icon"> Vue.js
          </button>
        </div>

        <div class="code-window">
          <div class="code-window-header">
            <div class="window-controls">
              <div class="control-dot red"></div>
              <div class="control-dot yellow"></div>
              <div class="control-dot green"></div>
            </div>
            <div class="window-title fa-lang">کد نمونه</div>
            <div class="window-title en-lang">Sample Code</div>
          </div>

          <div class="code-content active" id="htmlCode">
            <!-- HTML code is loaded by JavaScript -->
          </div>

          <div class="code-content" id="cssCode">
            <!-- CSS code is loaded by JavaScript -->
          </div>

          <div class="code-content" id="jsCode">
            <!-- JavaScript code is loaded by JavaScript -->
          </div>

          <div class="code-content" id="reactCode">
            <!-- React code is loaded by JavaScript -->
          </div>

          <div class="code-content" id="vueCode">
            <!-- Vue.js code is loaded by JavaScript -->
          </div>
        </div>
      </div>

      <!-- نمایش ترکیب کدهای سایت -->
      <div class="language-progress">
        <h3 class="progress-title fa-lang">ترکیب کدهای سایت</h3>
        <h3 class="progress-title en-lang">Website Code Composition</h3>
        <div class="progress-bars">
          <div class="progress-item">
            <div class="progress-label">
              <span class="progress-name">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/html5/html5-original.svg" alt="HTML5"> HTML5
              </span>
              <span class="progress-percentage">42%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill html" id="htmlProgress"></div>
            </div>
            <div class="progress-info fa-lang">
              ساختار اصلی سایت با HTML5 پیاده‌سازی شده و از تگ‌های معنایی استفاده شده است.
            </div>
            <div class="progress-info en-lang">
              The main structure of the site is implemented with HTML5 and semantic tags are used.
            </div>
          </div>

          <div class="progress-item">
            <div class="progress-label">
              <span class="progress-name">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/css3/css3-original.svg" alt="CSS3"> CSS3
              </span>
              <span class="progress-percentage">35%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill css" id="cssProgress"></div>
            </div>
            <div class="progress-info fa-lang">
              استایل‌دهی سایت با CSS3 انجام شده و از متغیرهای CSS برای مدیریت بهتر رنگ‌ها استفاده شده است.
            </div>
            <div class="progress-info en-lang">
              Site styling is done with CSS3 and CSS variables are used for better color management.
            </div>
          </div>

          <div class="progress-item">
            <div class="progress-label">
              <span class="progress-name">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg" alt="JavaScript"> JavaScript
              </span>
              <span class="progress-percentage">20%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill js" id="jsProgress"></div>
            </div>
            <div class="progress-info fa-lang">
              تعاملات کاربری و انیمیشن‌های سایت با JavaScript پیاده‌سازی شده‌اند.
            </div>
            <div class="progress-info en-lang">
              User interactions and site animations are implemented with JavaScript.
            </div>
          </div>

          <div class="progress-item">
            <div class="progress-label">
              <span class="progress-name">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/svg/svg-original.svg" alt="SVG"> SVG
              </span>
              <span class="progress-percentage">8%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill svg" id="svgProgress"></div>
            </div>
            <div class="progress-info fa-lang">
              آیکون‌ها و تصاویر گرافیکی با فرمت SVG برای کیفیت بالا در همه نمایشگرها استفاده شده‌اند.
            </div>
            <div class="progress-info en-lang">
              Icons and graphical images are used in SVG format for high quality on all displays.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


                            <!-- بخش طراح سایت - طراحی جدید و خلاقانه -->
                            <section class="about-section designer-section reveal-section">
                                <div class="section-content">
                                    <h2 class="fa-lang section-title">طراح سایت</h2>
                                    <h2 class="en-lang section-title">Site Designer</h2>
                                    <div class="designer-profile">
                                        <div class="designer-image-container">
                                            <div class="designer-portrait">
                                                      <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80" alt="Designer" class="designer-image">
                                                                            </div>
                                                                            <div class="designer-frame"></div>
                                                                        </div>
                                                                        <div class="designer-tools">
                                                                            <div class="tool-icon">
                                                                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/figma/figma-original.svg" alt="Figma">
                                                                            </div>
                                                                            <div class="tool-icon">
                                                                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/photoshop/photoshop-plain.svg" alt="Photoshop">
                                                                            </div>
                                                                            <div class="tool-icon">
                                                                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/illustrator/illustrator-plain.svg" alt="Illustrator">
                                                                            </div>
                                                                            <div class="tool-icon">
                                                                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/xd/xd-plain.svg" alt="Adobe XD">
                                                                            </div>
                                                                            <div class="tool-icon">
                                                                                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/sketch/sketch-original.svg" alt="Sketch">
                                                                            </div>
                                                                        </div>
                                                                        <div class="designer-info">
                                                                            <h3 class="designer-name fa-lang">سارا احمدی</h3>
                                                                            <h3 class="designer-name en-lang">Sara Ahmadi</h3>
                                                                            <div class="designer-title fa-lang">طراح رابط کاربری و تجربه کاربری</div>
                                                                            <div class="designer-title en-lang">UI/UX Designer</div>
                                                                            <p class="designer-bio fa-lang">سارا احمدی با بیش از 6 سال تجربه در طراحی رابط کاربری و تجربه کاربری، مسئول طراحی بصری و ساختار تعاملی سایت هوش آرا است. او با ترکیبی از خلاقیت و درک عمیق از نیازهای کاربران، تجربه‌ای جذاب و کاربرپسند برای یادگیری ریاضی طراحی کرده است.</p>
                                                                            <p class="designer-bio en-lang">Sara Ahmadi, with over 6 years of experience in UI/UX design, is responsible for the visual design and interactive structure of the Hoosh Ara site. With a combination of creativity and deep understanding of user needs, she has designed an engaging and user-friendly experience for learning mathematics.</p>

                                                                            <div class="designer-social">
                                                                                <a href="#" class="designer-social-link">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
                                                                                </a>
                                                                                <a href="#" class="designer-social-link">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                                                                                </a>
                                                                                <a href="#" class="designer-social-link">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
                                                                                </a>
                                                                                <a href="#" class="designer-social-link">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
                                                                                </a>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="design-showcase">
                                                                        <div class="design-gallery">
                                                                            <div class="design-item">
                                                                                <img src="https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Design Sample" class="design-image">
                                                                                <div class="design-overlay">
                                                                                    <div>
                                                                                        <div class="design-title">صفحه اصلی</div>
                                                                                        <div class="design-tag">طراحی رابط کاربری</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="design-item">
                                                                                <img src="https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Design Sample" class="design-image">
                                                                                <div class="design-overlay">
                                                                                    <div>
                                                                                        <div class="design-title">صفحه محاسبات</div>
                                                                                        <div class="design-tag">تجربه کاربری</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="design-item">
                                                                                <img src="https://images.unsplash.com/photo-1581291518633-83b4ebd1d83e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Design Sample" class="design-image">
                                                                                <div class="design-overlay">
                                                                                    <div>
                                                                                        <div class="design-title">رسم نمودار</div>
                                                                                        <div class="design-tag">طراحی تعاملی</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="design-item">
                                                                                <img src="https://images.unsplash.com/photo-1581291518770-b23886dc81d3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Design Sample" class="design-image">
                                                                                <div class="design-overlay">
                                                                                    <div>
                                                                                        <div class="design-title">مجموعه‌ها</div>
                                                                                        <div class="design-tag">طراحی گرافیکی</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </section>
                                                        </div>
                                                    </div>

                                                    <!-- صفحه محاسبات -->
                                                    <div class="calculation-page" id="calculationPage">
                                                        <div class="calculation-header">
                                                            <div class="calculation-title fa-lang">محاسبات عددی پیشرفته</div>
                                                            <div class="calculation-title en-lang">Advanced Numerical Calculations</div>
                                                            <button class="back-button" onclick="closeCalculationPage()">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                                                </svg>
                                                                <span class="fa-lang">بازگشت</span>
                                                                <span class="en-lang">Back</span>
                                                            </button>
                                                        </div>

                                                        <div class="calculation-content">
                                                            <!-- بخش‌های محاسبات -->
                                                            <div class="calculation-tabs">
                                                                <button class="calc-tab-btn active" data-tab="calculator">
                                                                    <i class="fas fa-calculator"></i>
                                                                    <span class="fa-lang">ماشین حساب مهندسی</span>
                                                                    <span class="en-lang">Engineering Calculator</span>
                                                                </button>
                                                                <button class="calc-tab-btn" data-tab="geometry">
                                                                    <i class="fas fa-shapes"></i>
                                                                    <span class="fa-lang">مساحت و محیط</span>
                                                                    <span class="en-lang">Area & Perimeter</span>
                                                                </button>
                                                                <button class="calc-tab-btn" data-tab="equations">
                                                                    <i class="fas fa-square-root-alt"></i>
                                                                    <span class="fa-lang">حل معادلات</span>
                                                                    <span class="en-lang">Equation Solver</span>
                                                                </button>
                                                            </div>

                                                           <!-- بخش ماشین حساب مهندسی -->
                                                <div class="calc-tab-content active" id="calculator-tab">
                                                    <div class="calculator-container">
                                                        <div class="calculator-header">
                                                            <h2 class="fa-lang">ماشین حساب مهندسی</h2>
                                                            <h2 class="en-lang">Engineering Calculator</h2>
                                                            <p class="fa-lang">محاسبات پیشرفته ریاضی را با این ابزار انجام دهید</p>
                                                            <p class="en-lang">Perform advanced mathematical calculations with this tool</p>
                                                        </div>

                                                        <div class="calculator-body">
                                                            <div class="calculator-screen">
                                                                <div class="calculator-history" id="calculatorHistory"></div>
                                                                <div class="calculator-display" id="calculatorDisplay">0</div>
                                                            </div>

                                                            <div class="calculator-grid">
                                                                <button class="calculator-btn function" onclick="calculatorClear()">AC</button>
                                                                <button class="calculator-btn function" onclick="calculatorBackspace()"><i class="fas fa-backspace"></i></button>
                                                                <button class="calculator-btn function" onclick="calculatorOperation('%')">%</button>
                                                                <button class="calculator-btn operator" onclick="calculatorOperation('/')">÷</button>

                                                                <button class="calculator-btn" onclick="calculatorAppend('7')">7</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('8')">8</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('9')">9</button>
                                                                <button class="calculator-btn operator" onclick="calculatorOperation('*')">×</button>

                                                                <button class="calculator-btn" onclick="calculatorAppend('4')">4</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('5')">5</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('6')">6</button>
                                                                <button class="calculator-btn operator" onclick="calculatorOperation('-')">−</button>

                                                                <button class="calculator-btn" onclick="calculatorAppend('1')">1</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('2')">2</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('3')">3</button>
                                                                <button class="calculator-btn operator" onclick="calculatorOperation('+')">+</button>

                                                                <button class="calculator-btn" onclick="calculatorAppend('0')">0</button>
                                                                <button class="calculator-btn" onclick="calculatorAppend('.')">.</button>
                                                                <button class="calculator-btn equal" onclick="calculatorCalculate()" colspan="2">=</button>
                                                            </div>

                                                            <div class="scientific-functions">
                                                                <div class="scientific-grid">
                                                                    <button class="scientific-btn" onclick="calculatorFunction('sin')">sin</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('cos')">cos</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('tan')">tan</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('ln')">ln</button>

                                                                    <button class="scientific-btn" onclick="calculatorFunction('sqrt')">√</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('pow')">x^y</button>
                                                                    <button class="scientific-btn" onclick="calculatorConstant('pi')">π</button>
                                                                    <button class="scientific-btn" onclick="calculatorConstant('e')">e</button>

                                                                    <button class="scientific-btn" onclick="calculatorAppend('(')">(</button>
                                                                    <button class="scientific-btn" onclick="calculatorAppend(')')">)</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('log')">log</button>
                                                                    <button class="scientific-btn" onclick="calculatorFunction('abs')">|x|</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                                            <!-- بخش مساحت و محیط -->
                                                            <div class="calc-tab-content" id="geometry-tab">
                                                                <div class="geometry-container">
                                                                    <div class="geometry-header">
                                                                        <h2 class="fa-lang">محاسبه مساحت و محیط اشکال</h2>
                                                                        <h2 class="en-lang">Area and Perimeter Calculator</h2>
                                                                        <p class="fa-lang">مساحت و محیط اشکال مختلف را محاسبه کنید</p>
                                                                        <p class="en-lang">Calculate the area and perimeter of different shapes</p>
                                                                    </div>

                                                                    <div class="geometry-body">
                                                                        <div class="shape-selector">
                                                                            <div class="shape-option active" data-shape="circle">
                                                                                <div class="shape-icon">
                                                                                    <i class="fas fa-circle"></i>
                                                                                </div>
                                                                                <span class="fa-lang">دایره</span>
                                                                                <span class="en-lang">Circle</span>
                                                                            </div>
                                                                            <div class="shape-option" data-shape="rectangle">
                                                                                <div class="shape-icon">
                                                                                    <i class="fas fa-square"></i>
                                                                                </div>
                                                                                <span class="fa-lang">مستطیل</span>
                                                                                <span class="en-lang">Rectangle</span>
                                                                            </div>
                                                                            <div class="shape-option" data-shape="triangle">
                                                                                <div class="shape-icon">
                                                                                    <i class="fas fa-play" style="transform: rotate(90deg);"></i>
                                                                                </div>
                                                                                <span class="fa-lang">مثلث</span>
                                                                                <span class="en-lang">Triangle</span>
                                                                            </div>
                                                                            <div class="shape-option" data-shape="ellipse">
                                                                                <div class="shape-icon">
                                                                                    <i class="fas fa-egg"></i>
                                                                                </div>
                                                                                <span class="fa-lang">بیضی</span>
                                                                                <span class="en-lang">Ellipse</span>
                                                                            </div>
                                                                            <div class="shape-option" data-shape="trapezoid">
                                                                                <div class="shape-icon">
                                                                                    <i class="fas fa-draw-polygon"></i>
                                                                                </div>
                                                                                <span class="fa-lang">ذوزنقه</span>
                                                                                <span class="en-lang">Trapezoid</span>
                                                                            </div>
                                                                        </div>

                                                                        <div class="shape-calculator">
                                                                            <!-- دایره -->
                                                                            <div class="shape-form active" id="circle-form">
                                                                                <div class="shape-illustration">
                                                                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                                                                        <circle cx="50" cy="50" r="40" fill="rgba(0,102,204,0.2)" stroke="#0066cc" stroke-width="2"/>
                                                                                        <line x1="50" y1="50" x2="90" y2="50" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="65" y="45" font-size="10" fill="#0066cc">r</text>
                                                                                    </svg>
                                                                                </div>
                                                                                <div class="shape-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">شعاع دایره (r)</label>
                                                                                        <label class="en-lang">Circle Radius (r)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="circleRadius" min="0" step="0.1" value="5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="calculateCircle()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">محاسبه</span>
                                                                                        <span class="en-lang">Calculate</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="shape-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">مساحت</div>
                                                                                        <div class="result-label en-lang">Area</div>
                                                                                        <div class="result-value" id="circleArea">78.54 cm²</div>
                                                                                        <div class="result-formula">A = πr²</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">محیط</div>
                                                                                        <div class="result-label en-lang">Perimeter</div>
                                                                                        <div class="result-value" id="circlePerimeter">31.42 cm</div>
                                                                                        <div class="result-formula">P = 2πr</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- مستطیل -->
                                                                            <div class="shape-form" id="rectangle-form">
                                                                                <div class="shape-illustration">
                                                                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                                                                        <rect x="10" y="25" width="80" height="50" fill="rgba(0,102,204,0.2)" stroke="#0066cc" stroke-width="2"/>
                                                                                        <text x="45" y="55" font-size="10" fill="#0066cc">w × h</text>
                                                                                        <line x1="10" y1="20" x2="90" y2="20" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="45" y="18" font-size="10" fill="#0066cc">w</text>
                                                                                        <line x1="95" y1="25" x2="95" y2="75" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="97" y="50" font-size="10" fill="#0066cc">h</text>
                                                                                    </svg>
                                                                                </div>
                                                                                <div class="shape-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">طول (w)</label>
                                                                                        <label class="en-lang">Width (w)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="rectangleWidth" min="0" step="0.1" value="8">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">عرض (h)</label>
                                                                                        <label class="en-lang">Height (h)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="rectangleHeight" min="0" step="0.1" value="5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="calculateRectangle()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">محاسبه</span>
                                                                                        <span class="en-lang">Calculate</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="shape-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">مساحت</div>
                                                                                        <div class="result-label en-lang">Area</div>
                                                                                        <div class="result-value" id="rectangleArea">40.00 cm²</div>
                                                                                        <div class="result-formula">A = w × h</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">محیط</div>
                                                                                        <div class="result-label en-lang">Perimeter</div>
                                                                                        <div class="result-value" id="rectanglePerimeter">26.00 cm</div>
                                                                                        <div class="result-formula">P = 2(w + h)</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- مثلث -->
                                                                            <div class="shape-form" id="triangle-form">
                                                                                <div class="shape-illustration">
                                                                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                                                                        <polygon points="50,10 10,80 90,80" fill="rgba(0,102,204,0.2)" stroke="#0066cc" stroke-width="2"/>
                                                                                        <line x1="50" y1="10" x2="50" y2="80" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="52" y="45" font-size="10" fill="#0066cc">h</text>
                                                                                        <text x="30" y="85" font-size="10" fill="#0066cc">a</text>
                                                                                        <text x="65" y="85" font-size="10" fill="#0066cc">b</text>
                                                                                        <text x="50" y="25" font-size="10" fill="#0066cc">c</text>
                                                                                    </svg>
                                                                                </div>
                                                                                <div class="shape-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضلع اول (a)</label>
                                                                                        <label class="en-lang">Side a</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="triangleSideA" min="0" step="0.1" value="5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضلع دوم (b)</label>
                                                                                        <label class="en-lang">Side b</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="triangleSideB" min="0" step="0.1" value="5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضلع سوم (c)</label>
                                                                                        <label class="en-lang">Side c</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="triangleSideC" min="0" step="0.1" value="5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="calculateTriangle()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">محاسبه</span>
                                                                                        <span class="en-lang">Calculate</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="shape-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">مساحت</div>
                                                                                        <div class="result-label en-lang">Area</div>
                                                                                        <div class="result-value" id="triangleArea">10.83 cm²</div>
                                                                                        <div class="result-formula">A = √(s(s-a)(s-b)(s-c))</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">محیط</div>
                                                                                        <div class="result-label en-lang">Perimeter</div>
                                                                                        <div class="result-value" id="trianglePerimeter">15.00 cm</div>
                                                                                        <div class="result-formula">P = a + b + c</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- بیضی -->
                                                                            <div class="shape-form" id="ellipse-form">
                                                                                <div class="shape-illustration">
                                                                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                                                                        <ellipse cx="50" cy="50" rx="40" ry="25" fill="rgba(0,102,204,0.2)" stroke="#0066cc" stroke-width="2"/>
                                                                                        <line x1="10" y1="50" x2="90" y2="50" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="45" y="45" font-size="10" fill="#0066cc">2a</text>
                                                                                        <line x1="50" y1="25" x2="50" y2="75" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="55" y="50" font-size="10" fill="#0066cc">2b</text>
                                                                                    </svg>
                                                                                </div>
                                                                                <div class="shape-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">نیم قطر بزرگ (a)</label>
                                                                                        <label class="en-lang">Semi-major axis (a)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="ellipseMajor" min="0" step="0.1" value="6">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">نیم قطر کوچک (b)</label>
                                                                                        <label class="en-lang">Semi-minor axis (b)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="ellipseMinor" min="0" step="0.1" value="4">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="calculateEllipse()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">محاسبه</span>
                                                                                        <span class="en-lang">Calculate</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="shape-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">مساحت</div>
                                                                                        <div class="result-label en-lang">Area</div>
                                                                                        <div class="result-value" id="ellipseArea">75.40 cm²</div>
                                                                                        <div class="result-formula">A = πab</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">محیط (تقریبی)</div>
                                                                                        <div class="result-label en-lang">Perimeter (approx.)</div>
                                                                                        <div class="result-value" id="ellipsePerimeter">31.61 cm</div>
                                                                                        <div class="result-formula">P ≈ 2π√((a²+b²)/2)</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- ذوزنقه -->
                                                                            <div class="shape-form" id="trapezoid-form">
                                                                                <div class="shape-illustration">
                                                                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                                                                        <polygon points="20,30 80,30 90,70 10,70" fill="rgba(0,102,204,0.2)" stroke="#0066cc" stroke-width="2"/>
                                                                                        <line x1="20" y1="25" x2="80" y2="25" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="45" y="23" font-size="10" fill="#0066cc">a</text>
                                                                                        <line x1="10" y1="75" x2="90" y2="75" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="45" y="85" font-size="10" fill="#0066cc">b</text>
                                                                                        <line x1="50" y1="30" x2="50" y2="70" stroke="#0066cc" stroke-width="2" stroke-dasharray="4"/>
                                                                                        <text x="53" y="50" font-size="10" fill="#0066cc">h</text>
                                                                                    </svg>
                                                                                </div>
                                                                                <div class="shape-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">قاعده بالا (a)</label>
                                                                                        <label class="en-lang">Upper base (a)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="trapezoidUpperBase" min="0" step="0.1" value="6">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">قاعده پایین (b)</label>
                                                                                        <label class="en-lang">Lower base (b)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="trapezoidLowerBase" min="0" step="0.1" value="8">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ارتفاع (h)</label>
                                                                                        <label class="en-lang">Height (h)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="trapezoidHeight" min="0" step="0.1" value="4">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضلع چپ (c)</label>
                                                                                        <label class="en-lang">Left side (c)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="trapezoidLeftSide" min="0" step="0.1" value="4.5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضلع راست (d)</label>
                                                                                        <label class="en-lang">Right side (d)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="trapezoidRightSide" min="0" step="0.1" value="4.5">
                                                                                            <span class="unit">cm</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="calculateTrapezoid()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">محاسبه</span>
                                                                                        <span class="en-lang">Calculate</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="shape-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">مساحت</div>
                                                                                        <div class="result-label en-lang">Area</div>
                                                                                        <div class="result-value" id="trapezoidArea">28.00 cm²</div>
                                                                                        <div class="result-formula">A = (a+b)h/2</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">محیط</div>
                                                                                        <div class="result-label en-lang">Perimeter</div>
                                                                                        <div class="result-value" id="trapezoidPerimeter">23.00 cm</div>
                                                                                        <div class="result-formula">P = a + b + c + d</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- بخش حل معادلات -->
                                                            <div class="calc-tab-content" id="equations-tab">
                                                                <div class="equations-container">
                                                                    <div class="equations-header">
                                                                        <h2 class="fa-lang">حل معادلات درجه‌دار</h2>
                                                                        <h2 class="en-lang">Equation Solver</h2>
                                                                        <p class="fa-lang">معادلات درجه اول و دوم را حل کنید</p>
                                                                        <p class="en-lang">Solve linear and quadratic equations</p>
                                                                    </div>

                                                                    <div class="equations-body">
                                                                        <div class="equation-type-selector">
                                                                            <button class="equation-type-btn active" data-equation="linear">
                                                                                <span class="fa-lang">معادله درجه اول</span>
                                                                                <span class="en-lang">Linear Equation</span>
                                                                                <div class="equation-preview">ax + b = 0</div>
                                                                            </button>
                                                                            <button class="equation-type-btn" data-equation="quadratic">
                                                                                <span class="fa-lang">معادله درجه دوم</span>
                                                                                <span class="en-lang">Quadratic Equation</span>
                                                                                <div class="equation-preview">ax² + bx + c = 0</div>
                                                                            </button>
                                                                            <button class="equation-type-btn" data-equation="cubic">
                                                                                <span class="fa-lang">معادله درجه سوم</span>
                                                                                <span class="en-lang">Cubic Equation</span>
                                                                                <div class="equation-preview">ax³ + bx² + cx + d = 0</div>
                                                                            </button>
                                                                        </div>

                                                                        <div class="equation-solver">
                                                                            <!-- معادله درجه اول -->
                                                                            <div class="equation-form active" id="linear-form">
                                                                                <div class="equation-illustration">
                                                                                    <div class="equation-display">
                                                                                        <span class="coefficient">a</span><span class="variable">x</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">b</span>
                                                                                        <span class="operator">=</span>
                                                                                        <span class="constant">0</span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="equation-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x (a)</label>
                                                                                        <label class="en-lang">Coefficient of x (a)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="linearA" step="0.1" value="1">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">عدد ثابت (b)</label>
                                                                                        <label class="en-lang">Constant term (b)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="linearB" step="0.1" value="3">
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="solveLinearEquation()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">حل معادله</span>
                                                                                        <span class="en-lang">Solve Equation</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="equation-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">جواب معادله</div>
                                                                                        <div class="result-label en-lang">Solution</div>
                                                                                        <div class="result-value" id="linearSolution">x = -3</div>
                                                                                        <div class="result-formula">x = -b/a</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- معادله درجه دوم -->
                                                                            <div class="equation-form" id="quadratic-form">
                                                                                <div class="equation-illustration">
                                                                                    <div class="equation-display">
                                                                                        <span class="coefficient">a</span><span class="variable">x²</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">b</span><span class="variable">x</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">c</span>
                                                                                        <span class="operator">=</span>
                                                                                        <span class="constant">0</span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="equation-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x² (a)</label>
                                                                                        <label class="en-lang">Coefficient of x² (a)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="quadraticA" step="0.1" value="1">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x (b)</label>
                                                                                        <label class="en-lang">Coefficient of x (b)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="quadraticB" step="0.1" value="5">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">عدد ثابت (c)</label>
                                                                                        <label class="en-lang">Constant term (c)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="quadraticC" step="0.1" value="6">
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="solveQuadraticEquation()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">حل معادله</span>
                                                                                        <span class="en-lang">Solve Equation</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="equation-results">
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">دلتا (Δ)</div>
                                                                                        <div class="result-label en-lang">Discriminant (Δ)</div>
                                                                                        <div class="result-value" id="quadraticDiscriminant">1</div>
                                                                                        <div class="result-formula">Δ = b² - 4ac</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">جواب اول</div>
                                                                                        <div class="result-label en-lang">First Solution</div>
                                                                                        <div class="result-value" id="quadraticSolution1">x₁ = -2</div>
                                                                                    </div>
                                                                                    <div class="result-item">
                                                                                        <div class="result-label fa-lang">جواب دوم</div>
                                                                                        <div class="result-label en-lang">Second Solution</div>
                                                                                        <div class="result-value" id="quadraticSolution2">x₂ = -3</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                            <!-- معادله درجه سوم -->
                                                                            <div class="equation-form" id="cubic-form">
                                                                                <div class="equation-illustration">
                                                                                    <div class="equation-display">
                                                                                        <span class="coefficient">a</span><span class="variable">x³</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">b</span><span class="variable">x²</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">c</span><span class="variable">x</span>
                                                                                        <span class="operator">+</span>
                                                                                        <span class="coefficient">d</span>
                                                                                        <span class="operator">=</span>
                                                                                        <span class="constant">0</span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="equation-inputs">
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x³ (a)</label>
                                                                                        <label class="en-lang">Coefficient of x³ (a)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="cubicA" step="0.1" value="1">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x² (b)</label>
                                                                                        <label class="en-lang">Coefficient of x² (b)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="cubicB" step="0.1" value="-6">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">ضریب x (c)</label>
                                                                                        <label class="en-lang">Coefficient of x (c)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="cubicC" step="0.1" value="11">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label class="fa-lang">عدد ثابت (d)</label>
                                                                                        <label class="en-lang">Constant term (d)</label>
                                                                                        <div class="input-group">
                                                                                            <input type="number" id="cubicD" step="0.1" value="-6">
                                                                                            <span class="unit"></span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button class="calculate-btn" onclick="solveCubicEquation()">
                                                                                        <i class="fas fa-calculator"></i>
                                                                                        <span class="fa-lang">حل معادله</span>
                                                                                        <span class="en-lang">Solve Equation</span>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="equation-results">
                                                                                    <div class="result-item wide">
                                                                                        <div class="result-label fa-lang">جواب‌های معادله</div>
                                                                                        <div class="result-label en-lang">Solutions</div>
                                                                                        <div class="result-value" id="cubicSolution">
                                                                                            x₁ = 1, x₂ = 2, x₃ = 3
                                                                                        </div>
                                                                                        <div class="result-note fa-lang">
                                                                                            معادلات درجه سوم ممکن است یک تا سه جواب حقیقی داشته باشند.
                                                                                        </div>
                                                                                        <div class="result-note en-lang">
                                                                                            Cubic equations can have one to three real solutions.
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                 <!-- صفحه رسم نمودار -->
<div class="graph-page" id="graphPage">
    <div class="graph-header">
        <div class="graph-title fa-lang">رسم نمودار پیشرفته</div>
        <div class="graph-title en-lang">Advanced Graph Drawing</div>
        <button class="back-button" onclick="closeGraphPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span class="fa-lang">بازگشت</span>
            <span class="en-lang">Back</span>
        </button>
    </div>

    <div class="graph-content">
        <!-- کارت تابع ریاضی -->
        <div class="card function-card">
            <div class="card-header">
                <h2 class="fa-lang">تابع ریاضی</h2>
                <h2 class="en-lang">Mathematical Function</h2>
                <div class="function-tabs">
                    <button class="tab-btn active" data-tab="standard">
                        <span class="fa-lang">استاندارد</span>
                        <span class="en-lang">Standard</span>
                    </button>
                    <button class="tab-btn" data-tab="parametric">
                        <span class="fa-lang">پارامتری</span>
                        <span class="en-lang">Parametric</span>
                    </button>
                    <button class="tab-btn" data-tab="polar">
                        <span class="fa-lang">قطبی</span>
                        <span class="en-lang">Polar</span>
                    </button>
                </div>
            </div>

            <div class="card-body">
                <div class="tab-content active" id="standard-tab">
                    <div class="function-row">
                        <div class="function-label">f(x) =</div>
                        <div class="function-input-wrapper">
                            <input type="text" id="function-input" class="function-input" value="sin(x)" placeholder="مثال: x^2 + 3*x - 2">
                            <div class="function-color-picker">
                                <input type="color" id="function-color" value="#0066cc">
                            </div>
                        </div>
                        <button class="draw-btn" id="draw-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                            </svg>
                            <span class="fa-lang">رسم</span>
                            <span class="en-lang">Draw</span>
                        </button>
                    </div>

                    <div class="function-list" id="function-list">
                        <!-- توابع رسم شده اینجا نمایش داده می‌شوند -->
                    </div>

                    <div class="function-actions">
                        <button class="action-btn" id="add-function-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            <span class="fa-lang">تابع جدید</span>
                            <span class="en-lang">New Function</span>
                        </button>
                        <button class="action-btn" id="clear-all-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                            <span class="fa-lang">حذف همه</span>
                            <span class="en-lang">Clear All</span>
                        </button>
                    </div>
                </div>

                <div class="tab-content" id="parametric-tab">
                    <div class="parametric-inputs">
                        <div class="function-row">
                            <div class="function-label">x(t) =</div>
                            <input type="text" id="parametric-x" class="function-input" value="cos(t)" placeholder="مثال: cos(t)">
                        </div>
                        <div class="function-row">
                            <div class="function-label">y(t) =</div>
                            <input type="text" id="parametric-y" class="function-input" value="sin(t)" placeholder="مثال: sin(t)">
                        </div>
                        <div class="function-row range-row">
                            <div class="function-label">
                                <span class="fa-lang">بازه t:</span>
                                <span class="en-lang">t range:</span>
                            </div>
                            <div class="range-inputs">
                                <input type="number" id="t-min" value="0" step="0.1">
                                <span class="fa-lang">تا</span>
                                <span class="en-lang">to</span>
                                <input type="number" id="t-max" value="6.28" step="0.1">
                            </div>
                        </div>
                        <div class="function-row">
                            <div class="function-color-picker">
                                <input type="color" id="parametric-color" value="#e91e63">
                            </div>
                            <button class="draw-btn" id="draw-parametric-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                <span class="fa-lang">رسم</span>
                                <span class="en-lang">Draw</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="polar-tab">
                    <div class="function-row">
                        <div class="function-label">r(θ) =</div>
                        <div class="function-input-wrapper">
                            <input type="text" id="polar-input" class="function-input" value="2*cos(3*theta)" placeholder="مثال: 2*cos(3*theta)">
                            <div class="function-color-picker">
                                <input type="color" id="polar-color" value="#4caf50">
                            </div>
                        </div>
                        <button class="draw-btn" id="draw-polar-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                            </svg>
                            <span class="fa-lang">رسم</span>
                            <span class="en-lang">Draw</span>
                        </button>
                    </div>
                    <div class="function-row range-row">
                        <div class="function-label">
                            <span class="fa-lang">بازه θ:</span>
                            <span class="en-lang">θ range:</span>
                        </div>
                        <div class="range-inputs">
                            <input type="number" id="theta-min" value="0" step="0.1">
                            <span class="fa-lang">تا</span>
                            <span class="en-lang">to</span>
                            <input type="number" id="theta-max" value="6.28" step="0.1">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- کارت نمودار -->
        <div class="card graph-card">
            <div class="card-header graph-tools">
                <div class="tool-group">
                    <button class="tool-btn active" id="pan-btn" title="جابجایی">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 8V6a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" id="zoom-in-btn" title="بزرگنمایی">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            <line x1="11" y1="8" x2="11" y2="14"></line>
                            <line x1="8" y1="11" x2="14" y2="11"></line>
                        </svg>
                    </button>
                    <button class="tool-btn" id="zoom-out-btn" title="کوچک‌نمایی">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            <line x1="8" y1="11" x2="14" y2="11"></line>
                        </svg>
                    </button>
                    <button class="tool-btn" id="reset-btn" title="بازنشانی نما">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 2v6h6"></path>
                            <path d="M3 13a9 9 0 1 0 3-7.7L3 8"></path>
                        </svg>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" id="grid-btn" title="نمایش/عدم نمایش شبکه">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="3" y1="15" x2="21" y2="15"></line>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="15" y1="3" x2="15" y2="21"></line>
                        </svg>
                    </button>
                    <button class="tool-btn" id="axes-btn" title="نمایش/عدم نمایش محورها">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="3" x2="12" y2="21"></line>
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                        </svg>
                    </button>
                    <button class="tool-btn" id="labels-btn" title="نمایش/عدم نمایش برچسب‌ها">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 15L3 9 9 3"></path>
                            <path d="M15 3l6 6-6 6"></path>
                        </svg>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" id="save-btn" title="ذخیره تصویر">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="graph-container">
                <div class="loading-overlay" id="loading-overlay">
                    <div class="spinner"></div>
                    <p class="fa-lang">در حال رسم نمودار...</p>
                    <p class="en-lang">Drawing graph...</p>
                </div>
                <canvas id="graph-canvas"></canvas>
                <div class="graph-info">
                    <div class="coordinates" id="coordinates">x: 0.00, y: 0.00</div>
                    <div class="scale-info" id="scale-info">
                        <span class="fa-lang">مقیاس: 1:1</span>
                        <span class="en-lang">Scale: 1:1</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- کارت تنظیمات -->
        <div class="card settings-card">
            <div class="card-header">
                <h2 class="fa-lang">تنظیمات نمودار</h2>
                <h2 class="en-lang">Graph Settings</h2>
                <button class="collapse-btn" id="settings-collapse-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                </button>
            </div>
            <div class="card-body settings-body">
                <div class="settings-group">
                    <h3 class="fa-lang">محدوده محورها</h3>
                    <h3 class="en-lang">Axis Range</h3>
                    <div class="settings-row">
                        <label class="fa-lang">محور X:</label>
                        <label class="en-lang">X Axis:</label>
                        <div class="range-inputs">
                            <input type="number" id="x-min" value="-10" step="1">
                            <span class="fa-lang">تا</span>
                            <span class="en-lang">to</span>
                            <input type="number" id="x-max" value="10" step="1">
                        </div>
                    </div>
                    <div class="settings-row">
                        <label class="fa-lang">محور Y:</label>
                        <label class="en-lang">Y Axis:</label>
                        <div class="range-inputs">
                            <input type="number" id="y-min" value="-10" step="1">
                            <span class="fa-lang">تا</span>
                            <span class="en-lang">to</span>
                            <input type="number" id="y-max" value="10" step="1">
                        </div>
                    </div>
                    <button class="apply-btn" id="apply-range-btn">
                        <span class="fa-lang">اعمال محدوده</span>
                        <span class="en-lang">Apply Range</span>
                    </button>
                </div>

                <div class="settings-group">
                    <h3 class="fa-lang">سبک نمایش</h3>
                    <h3 class="en-lang">Display Style</h3>
                    <div class="settings-row">
                        <label class="fa-lang">ضخامت خط:</label>
                        <label class="en-lang">Line Width:</label>
                        <input type="range" id="line-width" min="1" max="5" value="2" class="slider">
                        <span id="line-width-value">2</span>
                    </div>
                    <div class="settings-row">
                        <label class="fa-lang">کیفیت رسم:</label>
                        <label class="en-lang">Render Quality:</label>
                        <select id="quality-select" class="quality-select">
                            <option value="low" class="fa-lang">پایین (سریع)</option>
                            <option value="low" class="en-lang">Low (Fast)</option>
                            <option value="medium" selected class="fa-lang">متوسط</option>
                            <option value="medium" class="en-lang">Medium</option>
                            <option value="high" class="fa-lang">بالا (کند)</option>
                            <option value="high" class="en-lang">High (Slow)</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="fa-lang">پیش‌نمایش‌های آماده</h3>
                    <h3 class="en-lang">Ready Presets</h3>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-preset="parabola">
                            <span class="fa-lang">سهمی</span>
                            <span class="en-lang">Parabola</span>
                        </button>
                        <button class="preset-btn" data-preset="sine">
                            <span class="fa-lang">سینوسی</span>
                            <span class="en-lang">Sine</span>
                        </button>
                        <button class="preset-btn" data-preset="circle">
                            <span class="fa-lang">دایره</span>
                            <span class="en-lang">Circle</span>
                        </button>
                        <button class="preset-btn" data-preset="flower">
                            <span class="fa-lang">گل</span>
                            <span class="en-lang">Flower</span>
                        </button>
                        <button class="preset-btn" data-preset="heart">
                            <span class="fa-lang">قلب</span>
                            <span class="en-lang">Heart</span>
                        </button>
                        <button class="preset-btn" data-preset="butterfly">
                            <span class="fa-lang">پروانه</span>
                            <span class="en-lang">Butterfly</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="toast-container" id="toast-container">
            <!-- اعلان‌ها اینجا نمایش داده می‌شوند -->
        </div>
    </div>
</div>

<!-- انیمیشن تغییر تم -->
<div class="theme-switch-animation" id="themeAnimation">
    <div class="theme-ball" id="themeBall"></div>
  </div>


<script>

                                                        // تنظیم وضعیت اولیه
                                                        document.addEventListener('DOMContentLoaded', function() {
                                                            // فعال‌سازی انیمیشن‌های صفحه درباره ما
                                                            const sections = document.querySelectorAll('.reveal-section');
                                                            sections.forEach(section => {
                                                                section.classList.add('active');
                                                            });

                                                            // فعال‌سازی نمودار درصد کدها
                                                            const chartBars = document.querySelectorAll('.chart-bar');
                                                            chartBars.forEach(bar => {
                                                                bar.classList.add('animated');
                                                            });

                                                            // رسم نمودار در صفحه رسم نمودار
                                                            setupGraph();
                                                        });

                                                        // نمایش/مخفی‌سازی منوی تنظیمات
                                                        function toggleSettingsMenu() {
                                                            const settingsIcon = document.getElementById('settingsIcon');
                                                            const settingsMenu = document.getElementById('settingsMenu');

                                                            settingsIcon.classList.toggle('active');
                                                            settingsMenu.classList.toggle('active');
                                                        }

                                                        // نمایش صفحه درباره ما
                                                        function showAboutPage() {
                                                            document.getElementById('aboutPage').classList.add('active');
                                                            toggleSettingsMenu();
                                                        }

                                                        // بستن صفحه درباره ما
                                                        function closeAboutPage() {
                                                            document.getElementById('aboutPage').classList.remove('active');
                                                        }

                                                        // نمایش صفحه محاسبات
                                                        function showCalculationPage() {
                                                            document.getElementById('calculationPage').classList.add('active');
                                                        }

                                                        // بستن صفحه محاسبات
                                                        function closeCalculationPage() {
                                                            document.getElementById('calculationPage').classList.remove('active');
                                                        }

                                                        // نمایش صفحه رسم نمودار
                                                        function showGraphPage() {
                                                            document.getElementById('graphPage').classList.add('active');
                                                            setTimeout(() => {
                                                                setupGraph();
                                                            }, 500);
                                                        }

                                                        // بستن صفحه رسم نمودار
                                                        function closeGraphPage() {
                                                            document.getElementById('graphPage').classList.remove('active');
                                                        }
  // تغییر تم روشن/تاریک
function toggleTheme() {
  const body = document.body;
  const themeAnimation = document.getElementById('themeAnimation');
  const themeBall = document.getElementById('themeBall');

  // نمایش انیمیشن
  themeAnimation.classList.add('active');

  // تغییر حالت توپ (خورشید/ماه)
  if (body.classList.contains('dark-theme')) {
    themeBall.classList.remove('moon');
    themeBall.classList.add('sun');

    // انیمیشن حرکت به سمت خورشید - مسیر بزرگتر
    themeBall.style.transform = 'translateY(-150px)';

    setTimeout(() => {
      body.classList.remove('dark-theme');
      themeAnimation.classList.remove('active');
      themeBall.style.transform = 'translateY(0)';
    }, 1200); // زمان کمی افزایش یافت
  } else {
    themeBall.classList.remove('sun');
    themeBall.classList.add('moon');

    // انیمیشن حرکت به سمت ماه - مسیر بزرگتر
    themeBall.style.transform = 'translateY(-150px)';

    setTimeout(() => {
      body.classList.add('dark-theme');
      themeAnimation.classList.remove('active');
      themeBall.style.transform = 'translateY(0)';
    }, 1200); // زمان کمی افزایش یافت
  }
}


                                                        // تغییر زبان سایت
                                                        function toggleLanguage() {
                                                            const html = document.documentElement;
                                                            html.setAttribute('lang', html.getAttribute('lang') === 'fa' ? 'en' : 'fa');
                                                            toggleSettingsMenu();
                                                        }

                                                      // توابع ماشین حساب مهندسی
let currentInput = '0';
let calculationHistory = '';

function updateCalculatorDisplay() {
  document.getElementById('calculatorDisplay').textContent = currentInput;
  document.getElementById('calculatorHistory').textContent = calculationHistory;
}

function calculatorAppend(value) {
  if (currentInput === '0') {
    currentInput = value;
  } else {
    currentInput += value;
  }
  updateCalculatorDisplay();
}

function calculatorOperation(op) {
  currentInput += op;
  updateCalculatorDisplay();
}

function calculatorFunction(func) {
  switch(func) {
    case 'sin':
      currentInput += 'Math.sin(';
      break;
    case 'cos':
      currentInput += 'Math.cos(';
      break;
    case 'tan':
      currentInput += 'Math.tan(';
      break;
    case 'log':
      currentInput += 'Math.log10(';
      break;
    case 'ln':
      currentInput += 'Math.log(';
      break;
    case 'sqrt':
      currentInput += 'Math.sqrt(';
      break;
    case 'pow':
      currentInput += '^';
      break;
    case 'abs':
      currentInput += 'Math.abs(';
      break;
  }
  updateCalculatorDisplay();
}

function calculatorConstant(constant) {
  switch(constant) {
    case 'pi':
      currentInput += 'Math.PI';
      break;
    case 'e':
      currentInput += 'Math.E';
      break;
  }
  updateCalculatorDisplay();
}

function calculatorClear() {
  currentInput = '0';
  calculationHistory = '';
  updateCalculatorDisplay();
}

function calculatorBackspace() {
  if (currentInput.length > 1) {
    currentInput = currentInput.slice(0, -1);
  } else {
    currentInput = '0';
  }
  updateCalculatorDisplay();
}

function calculatorCalculate() {
  try {
    // جایگزینی ^ با ** برای توان
    let expression = currentInput.replace(/\^/g, '**');

    // ارزیابی عبارت
    let result = eval(expression);

    // اضافه کردن به تاریخچه
    calculationHistory = currentInput + ' = ';
    currentInput = result.toString();
    updateCalculatorDisplay();
  } catch (error) {
    currentInput = 'Error';
    updateCalculatorDisplay();
    setTimeout(() => {
      currentInput = '0';
      updateCalculatorDisplay();
    }, 2000);
  }
}

// محاسبات هندسی
function calculateCircle() {
  const radius = parseFloat(document.getElementById('circleRadius').value);
  const area = Math.PI * radius * radius;
  const perimeter = 2 * Math.PI * radius;

  document.getElementById('circleArea').textContent = area.toFixed(2) + ' cm²';
  document.getElementById('circlePerimeter').textContent = perimeter.toFixed(2) + ' cm';
}

function calculateRectangle() {
  const width = parseFloat(document.getElementById('rectangleWidth').value);
  const height = parseFloat(document.getElementById('rectangleHeight').value);

  const area = width * height;
  const perimeter = 2 * (width + height);

  document.getElementById('rectangleArea').textContent = area.toFixed(2) + ' cm²';
  document.getElementById('rectanglePerimeter').textContent = perimeter.toFixed(2) + ' cm';
}

function calculateTriangle() {
  const a = parseFloat(document.getElementById('triangleSideA').value);
  const b = parseFloat(document.getElementById('triangleSideB').value);
  const c = parseFloat(document.getElementById('triangleSideC').value);

  // بررسی نامساوی مثلث
  if (a + b <= c || a + c <= b || b + c <= a) {
    document.getElementById('triangleArea').textContent = 'خطا: اضلاع نامعتبر';
    document.getElementById('trianglePerimeter').textContent = 'خطا: اضلاع نامعتبر';
    return;
  }

  const perimeter = a + b + c;
  const s = perimeter / 2;
  const area = Math.sqrt(s * (s - a) * (s - b) * (s - c)); // فرمول هرون

  document.getElementById('triangleArea').textContent = area.toFixed(2) + ' cm²';
  document.getElementById('trianglePerimeter').textContent = perimeter.toFixed(2) + ' cm';
}

function calculateEllipse() {
  const a = parseFloat(document.getElementById('ellipseMajor').value);
  const b = parseFloat(document.getElementById('ellipseMinor').value);

  const area = Math.PI * a * b;
  // تقریب محیط بیضی با فرمول رامانوجان
  const perimeter = Math.PI * (3 * (a + b) - Math.sqrt((3 * a + b) * (a + 3 * b)));

  document.getElementById('ellipseArea').textContent = area.toFixed(2) + ' cm²';
  document.getElementById('ellipsePerimeter').textContent = perimeter.toFixed(2) + ' cm';
}

function calculateTrapezoid() {
  const a = parseFloat(document.getElementById('trapezoidUpperBase').value);
  const b = parseFloat(document.getElementById('trapezoidLowerBase').value);
  const h = parseFloat(document.getElementById('trapezoidHeight').value);
  const c = parseFloat(document.getElementById('trapezoidLeftSide').value);
  const d = parseFloat(document.getElementById('trapezoidRightSide').value);

  const area = (a + b) * h / 2;
  const perimeter = a + b + c + d;

  document.getElementById('trapezoidArea').textContent = area.toFixed(2) + ' cm²';
  document.getElementById('trapezoidPerimeter').textContent = perimeter.toFixed(2) + ' cm';
}

// حل معادلات
function solveLinearEquation() {
  const a = parseFloat(document.getElementById('linearA').value);
  const b = parseFloat(document.getElementById('linearB').value);

  if (a === 0) {
    document.getElementById('linearSolution').textContent = 'خطا: ضریب a نمی‌تواند صفر باشد';
    return;
  }

  const x = -b / a;
  document.getElementById('linearSolution').textContent = 'x = ' + x.toFixed(4);
}

function solveQuadraticEquation() {
  const a = parseFloat(document.getElementById('quadraticA').value);
  const b = parseFloat(document.getElementById('quadraticB').value);
  const c = parseFloat(document.getElementById('quadraticC').value);

  if (a === 0) {
    document.getElementById('quadraticDiscriminant').textContent = 'خطا: ضریب a نمی‌تواند صفر باشد';
    document.getElementById('quadraticSolution1').textContent = '-';
    document.getElementById('quadraticSolution2').textContent = '-';
    return;
  }

  const discriminant = b * b - 4 * a * c;
  document.getElementById('quadraticDiscriminant').textContent = discriminant.toFixed(4);

  if (discriminant > 0) {
    const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
    const x2 = (-b - Math.sqrt(discriminant)) / (2 * a);
    document.getElementById('quadraticSolution1').textContent = 'x₁ = ' + x1.toFixed(4);
    document.getElementById('quadraticSolution2').textContent = 'x₂ = ' + x2.toFixed(4);
  } else if (discriminant === 0) {
    const x = -b / (2 * a);
    document.getElementById('quadraticSolution1').textContent = 'x = ' + x.toFixed(4);
    document.getElementById('quadraticSolution2').textContent = '(ریشه مضاعف)';
  } else {
    const realPart = -b / (2 * a);
    const imaginaryPart = Math.sqrt(-discriminant) / (2 * a);
    document.getElementById('quadraticSolution1').textContent = 'x₁ = ' + realPart.toFixed(2) + ' + ' + imaginaryPart.toFixed(2) + 'i';
    document.getElementById('quadraticSolution2').textContent = 'x₂ = ' + realPart.toFixed(2) + ' - ' + imaginaryPart.toFixed(2) + 'i';
  }
}

function solveCubicEquation() {
  const a = parseFloat(document.getElementById('cubicA').value);
  const b = parseFloat(document.getElementById('cubicB').value);
  const c = parseFloat(document.getElementById('cubicC').value);
  const d = parseFloat(document.getElementById('cubicD').value);

  if (a === 0) {
    document.getElementById('cubicSolution').textContent = 'خطا: ضریب a نمی‌تواند صفر باشد';
    return;
  }

  // استفاده از روش کاردانو برای حل معادله درجه سوم
  // تبدیل به فرم استاندارد x³ + px + q = 0
  const p = (3 * a * c - b * b) / (3 * a * a);
  const q = (2 * b * b * b - 9 * a * b * c + 27 * a * a * d) / (27 * a * a * a);

  const discriminant = 4 * p * p * p + 27 * q * q;

  let result = '';

  if (discriminant > 0) {
    // یک ریشه حقیقی و دو ریشه مختلط
    const u = Math.cbrt(-q/2 + Math.sqrt(q*q/4 + p*p*p/27));
    const v = Math.cbrt(-q/2 - Math.sqrt(q*q/4 + p*p*p/27));

    const x1 = u + v - b/(3*a);
    const realPart = -(u + v)/2 - b/(3*a);
    const imaginaryPart = Math.sqrt(3)*(u - v)/2;

    result = 'x₁ = ' + x1.toFixed(4) + ', x₂ = ' + realPart.toFixed(4) + ' + ' + imaginaryPart.toFixed(4) + 'i, x₃ = ' + realPart.toFixed(4) + ' - ' + imaginaryPart.toFixed(4) + 'i';
  } else if (discriminant === 0) {
    // سه ریشه حقیقی که حداقل دو تای آنها برابرند
    const u = Math.cbrt(-q/2);
    const x1 = 2 * u - b/(3*a);
    const x2 = -u - b/(3*a);

    result = 'x₁ = ' + x1.toFixed(4) + ', x₂ = x₃ = ' + x2.toFixed(4);
  } else {
    // سه ریشه حقیقی متمایز
    const r = Math.sqrt(-p*p*p/27);
    const theta = Math.acos(-q/(2*r));

    const x1 = 2 * Math.cbrt(r) * Math.cos(theta/3) - b/(3*a);
    const x2 = 2 * Math.cbrt(r) * Math.cos((theta + 2*Math.PI)/3) - b/(3*a);
    const x3 = 2 * Math.cbrt(r) * Math.cos((theta + 4*Math.PI)/3) - b/(3*a);

    result = 'x₁ = ' + x1.toFixed(4) + ', x₂ = ' + x2.toFixed(4) + ', x₃ = ' + x3.toFixed(4);
  }

  document.getElementById('cubicSolution').textContent = result;
}

// تابع نمایش/مخفی‌سازی صفحه محاسبات
function showCalculationPage() {
  document.getElementById('calculationPage').classList.add('active');
}

function closeCalculationPage() {
  document.getElementById('calculationPage').classList.remove('active');
}

// اضافه کردن رویداد به دکمه‌های محاسبه در زمان بارگذاری صفحه
document.addEventListener('DOMContentLoaded', function() {
  // فعال‌سازی تب‌های محاسبات
  const calcTabBtns = document.querySelectorAll('.calc-tab-btn');
  calcTabBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      // حذف کلاس active از همه تب‌ها
      calcTabBtns.forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.calc-tab-content').forEach(c => c.classList.remove('active'));

      // اضافه کردن کلاس active به تب انتخاب شده
      this.classList.add('active');
      const tabId = this.getAttribute('data-tab');
      document.getElementById(`${tabId}-tab`).classList.add('active');
    });
  });

  // انتخاب شکل‌ها
  const shapeOptions = document.querySelectorAll('.shape-option');
  shapeOptions.forEach(option => {
    option.addEventListener('click', function() {
      // حذف کلاس active از همه گزینه‌ها
      shapeOptions.forEach(o => o.classList.remove('active'));
      document.querySelectorAll('.shape-form').forEach(f => f.classList.remove('active'));

      // اضافه کردن کلاس active به گزینه انتخاب شده
      this.classList.add('active');
      const shapeId = this.getAttribute('data-shape');
      document.getElementById(`${shapeId}-form`).classList.add('active');
    });
  });

  // انتخاب نوع معادله
  const equationTypeBtns = document.querySelectorAll('.equation-type-btn');
  equationTypeBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      // حذف کلاس active از همه دکمه‌ها
      equationTypeBtns.forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.equation-form').forEach(f => f.classList.remove('active'));

      // اضافه کردن کلاس active به دکمه انتخاب شده
      this.classList.add('active');
      const equationId = this.getAttribute('data-equation');
      document.getElementById(`${equationId}-form`).classList.add('active');
    });
  });

  // فعال‌سازی محاسبه اولیه برای هر بخش
  // این بخش را می‌توان در صورت نیاز فعال کرد
  try {
    calculateCircle();
    calculateRectangle();
    calculateTriangle();
    calculateEllipse();
    calculateTrapezoid();
    solveLinearEquation();
    solveQuadraticEquation();
    solveCubicEquation();
  } catch (error) {
    console.log('Some calculation elements might not be loaded yet');
  }

  // اضافه کردن رویداد به دکمه نمایش صفحه محاسبات
  const calculationButtons = document.querySelectorAll('[onclick="showCalculationPage()"]');
  calculationButtons.forEach(button => {
    button.addEventListener('click', function() {
      showCalculationPage();
    });
  });

  // اضافه کردن رویداد به دکمه بستن صفحه محاسبات
  const closeCalculationButtons = document.querySelectorAll('[onclick="closeCalculationPage()"]');
  closeCalculationButtons.forEach(button => {
    button.addEventListener('click', function() {
      closeCalculationPage();
    });
  });

  // تنظیم رویدادهای ورودی عددی
  setupNumericInputEvents();
});

// تنظیم رویدادهای ورودی عددی
function setupNumericInputEvents() {
  // اضافه کردن رویداد به ورودی‌های عددی برای جلوگیری از ورود مقادیر نامعتبر
  const numericInputs = document.querySelectorAll('input[type="number"]');
  numericInputs.forEach(input => {
    input.addEventListener('input', function() {
      // حذف کاراکترهای غیر عددی (به جز نقطه و منفی)
      this.value = this.value.replace(/[^\d.-]/g, '');

      // جلوگیری از ورود بیش از یک نقطه
      const pointCount = (this.value.match(/\./g) || []).length;
      if (pointCount > 1) {
        this.value = this.value.replace(/\.(?=.*\.)/g, '');
      }

      // جلوگیری از ورود بیش از یک منفی و قرار دادن آن فقط در ابتدا
      const minusCount = (this.value.match(/-/g) || []).length;
      if (minusCount > 1 || (minusCount === 1 && this.value.indexOf('-') !== 0)) {
        this.value = this.value.replace(/-/g, '');
        if (minusCount >= 1) {
          this.value = '-' + this.value;
        }
      }
    });
  });

  // اضافه کردن رویداد به دکمه‌های محاسبه در بخش‌های مختلف
  const calculateButtons = document.querySelectorAll('.calculate-btn');
  calculateButtons.forEach(button => {
    // بررسی نوع محاسبه بر اساس متن دکمه یا نزدیک‌ترین والد
    const parentContainer = button.closest('.shape-form, .equation-form');
    if (parentContainer) {
      button.addEventListener('click', function() {
        const containerId = parentContainer.id;

        // فراخوانی تابع مناسب بر اساس شناسه ظرف
        if (containerId === 'circle-form') {
          calculateCircle();
        } else if (containerId === 'rectangle-form') {
          calculateRectangle();
        } else if (containerId === 'triangle-form') {
          calculateTriangle();
        } else if (containerId === 'ellipse-form') {
          calculateEllipse();
        } else if (containerId === 'trapezoid-form') {
          calculateTrapezoid();
        } else if (containerId === 'linear-form') {
          solveLinearEquation();
        } else if (containerId === 'quadratic-form') {
          solveQuadraticEquation();
        } else if (containerId === 'cubic-form') {
          solveCubicEquation();
        }
      });
    }
  });
}

// تابع برای اجرای کد پس از بارگذاری کامل صفحه
function initCalculationPage() {
  // بررسی وجود المان‌های مورد نیاز
  const calculationPage = document.getElementById('calculationPage');
  if (!calculationPage) {
    console.error('Calculation page element not found!');
    return;
  }

  // بررسی وجود المان‌های اصلی ماشین حساب
  const calculatorDisplay = document.getElementById('calculatorDisplay');
  const calculatorHistory = document.getElementById('calculatorHistory');
  if (calculatorDisplay && calculatorHistory) {
    // تنظیم مقادیر اولیه
    currentInput = '0';
    calculationHistory = '';
    updateCalculatorDisplay();
  }

  // نمایش تب فعال به صورت پیش‌فرض
  const activeTab = document.querySelector('.calc-tab-btn.active');
  if (activeTab) {
    const tabId = activeTab.getAttribute('data-tab');
    const tabContent = document.getElementById(`${tabId}-tab`);
    if (tabContent) {
      tabContent.classList.add('active');
    }
  }

  // نمایش فرم شکل فعال به صورت پیش‌فرض
  const activeShape = document.querySelector('.shape-option.active');
  if (activeShape) {
    const shapeId = activeShape.getAttribute('data-shape');
    const shapeForm = document.getElementById(`${shapeId}-form`);
    if (shapeForm) {
      shapeForm.classList.add('active');
    }
  }

  // نمایش فرم معادله فعال به صورت پیش‌فرض
  const activeEquation = document.querySelector('.equation-type-btn.active');
  if (activeEquation) {
    const equationId = activeEquation.getAttribute('data-equation');
    const equationForm = document.getElementById(`${equationId}-form`);
    if (equationForm) {
      equationForm.classList.add('active');
    }
  }

  console.log('Calculation page initialized successfully');
}

// فراخوانی تابع مقداردهی اولیه پس از بارگذاری صفحه
window.addEventListener('load', initCalculationPage);

// تابع برای تغییر زبان المان‌های صفحه محاسبات
function updateCalculationLanguage() {
  const isEnglish = document.documentElement.lang === 'en';

  // به‌روزرسانی متن‌های دکمه‌ها و برچسب‌ها بر اساس زبان
  document.querySelectorAll('.fa-lang, .en-lang').forEach(element => {
    if (isEnglish) {
      element.style.display = element.classList.contains('en-lang') ? 'block' : 'none';
    } else {
      element.style.display = element.classList.contains('fa-lang') ? 'block' : 'none';
    }
  });

  // تغییر جهت صفحه بر اساس زبان
  if (isEnglish) {
    document.querySelector('.calculation-page').style.direction = 'ltr';
  } else {
    document.querySelector('.calculation-page').style.direction = 'rtl';
  }
}

// اضافه کردن رویداد تغییر زبان
document.addEventListener('languageChanged', updateCalculationLanguage);

// اضافه کردن این تابع به window برای دسترسی از خارج
window.updateCalculationLanguage = updateCalculationLanguage;

                                                      // بارگذاری نمونه کدها
// بارگذاری نمونه کدها
function loadCodeSamples() {
  // HTML code sample
  const htmlSample = [
    { number: 1, text: '<span class="tag">&lt;!DOCTYPE html&gt;</span>' },
    { number: 2, text: '<span class="tag">&lt;html</span> <span class="attribute">lang</span>=<span class="value">"fa"</span> <span class="attribute">dir</span>=<span class="value">"rtl"</span><span class="tag">&gt;</span>' },
    { number: 3, text: '<span class="tag">&lt;head&gt;</span>' },
    { number: 4, text: '  <span class="tag">&lt;meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span><span class="tag">&gt;</span>' },
    { number: 5, text: '  <span class="tag">&lt;meta</span> <span class="attribute">name</span>=<span class="value">"viewport"</span> <span class="attribute">content</span>=<span class="value">"width=device-width, initial-scale=1.0"</span><span class="tag">&gt;</span>' },
    { number: 6, text: '  <span class="tag">&lt;title&gt;</span>هوش آرا | سایت آموزش ریاضی<span class="tag">&lt;/title&gt;</span>' },
    { number: 7, text: '  <span class="tag">&lt;link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"styles.css"</span><span class="tag">&gt;</span>' },
    { number: 8, text: '<span class="tag">&lt;/head&gt;</span>' },
    { number: 9, text: '<span class="tag">&lt;body&gt;</span>' },
    { number: 10, text: '  <span class="tag">&lt;header</span> <span class="attribute">class</span>=<span class="value">"main-header"</span><span class="tag">&gt;</span>' },
    { number: 11, text: '    <span class="tag">&lt;div</span> <span class="attribute">class</span>=<span class="value">"logo"</span><span class="tag">&gt;</span>' },
    { number: 12, text: '      <span class="tag">&lt;img</span> <span class="attribute">src</span>=<span class="value">"logo.svg"</span> <span class="attribute">alt</span>=<span class="value">"هوش آرا"</span><span class="tag">&gt;</span>' },
    { number: 13, text: '      <span class="tag">&lt;h1&gt;</span>هوش آرا<span class="tag">&lt;/h1&gt;</span>' },
    { number: 14, text: '    <span class="tag">&lt;/div&gt;</span>' },
    { number: 15, text: '  <span class="tag">&lt;/header&gt;</span>' },
    { number: 16, text: '  <span class="comment">&lt;!-- محتوای اصلی --&gt;</span>' },
    { number: 17, text: '<span class="tag">&lt;/body&gt;</span>' },
    { number: 18, text: '<span class="tag">&lt;/html&gt;</span>' }
  ];

  // CSS code sample
  const cssSample = [
    { number: 1, text: '<span class="comment">/* استایل‌های پایه */</span>' },
    { number: 2, text: '<span class="selector">*</span> {' },
    { number: 3, text: '  <span class="property">margin</span>: <span class="value">0</span>;' },
    { number: 4, text: '  <span class="property">padding</span>: <span class="value">0</span>;' },
    { number: 5, text: '  <span class="property">box-sizing</span>: <span class="value">border-box</span>;' },
    { number: 6, text: '}' },
    { number: 7, text: '' },
    { number: 8, text: '<span class="selector">:root</span> {' },
    { number: 9, text: '  <span class="property">--primary-color</span>: <span class="value">#0066cc</span>;' },
    { number: 10, text: '  <span class="property">--hover-color</span>: <span class="value">#0055b3</span>;' },
    { number: 11, text: '  <span class="property">--bg-color</span>: <span class="value">#f9f3e6</span>;' },
    { number: 12, text: '  <span class="property">--text-color</span>: <span class="value">#333</span>;' },
    { number: 13, text: '}' },
    { number: 14, text: '' },
    { number: 15, text: '<span class="selector">body</span> {' },
    { number: 16, text: '  <span class="property">font-family</span>: <span class="value">\'Vazir\', \'Tahoma\', Arial, sans-serif</span>;' },
    { number: 17, text: '  <span class="property">background-color</span>: <span class="value">var(--bg-color)</span>;' },
    { number: 18, text: '  <span class="property">color</span>: <span class="value">var(--text-color)</span>;' },
    { number: 19, text: '  <span class="property">direction</span>: <span class="value">rtl</span>;' },
    { number: 20, text: '}' },
    { number: 21, text: '' },
    { number: 22, text: '<span class="selector">.main-header</span> {' },
    { number: 23, text: '  <span class="property">display</span>: <span class="value">flex</span>;' },
    { number: 24, text: '  <span class="property">justify-content</span>: <span class="value">space-between</span>;' },
    { number: 25, text: '  <span class="property">align-items</span>: <span class="value">center</span>;' },
    { number: 26, text: '  <span class="property">padding</span>: <span class="value">20px</span>;' },
    { number: 27, text: '  <span class="property">background-color</span>: <span class="value">white</span>;' },
    { number: 28, text: '  <span class="property">box-shadow</span>: <span class="value">0 2px 10px rgba(0, 0, 0, 0.1)</span>;' },
    { number: 29, text: '}' }
  ];

  // JavaScript code sample
  const jsSample = [
    { number: 1, text: '<span class="comment">// انیمیشن منوی آچاری</span>' },
    { number: 2, text: '<span class="keyword">function</span> <span class="function">toggleSettingsMenu</span>() {' },
    { number: 3, text: '  <span class="keyword">const</span> <span class="variable">menu</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'settingsMenu\'</span>);' },
    { number: 4, text: '  <span class="keyword">const</span> <span class="variable">icon</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'settingsIcon\'</span>);' },
    { number: 5, text: '' },
    { number: 6, text: '  <span class="variable">menu</span>.<span class="property">classList</span>.<span class="function">toggle</span>(<span class="string">\'active\'</span>);' },
    { number: 7, text: '  <span class="variable">icon</span>.<span class="property">classList</span>.<span class="function">toggle</span>(<span class="string">\'active\'</span>);' },
    { number: 8, text: '' },
    { number: 9, text: '  <span class="comment">// اگر منو فعال شد، آیکون را بچرخان</span>' },
    { number: 10, text: '  <span class="keyword">if</span> (<span class="variable">menu</span>.<span class="property">classList</span>.<span class="function">contains</span>(<span class="string">\'active\'</span>)) {' },
    { number: 11, text: '    <span class="variable">icon</span>.<span class="function">querySelector</span>(<span class="string">\'svg\'</span>).<span class="property">style</span>.<span class="property">transform</span> = <span class="string">\'rotate(180deg)\'</span>;' },
    { number: 12, text: '  } <span class="keyword">else</span> {' },
    { number: 13, text: '    <span class="variable">icon</span>.<span class="function">querySelector</span>(<span class="string">\'svg\'</span>).<span class="property">style</span>.<span class="property">transform</span> = <span class="string">\'rotate(0)\'</span>;' },
    { number: 14, text: '  }' },
    { number: 15, text: '}' },
    { number: 16, text: '' },
    { number: 17, text: '<span class="comment">// تغییر تم روشن/تاریک</span>' },
    { number: 18, text: '<span class="keyword">function</span> <span class="function">toggleTheme</span>() {' },
    { number: 19, text: '  <span class="keyword">const</span> <span class="variable">body</span> = <span class="variable">document</span>.<span class="property">body</span>;' },
    { number: 20, text: '  <span class="variable">body</span>.<span class="property">classList</span>.<span class="function">toggle</span>(<span class="string">\'dark-theme\'</span>);' },
    { number: 21, text: '}' },
    { number: 22, text: '' },
    { number: 23, text: '<span class="comment">// محاسبه عبارت ریاضی</span>' },
    { number: 24, text: '<span class="keyword">function</span> <span class="function">calculate</span>() {' },
    { number: 25, text: '  <span class="keyword">const</span> <span class="variable">expression</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'expression\'</span>).<span class="property">value</span>;' },
    { number: 26, text: '  <span class="keyword">try</span> {' },
    { number: 27, text: '    <span class="keyword">const</span> <span class="variable">result</span> = <span class="function">eval</span>(<span class="variable">expression</span>);' },
    { number: 28, text: '    <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'resultValue\'</span>).<span class="property">textContent</span> = <span class="variable">result</span>;' },
    { number: 29, text: '    <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'resultContainer\'</span>).<span class="property">classList</span>.<span class="function">add</span>(<span class="string">\'active\'</span>);' },
    { number: 30, text: '  } <span class="keyword">catch</span> (<span class="variable">error</span>) {' },
    { number: 31, text: '    <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'resultValue\'</span>).<span class="property">textContent</span> = <span class="string">\'خطا در محاسبه\'</span>;' },
    { number: 32, text: '    <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">\'resultContainer\'</span>).<span class="property">classList</span>.<span class="function">add</span>(<span class="string">\'active\'</span>);' },
    { number: 33, text: '  }' },
    { number: 34, text: '}' }
  ];

  // React code sample
  const reactSample = [
    { number: 1, text: '<span class="keyword">import</span> React, { useState, useEffect } <span class="keyword">from</span> <span class="string">\'react\'</span>;' },
    { number: 2, text: '' },
    { number: 3, text: '<span class="keyword">const</span> <span class="function">MathCalculator</span> = () => {' },
    { number: 4, text: '  <span class="keyword">const</span> [<span class="variable">expression</span>, <span class="variable">setExpression</span>] = <span class="function">useState</span>(<span class="string">\'\'</span>);' },
    { number: 5, text: '  <span class="keyword">const</span> [<span class="variable">result</span>, <span class="variable">setResult</span>] = <span class="function">useState</span>(<span class="string">\'\'</span>);' },
    { number: 6, text: '  <span class="keyword">const</span> [<span class="variable">error</span>, <span class="variable">setError</span>] = <span class="function">useState</span>(<span class="string">\'\'</span>);' },
    { number: 7, text: '' },
    { number: 8, text: '  <span class="keyword">const</span> <span class="function">calculateResult</span> = () => {' },
    { number: 9, text: '    <span class="keyword">try</span> {' },
    { number: 10, text: '      <span class="keyword">const</span> <span class="variable">calculatedResult</span> = <span class="function">eval</span>(<span class="variable">expression</span>);' },
    { number: 11, text: '      <span class="variable">setResult</span>(<span class="variable">calculatedResult</span>);' },
    { number: 12, text: '      <span class="variable">setError</span>(<span class="string">\'\'</span>);' },
    { number: 13, text: '    } <span class="keyword">catch</span> (<span class="variable">err</span>) {' },
    { number: 14, text: '      <span class="variable">setError</span>(<span class="string">\'خطا در محاسبه\'</span>);' },
    { number: 15, text: '      <span class="variable">setResult</span>(<span class="string">\'\'</span>);' },
    { number: 16, text: '    }' },
    { number: 17, text: '  };' },
    { number: 18, text: '' },
    { number: 19, text: '  <span class="keyword">return</span> (' },
    { number: 20, text: '    <span class="tag">&lt;div</span> <span class="attribute">className</span>=<span class="string">"calculator"</span><span class="tag">&gt;</span>' },
    { number: 21, text: '      <span class="tag">&lt;input</span>' },
    { number: 22, text: '        <span class="attribute">type</span>=<span class="string">"text"</span>' },
    { number: 23, text: '        <span class="attribute">value</span>={<span class="variable">expression</span>}' },
    { number: 24, text: '        <span class="attribute">onChange</span>={(<span class="variable">e</span>) => <span class="variable">setExpression</span>(<span class="variable">e</span>.<span class="property">target</span>.<span class="property">value</span>)}' },
    { number: 25, text: '        <span class="attribute">placeholder</span>=<span class="string">"عبارت ریاضی را وارد کنید"</span>' },
    { number: 26, text: '      <span class="tag">/&gt;</span>' },
    { number: 27, text: '      <span class="tag">&lt;button</span> <span class="attribute">onClick</span>={<span class="variable">calculateResult</span>}<span class="tag">&gt;</span>محاسبه<span class="tag">&lt;/button&gt;</span>' },
    { number: 28, text: '      {<span class="variable">result</span> && <span class="tag">&lt;div</span> <span class="attribute">className</span>=<span class="string">"result"</span><span class="tag">&gt;</span>{<span class="variable">result</span>}<span class="tag">&lt;/div&gt;</span>}' },
    { number: 29, text: '      {<span class="variable">error</span> && <span class="tag">&lt;div</span> <span class="attribute">className</span>=<span class="string">"error"</span><span class="tag">&gt;</span>{<span class="variable">error</span>}<span class="tag">&lt;/div&gt;</span>}' },
    { number: 30, text: '    <span class="tag">&lt;/div&gt;</span>' },
    { number: 31, text: '  );' },
    { number: 32, text: '};' },
    { number: 33, text: '' },
    { number: 34, text: '<span class="keyword">export default</span> MathCalculator;' }
  ];

  // Vue.js code sample
  const vueSample = [
    { number: 1, text: '<span class="tag">&lt;template&gt;</span>' },
    { number: 2, text: '  <span class="tag">&lt;div</span> <span class="attribute">class</span>=<span class="string">"calculator"</span><span class="tag">&gt;</span>' },
    { number: 3, text: '    <span class="tag">&lt;input</span>' },
    { number: 4, text: '      <span class="attribute">type</span>=<span class="string">"text"</span>' },
    { number: 5, text: '      <span class="attribute">v-model</span>=<span class="string">"expression"</span>' },
    { number: 6, text: '      <span class="attribute">placeholder</span>=<span class="string">"عبارت ریاضی را وارد کنید"</span>' },
    { number: 7, text: '    <span class="tag">/&gt;</span>' },
    { number: 8, text: '    <span class="tag">&lt;button</span> <span class="attribute">@click</span>=<span class="string">"calculateResult"</span><span class="tag">&gt;</span>محاسبه<span class="tag">&lt;/button&gt;</span>' },
    { number: 9, text: '    <span class="tag">&lt;div</span> <span class="attribute">v-if</span>=<span class="string">"result"</span> <span class="attribute">class</span>=<span class="string">"result"</span><span class="tag">&gt;</span>{{ result }}<span class="tag">&lt;/div&gt;</span>' },
    { number: 10, text: '    <span class="tag">&lt;div</span> <span class="attribute">v-if</span>=<span class="string">"error"</span> <span class="attribute">class</span>=<span class="string">"error"</span><span class="tag">&gt;</span>{{ error }}<span class="tag">&lt;/div&gt;</span>' },
    { number: 11, text: '  <span class="tag">&lt;/div&gt;</span>' },
    { number: 12, text: '<span class="tag">&lt;/template&gt;</span>' },
    { number: 13, text: '' },
    { number: 14, text: '<span class="tag">&lt;script&gt;</span>' },
    { number: 15, text: '<span class="keyword">export default</span> {' },
    { number: 16, text: '  <span class="property">name</span>: <span class="string">\'MathCalculator\'</span>,' },
    { number: 17, text: '  <span class="property">data</span>() {' },
    { number: 18, text: '    <span class="keyword">return</span> {' },
    { number: 19, text: '      <span class="property">expression</span>: <span class="string">\'\'</span>,' },
    { number: 20, text: '      <span class="property">result</span>: <span class="string">\'\'</span>,' },
    { number: 21, text: '      <span class="property">error</span>: <span class="string">\'\'</span>' },
    { number: 22, text: '    };' },
    { number: 23, text: '  },' },
    { number: 24, text: '  <span class="property">methods</span>: {' },
    { number: 25, text: '    <span class="function">calculateResult</span>() {' },
    { number: 26, text: '      <span class="keyword">try</span> {' },
    { number: 27, text: '        <span class="keyword">this</span>.<span class="property">result</span> = <span class="function">eval</span>(<span class="keyword">this</span>.<span class="property">expression</span>);' },
    { number: 28, text: '        <span class="keyword">this</span>.<span class="property">error</span> = <span class="string">\'\'</span>;' },
    { number: 29, text: '      } <span class="keyword">catch</span> (<span class="variable">err</span>) {' },
    { number: 30, text: '        <span class="keyword">this</span>.<span class="property">error</span> = <span class="string">\'خطا در محاسبه\'</span>;' },
    { number: 31, text: '        <span class="keyword">this</span>.<span class="property">result</span> = <span class="string">\'\'</span>;' },
    { number: 32, text: '      }' },
    { number: 33, text: '    }' },
    { number: 34, text: '  }' },
    { number: 35, text: '};' },
    { number: 36, text: '<span class="tag">&lt;/script&gt;</span>' }
  ];

  // بارگذاری نمونه کدها در المنت‌های مربوطه
  loadCodeToElement('htmlCode', htmlSample);
  loadCodeToElement('cssCode', cssSample);
  loadCodeToElement('jsCode', jsSample);
  loadCodeToElement('reactCode', reactSample);
  loadCodeToElement('vueCode', vueSample);
}

// نمایش کد در المنت
function loadCodeToElement(elementId, codeSample) {
  const codeElement = document.getElementById(elementId);
  codeElement.innerHTML = '';

  codeSample.forEach((line, index) => {
    const codeLine = document.createElement('div');
    codeLine.className = 'code-line';
    codeLine.style.animationDelay = `${index * 0.05}s`;

    const lineNumber = document.createElement('div');
    lineNumber.className = 'line-number';
    lineNumber.textContent = line.number;

    const codeText = document.createElement('div');
    codeText.className = 'code-text';
    codeText.innerHTML = line.text;

    codeLine.appendChild(lineNumber);
    codeLine.appendChild(codeText);
    codeElement.appendChild(codeLine);

    // اضافه کردن مکان‌نما به آخرین خط
    if (index === codeSample.length - 1) {
      const cursor = document.createElement('span');
      cursor.className = 'typing-cursor';
      codeText.appendChild(cursor);
    }
  });
}

// تنظیمات اولیه صفحه
document.addEventListener('DOMContentLoaded', function() {
  // بارگذاری نمونه کدها
  loadCodeSamples();

  // نمایش نمودارهای پیشرفت - کد جدید برای ترکیب کدهای سایت
  setTimeout(() => {
    document.getElementById('htmlProgress').style.width = '42%';
    document.getElementById('cssProgress').style.width = '35%';
    document.getElementById('jsProgress').style.width = '20%';
    document.getElementById('svgProgress').style.width = '8%';
  }, 500);

  // تنظیم تب‌های زبان‌های برنامه‌نویسی
  const languageTabs = document.querySelectorAll('.language-tab');
  languageTabs.forEach(tab => {
    tab.addEventListener('click', () => {
      // حذف کلاس active از همه تب‌ها
      languageTabs.forEach(t => t.classList.remove('active'));
      // اضافه کردن کلاس active به تب کلیک شده
      tab.classList.add('active');

      // نمایش محتوای مربوط به تب
      const tabId = tab.getAttribute('data-tab');
      document.querySelectorAll('.code-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(`${tabId}Code`).classList.add('active');
    });
  });
});

// تعریف یک شیء برای نگهداری متغیرهای صفحه رسم نمودار
window.graphApp = {
    canvas: null,
    ctx: null,
    functions: [],
    isDragging: false,
    lastX: 0,
    lastY: 0,
    scale: 1,
    offsetX: 0,
    offsetY: 0,
    xMin: -10,
    xMax: 10,
    yMin: -10,
    yMax: 10,
    showGrid: true,
    showAxes: true,
    showLabels: true,
    lineWidth: 2,
    currentTab: 'standard',
    activeToolButton: 'pan-btn',
    renderQuality: 'medium',
    initialized: false
};

// نمایش صفحه رسم نمودار
function showGraphPage() {
    document.getElementById('graphPage').classList.add('active');

    // بررسی وجود کتابخانه math.js
    if (typeof math === 'undefined') {
        // بارگذاری کتابخانه math.js
        const script = document.createElement('script');
        script.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js";
        script.onload = function() {
            console.log('Math.js loaded successfully');
            initializeGraph();
        };
        document.head.appendChild(script);
    } else {
        initializeGraph();
    }

    // بررسی وجود کتابخانه Font Awesome
    if (!document.querySelector('link[href*="font-awesome"]')) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
        document.head.appendChild(link);
    }
}

// بستن صفحه رسم نمودار
function closeGraphPage() {
    document.getElementById('graphPage').classList.remove('active');
}

// مقداردهی اولیه گراف
function initializeGraph() {
    const app = window.graphApp;

    // اگر قبلاً مقداردهی شده، فقط رسم مجدد انجام شود
    if (app.initialized) {
        drawGraph();
        return;
    }

    // تنظیم کانواس
    app.canvas = document.getElementById('graph-canvas');
    if (!app.canvas) {
        console.error('Canvas element not found');
        return;
    }

    app.ctx = app.canvas.getContext('2d');
    resizeCanvas();

    // افزودن رویدادهای مربوط به کانواس
    setupCanvasEvents();

    // افزودن رویدادهای مربوط به دکمه‌ها
    setupButtonEvents();

    // افزودن رویدادهای مربوط به تب‌ها
    setupTabEvents();

    // افزودن رویدادهای مربوط به تنظیمات
    setupSettingsEvents();

    // رسم نمودار اولیه
    drawGraph();

    // نمایش اعلان خوش‌آمدگویی
    const welcomeMessage = document.documentElement.lang === 'fa' ?
        'به رسم نمودار پیشرفته خوش آمدید!' :
        'Welcome to Advanced Graph Drawing!';
    showToast('اطلاعات', welcomeMessage, 'info');

    // رسم تابع اولیه (سینوس)
    drawFunction();

    // علامت‌گذاری به عنوان مقداردهی شده
    app.initialized = true;
}

// تنظیم اندازه کانواس
function resizeCanvas() {
    const app = window.graphApp;
    const container = app.canvas.parentElement;
    app.canvas.width = container.offsetWidth;
    app.canvas.height = container.offsetHeight;
    // رسم مجدد نمودار پس از تغییر اندازه
    drawGraph();
}

// افزودن رویدادهای مربوط به کانواس
function setupCanvasEvents() {
    const app = window.graphApp;

    // رویداد تغییر اندازه پنجره
    window.addEventListener('resize', resizeCanvas);

    // رویدادهای مربوط به درگ کردن
    app.canvas.addEventListener('mousedown', function(e) {
        if (app.activeToolButton === 'pan-btn') {
            app.isDragging = true;
            app.lastX = e.clientX;
            app.lastY = e.clientY;
            app.canvas.style.cursor = 'grabbing';
        }
    });

    app.canvas.addEventListener('mousemove', function(e) {
        // نمایش مختصات
        updateCoordinates(e);

        if (app.isDragging && app.activeToolButton === 'pan-btn') {
            const deltaX = e.clientX - app.lastX;
            const deltaY = e.clientY - app.lastY;

            // تغییر جابجایی براساس مقیاس
            app.offsetX += deltaX / app.scale;
            app.offsetY -= deltaY / app.scale;

            app.lastX = e.clientX;
            app.lastY = e.clientY;

            // رسم مجدد نمودار
            drawGraph();
        }
    });

    app.canvas.addEventListener('mouseup', function() {
        app.isDragging = false;
        app.canvas.style.cursor = 'grab';
    });

    app.canvas.addEventListener('mouseleave', function() {
        app.isDragging = false;
        app.canvas.style.cursor = 'grab';
    });

    // رویداد اسکرول برای زوم
    app.canvas.addEventListener('wheel', function(e) {
        e.preventDefault();

        // تعیین مرکز زوم (موقعیت موس)
        const rect = app.canvas.getBoundingClientRect();
        const mouseX = e.clientX - rect.left;
        const mouseY = e.clientY - rect.top;

        // تبدیل موقعیت موس به مختصات ریاضی
        const mathX = ((mouseX - app.canvas.width / 2) / app.scale) - app.offsetX;
        const mathY = -((mouseY - app.canvas.height / 2) / app.scale) - app.offsetY;

        // تغییر مقیاس
        const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
        app.scale *= zoomFactor;

        // تنظیم جابجایی برای حفظ موقعیت موس
        app.offsetX = -(mathX * app.scale - mouseX + app.canvas.width / 2) / app.scale;
        app.offsetY = -(mathY * app.scale + mouseY - app.canvas.height / 2) / app.scale;

        // به‌روزرسانی اطلاعات مقیاس
        updateScaleInfo();

        // رسم مجدد نمودار
        drawGraph();
    });
}

// به‌روزرسانی نمایش مختصات
function updateCoordinates(e) {
    const app = window.graphApp;
    const rect = app.canvas.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    // تبدیل موقعیت موس به مختصات ریاضی
    const mathX = ((mouseX - app.canvas.width / 2) / app.scale) - app.offsetX;
    const mathY = -((mouseY - app.canvas.height / 2) / app.scale) - app.offsetY;

    // نمایش مختصات با دو رقم اعشار
    const coordElem = document.getElementById('coordinates');
    if (coordElem) {
        coordElem.textContent = `x: ${mathX.toFixed(2)}, y: ${mathY.toFixed(2)}`;
    }
}

// به‌روزرسانی اطلاعات مقیاس
function updateScaleInfo() {
    const app = window.graphApp;
    const scaleInfoElem = document.getElementById('scale-info');
    if (scaleInfoElem) {
        if (document.documentElement.lang === 'fa') {
            scaleInfoElem.innerHTML = `<span class="fa-lang">مقیاس: ${app.scale.toFixed(2)}:1</span>`;
        } else {
            scaleInfoElem.innerHTML = `<span class="en-lang">Scale: ${app.scale.toFixed(2)}:1</span>`;
        }
    }
}

// افزودن رویدادهای مربوط به دکمه‌ها
function setupButtonEvents() {
    const app = window.graphApp;

    // دکمه رسم تابع
    const drawBtn = document.getElementById('draw-btn');
    if (drawBtn) {
        drawBtn.addEventListener('click', function() {
            drawFunction();
        });
    }

    // دکمه رسم تابع پارامتری
    const drawParametricBtn = document.getElementById('draw-parametric-btn');
    if (drawParametricBtn) {
        drawParametricBtn.addEventListener('click', function() {
            drawParametricFunction();
        });
    }

    // دکمه رسم تابع قطبی
    const drawPolarBtn = document.getElementById('draw-polar-btn');
    if (drawPolarBtn) {
        drawPolarBtn.addEventListener('click', function() {
            drawPolarFunction();
        });
    }

    // دکمه اضافه کردن تابع جدید
    const addFunctionBtn = document.getElementById('add-function-btn');
    if (addFunctionBtn) {
        addFunctionBtn.addEventListener('click', function() {
            addNewFunctionInput();
        });
    }

    // دکمه حذف همه توابع
    const clearAllBtn = document.getElementById('clear-all-btn');
    if (clearAllBtn) {
        clearAllBtn.addEventListener('click', function() {
            clearAllFunctions();
        });
    }

    // دکمه‌های ابزار
    document.querySelectorAll('.tool-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            // حذف کلاس active از همه دکمه‌های ابزار
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));

            // اضافه کردن کلاس active به دکمه کلیک شده
            this.classList.add('active');

            // ذخیره ابزار فعال
            app.activeToolButton = this.id;

            // تغییر حالت نشانگر موس
            if (app.activeToolButton === 'pan-btn') {
                app.canvas.style.cursor = 'grab';
            } else if (app.activeToolButton === 'zoom-in-btn') {
                app.canvas.style.cursor = 'zoom-in';
                // اعمال زوم
                app.scale *= 1.2;
                updateScaleInfo();
                drawGraph();
            } else if (app.activeToolButton === 'zoom-out-btn') {
                app.canvas.style.cursor = 'zoom-out';
                // اعمال زوم
                app.scale *= 0.8;
                updateScaleInfo();
                drawGraph();
            } else if (app.activeToolButton === 'reset-btn') {
                resetView();
            } else if (app.activeToolButton === 'grid-btn') {
                toggleGrid();
            } else if (app.activeToolButton === 'axes-btn') {
                toggleAxes();
            } else if (app.activeToolButton === 'labels-btn') {
                toggleLabels();
            } else if (app.activeToolButton === 'save-btn') {
                saveImage();
            } else {
                app.canvas.style.cursor = 'default';
            }
        });
    });

    // دکمه‌های پیش‌نمایش
    document.querySelectorAll('.preset-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const preset = this.getAttribute('data-preset');
            loadPreset(preset);
        });
    });

    // دکمه باز/بسته کردن تنظیمات
    const settingsCollapseBtn = document.getElementById('settings-collapse-btn');
    if (settingsCollapseBtn) {
        settingsCollapseBtn.addEventListener('click', function() {
            const settingsBody = document.querySelector('.settings-body');
            settingsBody.classList.toggle('collapsed');
            this.classList.toggle('collapsed');

            // تغییر آیکون
            const icon = this.querySelector('i');
            if (settingsBody.classList.contains('collapsed')) {
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            } else {
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            }
        });
    }

    // دکمه اعمال محدوده
    const applyRangeBtn = document.getElementById('apply-range-btn');
    if (applyRangeBtn) {
        applyRangeBtn.addEventListener('click', function() {
            applyAxisRange();
        });
    }
}

// افزودن رویدادهای مربوط به تب‌ها
function setupTabEvents() {
    const app = window.graphApp;

    document.querySelectorAll('.tab-btn').forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');

            // حذف کلاس active از همه تب‌ها
            document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            // اضافه کردن کلاس active به تب انتخاب شده
            this.classList.add('active');
            document.getElementById(`${tabId}-tab`).classList.add('active');

            // ذخیره تب فعال
            app.currentTab = tabId;
        });
    });
}

// افزودن رویدادهای مربوط به تنظیمات
function setupSettingsEvents() {
    const app = window.graphApp;

    // تغییر ضخامت خط
    const lineWidthSlider = document.getElementById('line-width');
    const lineWidthValue = document.getElementById('line-width-value');

    if (lineWidthSlider && lineWidthValue) {
        lineWidthSlider.addEventListener('input', function() {
            app.lineWidth = parseInt(this.value);
            lineWidthValue.textContent = app.lineWidth;
            drawGraph();
        });
    }

    // تغییر کیفیت رسم
    const qualitySelect = document.getElementById('quality-select');
    if (qualitySelect) {
        qualitySelect.addEventListener('change', function() {
            app.renderQuality = this.value;
            drawGraph();
        });
    }
}

// تعیین تعداد نقاط براساس کیفیت رسم و نوع تابع
function getPointCount(funcType) {
    const app = window.graphApp;
    let baseCount;

    switch (app.renderQuality) {
        case 'low':
            baseCount = app.canvas.width / 8; // خیلی کمتر از قبل
            break;
        case 'medium':
            baseCount = app.canvas.width / 4;
            break;
        case 'high':
            baseCount = app.canvas.width / 2;
            break;
        default:
            baseCount = app.canvas.width / 4;
    }

    // برای توابع پارامتری و قطبی، تعداد نقاط کمتری استفاده کن
    if (funcType === 'parametric' || funcType === 'polar') {
        return Math.min(500, baseCount); // حداکثر 500 نقطه
    }

    return baseCount;
}

// رسم نمودار
function drawGraph() {
    const app = window.graphApp;
    if (!app.ctx || !app.canvas) return;

    // پاک کردن کانواس
    app.ctx.fillStyle = '#ffffff'; // همیشه پس‌زمینه سفید
    app.ctx.fillRect(0, 0, app.canvas.width, app.canvas.height);

    // رسم شبکه
    if (app.showGrid) {
        drawGrid();
    }

    // رسم محورها
    if (app.showAxes) {
        drawAxes();
    }

    // رسم توابع
    drawFunctions();
}

// رسم شبکه
function drawGrid() {
    const app = window.graphApp;
    app.ctx.strokeStyle = '#dddddd'; // همیشه شبکه خاکستری روشن
    app.ctx.lineWidth = 0.5;

    // فاصله بین خطوط شبکه براساس مقیاس
    let gridStep = 1;

    // تنظیم فاصله خطوط شبکه براساس مقیاس
    if (app.scale < 0.1) gridStep = 10;
    else if (app.scale < 0.5) gridStep = 5;
    else if (app.scale < 1) gridStep = 2;

    // محدود کردن تعداد خطوط شبکه به حداکثر 100 تا در هر جهت
    const maxLines = 100;
    const viewWidth = app.canvas.width / app.scale;
    const viewHeight = app.canvas.height / app.scale;

    if (viewWidth / gridStep > maxLines) {
        gridStep = Math.ceil(viewWidth / maxLines);
    }

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    // محاسبه محدوده قابل مشاهده
    const visibleXMin = -app.offsetX - app.canvas.width / (2 * app.scale);
    const visibleXMax = -app.offsetX + app.canvas.width / (2 * app.scale);
    const visibleYMin = -app.offsetY - app.canvas.height / (2 * app.scale);
    const visibleYMax = -app.offsetY + app.canvas.height / (2 * app.scale);

    // رسم خطوط عمودی
    for (let x = Math.floor(visibleXMin / gridStep) * gridStep; x <= Math.ceil(visibleXMax / gridStep) * gridStep; x += gridStep) {
        if (x === 0) continue; // محور y را جداگانه رسم می‌کنیم

        const screenX = toScreenX(x);
        app.ctx.beginPath();
        app.ctx.moveTo(screenX, 0);
        app.ctx.lineTo(screenX, app.canvas.height);
        app.ctx.stroke();
    }

    // رسم خطوط افقی
    for (let y = Math.floor(visibleYMin / gridStep) * gridStep; y <= Math.ceil(visibleYMax / gridStep) * gridStep; y += gridStep) {
        if (y === 0) continue; // محور x را جداگانه رسم می‌کنیم

        const screenY = toScreenY(y);
        app.ctx.beginPath();
        app.ctx.moveTo(0, screenY);
        app.ctx.lineTo(app.canvas.width, screenY);
        app.ctx.stroke();
    }
}

// رسم محورها
function drawAxes() {
    const app = window.graphApp;

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    app.ctx.strokeStyle = '#666666'; // همیشه محورها خاکستری تیره
    app.ctx.lineWidth = 2;

    // محور y
    const yAxisX = toScreenX(0);
    app.ctx.beginPath();
    app.ctx.moveTo(yAxisX, 0);
    app.ctx.lineTo(yAxisX, app.canvas.height);
    app.ctx.stroke();

    // محور x
    const xAxisY = toScreenY(0);
    app.ctx.beginPath();
    app.ctx.moveTo(0, xAxisY);
    app.ctx.lineTo(app.canvas.width, xAxisY);
    app.ctx.stroke();

    // رسم برچسب‌ها
    if (app.showLabels) {
        drawAxisLabels();
    }
}

// رسم برچسب‌های محورها
function drawAxisLabels() {
    const app = window.graphApp;

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    app.ctx.font = '12px Vazirmatn';
    app.ctx.fillStyle = '#666666'; // همیشه برچسب‌ها خاکستری تیره
    app.ctx.textAlign = 'center';
    app.ctx.textBaseline = 'middle';

    // محاسبه محدوده قابل مشاهده
    const visibleXMin = -app.offsetX - app.canvas.width / (2 * app.scale);
    const visibleXMax = -app.offsetX + app.canvas.width / (2 * app.scale);
    const visibleYMin = -app.offsetY - app.canvas.height / (2 * app.scale);
    const visibleYMax = -app.offsetY + app.canvas.height / (2 * app.scale);

    // تعیین فاصله بین برچسب‌ها براساس مقیاس
    let step = 1;
    if (app.scale < 0.1) step = 10;
    else if (app.scale < 0.5) step = 5;
    else if (app.scale < 1) step = 2;

    // محدود کردن تعداد برچسب‌ها به حداکثر 20 تا در هر محور
    const maxLabels = 20;
    const xRange = visibleXMax - visibleXMin;
    const yRange = visibleYMax - visibleYMin;

    if (xRange / step > maxLabels) {
        step = Math.ceil(xRange / maxLabels);
    }

    // برچسب‌های محور x
    for (let x = Math.floor(visibleXMin / step) * step; x <= Math.ceil(visibleXMax / step) * step; x += step) {
        if (x === 0) continue; // مبدأ را جداگانه رسم می‌کنیم

        const screenX = toScreenX(x);
        const screenY = toScreenY(0) + 20;

        // رسم خط کوچک
        app.ctx.beginPath();
        app.ctx.moveTo(screenX, toScreenY(0) - 5);
        app.ctx.lineTo(screenX, toScreenY(0) + 5);
        app.ctx.stroke();

        // رسم برچسب
        app.ctx.fillText(x, screenX, screenY);
    }

    // برچسب‌های محور y
    for (let y = Math.floor(visibleYMin / step) * step; y <= Math.ceil(visibleYMax / step) * step; y += step) {
        if (y === 0) continue; // مبدأ را جداگانه رسم می‌کنیم

        const screenX = toScreenX(0) - 20;
        const screenY = toScreenY(y);

        // رسم خط کوچک
        app.ctx.beginPath();
        app.ctx.moveTo(toScreenX(0) - 5, screenY);
        app.ctx.lineTo(toScreenX(0) + 5, screenY);
        app.ctx.stroke();

        // رسم برچسب
        app.ctx.fillText(y, screenX, screenY);
    }

    // رسم مبدأ مختصات
    app.ctx.fillText('0', toScreenX(0) - 15, toScreenY(0) + 15);
}

// رسم توابع
function drawFunctions() {
    const app = window.graphApp;

    // رسم هر تابع در آرایه توابع
    app.functions.forEach(function(func) {
        if (func.visible) {
            if (func.type === 'standard') {
                drawStandardFunction(func);
            } else if (func.type === 'parametric') {
                drawParametricFunction(func);
            } else if (func.type === 'polar') {
                drawPolarFunction(func);
            }
        }
    });
}

// رسم تابع استاندارد
function drawStandardFunction(func) {
    const app = window.graphApp;

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    app.ctx.strokeStyle = func.color;
    app.ctx.lineWidth = app.lineWidth;
    app.ctx.beginPath();

    // تعداد نقاط براساس کیفیت رسم
    const numPoints = getPointCount('standard');

    // محاسبه محدوده قابل مشاهده
    const visibleXMin = -app.offsetX - app.canvas.width / (2 * app.scale);
    const visibleXMax = -app.offsetX + app.canvas.width / (2 * app.scale);

    let isFirstPoint = true;
    let lastY = null;

    // رسم تابع
    for (let i = 0; i <= numPoints; i++) {
        const t = i / numPoints;
        const x = visibleXMin + (visibleXMax - visibleXMin) * t;

        try {
            // محاسبه y با استفاده از تابع کاربر
            const scope = { x: x };
            const y = math.evaluate(func.expression, scope);

            // بررسی معتبر بودن y
            if (isNaN(y) || !isFinite(y)) continue;

            // تبدیل به مختصات صفحه نمایش
            const screenX = toScreenX(x);
            const screenY = toScreenY(y);

            // بررسی پرش بزرگ (مجانب)
            if (!isFirstPoint && lastY !== null) {
                const deltaY = Math.abs(screenY - lastY);
                if (deltaY > 100) {
                    isFirstPoint = true;
                }
            }

            if (isFirstPoint) {
                app.ctx.moveTo(screenX, screenY);
                isFirstPoint = false;
            } else {
                app.ctx.lineTo(screenX, screenY);
            }

            lastY = screenY;
        } catch (error) {
            console.error('Error evaluating function:', error);
            isFirstPoint = true;
        }
    }

    app.ctx.stroke();
}

// رسم تابع پارامتری
function drawParametricFunction(func) {
    const app = window.graphApp;

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    app.ctx.strokeStyle = func.color;
    app.ctx.lineWidth = app.lineWidth;
    app.ctx.beginPath();

    // تعداد نقاط براساس کیفیت رسم
    const numPoints = getPointCount('parametric');

    let isFirstPoint = true;
    for (let i = 0; i <= numPoints; i++) {
        const t = func.tMin + (func.tMax - func.tMin) * (i / numPoints);

        try {
            // محاسبه x و y با استفاده از توابع پارامتری
            const scope = { t: t };
            const x = math.evaluate(func.xExpression, scope);
            const y = math.evaluate(func.yExpression, scope);

            // بررسی معتبر بودن x و y
            if (isNaN(x) || !isFinite(x) || isNaN(y) || !isFinite(y)) continue;

            // تبدیل به مختصات صفحه نمایش
            const screenX = toScreenX(x);
            const screenY = toScreenY(y);

            if (isFirstPoint) {
                app.ctx.moveTo(screenX, screenY);
                isFirstPoint = false;
            } else {
                app.ctx.lineTo(screenX, screenY);
            }
        } catch (error) {
            console.error('Error evaluating parametric function:', error);
            isFirstPoint = true;
        }
    }

    app.ctx.stroke();
}

// رسم تابع قطبی
function drawPolarFunction(func) {
    const app = window.graphApp;

    // تبدیل مختصات ریاضی به مختصات کانواس
    function toScreenX(x) {
        return (x + app.offsetX) * app.scale + app.canvas.width / 2;
    }

    function toScreenY(y) {
        return app.canvas.height - ((y + app.offsetY) * app.scale + app.canvas.height / 2);
    }

    app.ctx.strokeStyle = func.color;
    app.ctx.lineWidth = app.lineWidth;
    app.ctx.beginPath();

    // تعداد نقاط براساس کیفیت رسم
    const numPoints = getPointCount('polar');

    let isFirstPoint = true;

    // رسم تابع
    for (let i = 0; i <= numPoints; i++) {
        const theta = func.thetaMin + (func.thetaMax - func.thetaMin) * (i / numPoints);

        try {
            // محاسبه r با استفاده از تابع قطبی
            const scope = { theta: theta };
            const r = math.evaluate(func.rExpression, scope);

            // بررسی معتبر بودن r
            if (isNaN(r) || !isFinite(r)) continue;

            // تبدیل مختصات قطبی به دکارتی
            const x = r * Math.cos(theta);
            const y = r * Math.sin(theta);

            // تبدیل به مختصات صفحه نمایش
            const screenX = toScreenX(x);
            const screenY = toScreenY(y);

            if (isFirstPoint) {
                app.ctx.moveTo(screenX, screenY);
                isFirstPoint = false;
            } else {
                app.ctx.lineTo(screenX, screenY);
            }
        } catch (error) {
            console.error('Error evaluating polar function:', error);
            isFirstPoint = true;
        }
    }

    app.ctx.stroke();
}

// نمایش/مخفی کردن انیمیشن بارگذاری
function showLoading() {
    const loadingOverlay = document.getElementById('loading-overlay');
    if (loadingOverlay) {
        loadingOverlay.classList.add('active');
    }
}

function hideLoading() {
    setTimeout(function() {
        const loadingOverlay = document.getElementById('loading-overlay');
        if (loadingOverlay) {
            loadingOverlay.classList.remove('active');
        }
    }, 500);
}

// افزودن تابع استاندارد
function drawFunction() {
    const app = window.graphApp;

    // نمایش انیمیشن بارگذاری
    showLoading();

    // دریافت عبارت تابع و رنگ
    const expression = document.getElementById('function-input').value;
    const color = document.getElementById('function-color').value;

    // بررسی معتبر بودن عبارت
    try {
        // تست یک مقدار برای اطمینان از صحت عبارت
        const scope = { x: 1 };
        math.evaluate(expression, scope);

        // افزودن تابع به لیست
        const func = {
            type: 'standard',
            expression: expression,
            color: color,
            visible: true
        };

        app.functions.push(func);

        // به‌روزرسانی لیست توابع
        updateFunctionList();

        // رسم مجدد نمودار
        drawGraph();

        // نمایش اعلان موفقیت
        showToast('موفقیت', 'تابع با موفقیت رسم شد.', 'success');
    } catch (error) {
        console.error('Error parsing function:', error);
        showToast('خطا', 'عبارت تابع نامعتبر است. لطفاً بررسی کنید.', 'error');
    }

    // مخفی کردن انیمیشن بارگذاری
    hideLoading();
}

// افزودن تابع پارامتری
function drawParametricFunction() {
    const app = window.graphApp;

    // نمایش انیمیشن بارگذاری
    showLoading();

    // دریافت عبارات توابع و رنگ
    const xExpression = document.getElementById('parametric-x').value;
    const yExpression = document.getElementById('parametric-y').value;
    const tMin = parseFloat(document.getElementById('t-min').value);
    const tMax = parseFloat(document.getElementById('t-max').value);
    const color = document.getElementById('parametric-color').value;

    try {
        // تست یک مقدار برای اطمینان از صحت عبارات
        const scope = { t: 0 };
        math.evaluate(xExpression, scope);
        math.evaluate(yExpression, scope);

        // افزودن تابع به لیست
        const func = {
            type: 'parametric',
            xExpression: xExpression,
            yExpression: yExpression,
            tMin: tMin,
            tMax: tMax,
            color: color,
            visible: true
        };

        app.functions.push(func);

        // به‌روزرسانی لیست توابع
        updateFunctionList();

        // رسم مجدد نمودار
        drawGraph();

        // نمایش اعلان موفقیت
        showToast('موفقیت', 'تابع پارامتری با موفقیت رسم شد.', 'success');
    } catch (error) {
        console.error('Error parsing parametric function:', error);
        showToast('خطا', 'عبارات تابع پارامتری نامعتبر هستند. لطفاً بررسی کنید.', 'error');
    }

    // مخفی کردن انیمیشن بارگذاری
    hideLoading();
}

// افزودن تابع قطبی
function drawPolarFunction() {
    const app = window.graphApp;

    // نمایش انیمیشن بارگذاری
    showLoading();

    // دریافت عبارت تابع و رنگ
    const rExpression = document.getElementById('polar-input').value;
    const thetaMin = parseFloat(document.getElementById('theta-min').value);
    const thetaMax = parseFloat(document.getElementById('theta-max').value);
    const color = document.getElementById('polar-color').value;

    // بررسی معتبر بودن عبارت
    try {
        // تست یک مقدار برای اطمینان از صحت عبارت
        const scope = { theta: 0 };
        math.evaluate(rExpression, scope);

        // افزودن تابع به لیست
        const func = {
            type: 'polar',
            rExpression: rExpression,
            thetaMin: thetaMin,
            thetaMax: thetaMax,
            color: color,
            visible: true
        };

        app.functions.push(func);

        // به‌روزرسانی لیست توابع
        updateFunctionList();

        // رسم مجدد نمودار
        drawGraph();

        // نمایش اعلان موفقیت
        showToast('موفقیت', 'تابع قطبی با موفقیت رسم شد.', 'success');
    } catch (error) {
        console.error('Error parsing polar function:', error);
        showToast('خطا', 'عبارت تابع قطبی نامعتبر است. لطفاً بررسی کنید.', 'error');
    }

    // مخفی کردن انیمیشن بارگذاری
    hideLoading();
}

// به‌روزرسانی لیست توابع در رابط کاربری
function updateFunctionList() {
    const app = window.graphApp;
    const functionList = document.getElementById('function-list');
    if (!functionList) return;

    functionList.innerHTML = '';

    app.functions.forEach(function(func, index) {
        const functionItem = document.createElement('div');
        functionItem.className = 'function-item';

        let displayText = '';
        if (func.type === 'standard') {
            displayText = `f(x) = ${func.expression}`;
        } else if (func.type === 'parametric') {
            displayText = `x(t) = ${func.xExpression}, y(t) = ${func.yExpression}`;
        } else if (func.type === 'polar') {
            displayText = `r(θ) = ${func.rExpression}`;
        }

        functionItem.innerHTML = `
            <div class="function-item-color" style="background-color: ${func.color}"></div>
            <div class="function-item-text">${displayText}</div>
            <div class="function-item-actions">
                <button class="function-item-btn visibility-btn" data-index="${index}">
                    <i class="fas ${func.visible ? 'fa-eye' : 'fa-eye-slash'}"></i>
                </button>
                <button class="function-item-btn delete-btn" data-index="${index}">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>
        `;

        functionList.appendChild(functionItem);
    });

    // افزودن رویدادها به دکمه‌های لیست توابع
    addFunctionListEvents();
}

// افزودن رویدادها به دکمه‌های لیست توابع
function addFunctionListEvents() {
    const app = window.graphApp;

    // دکمه‌های نمایش/عدم نمایش
    document.querySelectorAll('.visibility-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            app.functions[index].visible = !app.functions[index].visible;

            // به‌روزرسانی آیکون
            const icon = this.querySelector('i');
            icon.classList.toggle('fa-eye');
            icon.classList.toggle('fa-eye-slash');

            // رسم مجدد نمودار
            drawGraph();
        });
    });

    // دکمه‌های حذف
    document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            app.functions.splice(index, 1);

            // به‌روزرسانی لیست توابع
            updateFunctionList();

            // رسم مجدد نمودار
            drawGraph();

            // نمایش اعلان
            showToast('اطلاعات', 'تابع با موفقیت حذف شد.', 'info');
        });
    });
}

// افزودن فیلد ورودی تابع جدید
function addNewFunctionInput() {
    // پاک کردن فیلد ورودی تابع
    const functionInput = document.getElementById('function-input');
    if (functionInput) {
        functionInput.value = '';
    }

    // تغییر رنگ به یک رنگ تصادفی
    const randomColor = getRandomColor();
    const functionColor = document.getElementById('function-color');
    if (functionColor) {
        functionColor.value = randomColor;
    }

    // نمایش اعلان
    showToast('اطلاعات', 'فیلد ورودی برای تابع جدید آماده است.', 'info');
}

// تولید رنگ تصادفی
function getRandomColor() {
    const letters = '0123456789ABCDEF';
    let color = '#';
    for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
}

// حذف همه توابع
function clearAllFunctions() {
    const app = window.graphApp;

    if (app.functions.length === 0) {
        showToast('اطلاعات', 'هیچ تابعی برای حذف وجود ندارد.', 'info');
        return;
    }

    app.functions = [];

    // به‌روزرسانی لیست توابع
    updateFunctionList();

    // رسم مجدد نمودار
    drawGraph();

    // نمایش اعلان
    showToast('موفقیت', 'همه توابع با موفقیت حذف شدند.', 'success');
}

// بازنشانی نما
function resetView() {
    const app = window.graphApp;

    app.scale = 1;
    app.offsetX = 0;
    app.offsetY = 0;

    // به‌روزرسانی اطلاعات مقیاس
    updateScaleInfo();

    // رسم مجدد نمودار
    drawGraph();

    // نمایش اعلان
    showToast('اطلاعات', 'نما به حالت اولیه بازنشانی شد.', 'info');
}

// نمایش/عدم نمایش شبکه
function toggleGrid() {
    const app = window.graphApp;
    app.showGrid = !app.showGrid;

    // رسم مجدد نمودار
    drawGraph();
}

// نمایش/عدم نمایش محورها
function toggleAxes() {
    const app = window.graphApp;
    app.showAxes = !app.showAxes;

    // رسم مجدد نمودار
    drawGraph();
}

// نمایش/عدم نمایش برچسب‌ها
function toggleLabels() {
    const app = window.graphApp;
    app.showLabels = !app.showLabels;

    // رسم مجدد نمودار
    drawGraph();
}

// اعمال محدوده جدید محورها
function applyAxisRange() {
    const app = window.graphApp;

    const xMinElem = document.getElementById('x-min');
    const xMaxElem = document.getElementById('x-max');
    const yMinElem = document.getElementById('y-min');
    const yMaxElem = document.getElementById('y-max');

    if (!xMinElem || !xMaxElem || !yMinElem || !yMaxElem) return;

    const newXMin = parseFloat(xMinElem.value);
    const newXMax = parseFloat(xMaxElem.value);
    const newYMin = parseFloat(yMinElem.value);
    const newYMax = parseFloat(yMaxElem.value);

    // بررسی معتبر بودن محدوده
    if (newXMin >= newXMax || newYMin >= newYMax) {
        showToast('خطا', 'محدوده نامعتبر است. مقدار حداکثر باید بزرگتر از مقدار حداقل باشد.', 'error');
        return;
    }

    // تنظیم مقادیر جدید
    app.xMin = newXMin;
    app.xMax = newXMax;
    app.yMin = newYMin;
    app.yMax = newYMax;

    // تنظیم مقیاس و جابجایی براساس محدوده جدید
    const canvasWidth = app.canvas.width;
    const canvasHeight = app.canvas.height;

    const scaleX = canvasWidth / (app.xMax - app.xMin);
    const scaleY = canvasHeight / (app.yMax - app.yMin);

    // استفاده از کوچکترین مقیاس برای حفظ نسبت ابعاد
    app.scale = Math.min(scaleX, scaleY) * 0.9;

    // تنظیم جابجایی
    app.offsetX = -(app.xMin + app.xMax) / 2;
    app.offsetY = -(app.yMin + app.yMax) / 2;

    // به‌روزرسانی اطلاعات مقیاس
    updateScaleInfo();

    // رسم مجدد نمودار
    drawGraph();

    // نمایش اعلان
    showToast('موفقیت', 'محدوده محورها با موفقیت اعمال شد.', 'success');
}

// ذخیره تصویر نمودار
function saveImage() {
    const app = window.graphApp;

    // ایجاد لینک دانلود
    const link = document.createElement('a');
    link.download = 'graph.png';

    // تبدیل کانواس به URL داده
    link.href = app.canvas.toDataURL('image/png');

    // کلیک روی لینک برای دانلود
    link.click();

    // نمایش اعلان
    showToast('موفقیت', 'تصویر نمودار با موفقیت ذخیره شد.', 'success');
}

// بارگذاری پیش‌نمایش‌های آماده
function loadPreset(preset) {
    const app = window.graphApp;

    // نمایش انیمیشن بارگذاری
    showLoading();

    try {
        // حذف همه توابع قبلی
        app.functions = [];

        // تنظیم محدوده محورها و توابع براساس پیش‌نمایش انتخاب شده
        switch (preset) {
            case 'parabola': // سهمی
                app.functions.push({
                    type: 'standard',
                    expression: 'x^2',
                    color: '#0066cc',
                    visible: true
                });
                // تنظیم محدوده مناسب برای سهمی
                app.xMin = -5;
                app.xMax = 5;
                app.yMin = -2;
                app.yMax = 25;
                break;

            case 'sine': // سینوسی
                app.functions.push({
                    type: 'standard',
                    expression: 'sin(x)',
                    color: '#e91e63',
                    visible: true
                });
                // تنظیم محدوده مناسب برای تابع سینوسی
                app.xMin = -10;
                app.xMax = 10;
                app.yMin = -1.5;
                app.yMax = 1.5;
                break;

            case 'circle': // دایره - از تابع استاندارد استفاده میکنیم
                app.functions.push({
                    type: 'standard',
                    expression: 'sqrt(9-x^2)',  // نیم دایره بالایی
                    color: '#4caf50',
                    visible: true
                });
                app.functions.push({
                    type: 'standard',
                    expression: '-sqrt(9-x^2)', // نیم دایره پایینی
                    color: '#4caf50',
                    visible: true
                });
                // تنظیم محدوده مناسب برای دایره
                app.xMin = -4;
                app.xMax = 4;
                app.yMin = -4;
                app.yMax = 4;
                break;

            case 'flower': // گل - از تابع استاندارد استفاده میکنیم
                app.functions.push({
                    type: 'standard',
                    expression: 'sqrt(25-x^2)*cos(x)',
                    color: '#ff9800',
                    visible: true
                });
                app.functions.push({
                    type: 'standard',
                    expression: '-sqrt(25-x^2)*cos(x)',
                    color: '#ff9800',
                    visible: true
                });
                // تنظیم محدوده مناسب برای گل
                app.xMin = -6;
                app.xMax = 6;
                app.yMin = -6;
                app.yMax = 6;
                break;

            case 'heart': // قلب - از تابع استاندارد استفاده میکنیم با منحنی ساده‌تر
                app.functions.push({
                    type: 'standard',
                    expression: 'sqrt(1-abs(x))*cos(pi*x)',
                    color: '#f44336',
                    visible: true
                });
                app.functions.push({
                    type: 'standard',
                    expression: '-sqrt(1-abs(x))*cos(pi*x)',
                    color: '#f44336',
                    visible: true
                });
                // تنظیم محدوده مناسب برای قلب
                app.xMin = -2;
                app.xMax = 2;
                app.yMin = -2;
                app.yMax = 2;
                break;

            case 'butterfly': // پروانه - از تابع استاندارد استفاده میکنیم با منحنی ساده‌تر
                app.functions.push({
                    type: 'standard',
                    expression: 'sin(x)*(exp(cos(x))-2*cos(4*x))/5',
                    color: '#9c27b0',
                    visible: true
                });
                // تنظیم محدوده مناسب برای پروانه
                app.xMin = -4;
                app.xMax = 4;
                app.yMin = -1;
                app.yMax = 1;
                break;
        }

        // تنظیم مقیاس و جابجایی براساس محدوده جدید
        const canvasWidth = app.canvas.width;
        const canvasHeight = app.canvas.height;

        const scaleX = canvasWidth / (app.xMax - app.xMin);
        const scaleY = canvasHeight / (app.yMax - app.yMin);

        // استفاده از کوچکترین مقیاس برای حفظ نسبت ابعاد
        app.scale = Math.min(scaleX, scaleY) * 0.9;

        // تنظیم جابجایی
        app.offsetX = -(app.xMin + app.xMax) / 2;
        app.offsetY = -(app.yMin + app.yMax) / 2;

        // به‌روزرسانی فیلدهای ورودی محدوده
        const xMinElem = document.getElementById('x-min');
        const xMaxElem = document.getElementById('x-max');
        const yMinElem = document.getElementById('y-min');
        const yMaxElem = document.getElementById('y-max');

        if (xMinElem) xMinElem.value = app.xMin;
        if (xMaxElem) xMaxElem.value = app.xMax;
        if (yMinElem) yMinElem.value = app.yMin;
        if (yMaxElem) yMaxElem.value = app.yMax;

        // تنظیم کیفیت رسم به پایین برای اشکال پیچیده
        if (preset === 'heart' || preset === 'butterfly') {
            const qualitySelect = document.getElementById('quality-select');
            if (qualitySelect) {
                qualitySelect.value = 'low';
                app.renderQuality = 'low';
            }
        }

        // به‌روزرسانی لیست توابع
        updateFunctionList();

        // به‌روزرسانی اطلاعات مقیاس
        updateScaleInfo();

        // رسم مجدد نمودار
        drawGraph();

        // نمایش اعلان
        showToast('موفقیت', `پیش‌نمایش "${preset}" با موفقیت بارگذاری شد.`, 'success');
    } catch (error) {
        console.error('Error loading preset:', error);
        showToast('خطا', 'خطا در بارگذاری پیش‌نمایش. لطفاً دوباره تلاش کنید.', 'error');
    }

    // مخفی کردن انیمیشن بارگذاری
    hideLoading();
}

// نمایش اعلان
function showToast(title, message, type) {
    // ایجاد المان اعلان
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;

    // انتخاب آیکون مناسب براساس نوع اعلان
    let icon = '';
    switch (type) {
        case 'success':
            icon = '<i class="fas fa-check-circle"></i>';
            break;
        case 'error':
            icon = '<i class="fas fa-exclamation-circle"></i>';
            break;
        case 'warning':
            icon = '<i class="fas fa-exclamation-triangle"></i>';
            break;
        case 'info':
            icon = '<i class="fas fa-info-circle"></i>';
            break;
    }

    // تنظیم محتوای اعلان
    toast.innerHTML = `
        <div class="toast-icon">${icon}</div>
        <div class="toast-content">
            <div class="toast-title">${title}</div>
            <div class="toast-message">${message}</div>
        </div>
        <button class="toast-close">&times;</button>
    `;

    // افزودن اعلان به ظرف اعلان‌ها
    const toastContainer = document.getElementById('toast-container');
    if (toastContainer) {
        toastContainer.appendChild(toast);

        // نمایش اعلان با تاخیر کوتاه
        setTimeout(() => {
            toast.classList.add('show');
        }, 10);

        // حذف اعلان پس از 3 ثانیه
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => {
                toast.remove();
            }, 300);
        }, 3000);

        // افزودن رویداد کلیک به دکمه بستن
        const closeBtn = toast.querySelector('.toast-close');
        if (closeBtn) {
            closeBtn.addEventListener('click', function() {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            });
        }
    }
}

// به‌روزرسانی متن‌های زبان
function updateGraphPageLanguage() {
    const isEnglish = document.documentElement.lang === 'en';

    // به‌روزرسانی مقیاس
    updateScaleInfo();

    // به‌روزرسانی کیفیت رسم
    const qualitySelect = document.getElementById('quality-select');
    if (qualitySelect) {
        // حذف گزینه‌های قبلی
        while (qualitySelect.firstChild) {
            qualitySelect.removeChild(qualitySelect.firstChild);
        }

        // افزودن گزینه‌های جدید
        const options = [
            { value: 'low', fa: 'پایین (سریع)', en: 'Low (Fast)' },
            { value: 'medium', fa: 'متوسط', en: 'Medium' },
            { value: 'high', fa: 'بالا (کند)', en: 'High (Slow)' }
        ];

        options.forEach(option => {
            const optElement = document.createElement('option');
            optElement.value = option.value;
            optElement.textContent = isEnglish ? option.en : option.fa;
            if (option.value === window.graphApp.renderQuality) {
                optElement.selected = true;
            }
            qualitySelect.appendChild(optElement);
        });
    }

    // رسم مجدد نمودار برای به‌روزرسانی برچسب‌ها
    if (window.graphApp.initialized) {
        drawGraph();
    }
}

// اضافه کردن رویداد تغییر زبان برای صفحه رسم نمودار
document.addEventListener('languageChanged', function() {
    updateGraphPageLanguage();
});

// اضافه کردن رویداد تغییر تم برای صفحه رسم نمودار
document.addEventListener('themeChanged', function() {
    if (window.graphApp.initialized) {
        drawGraph();
    }
});

// بررسی تغییر زبان و به‌روزرسانی متن‌ها
function checkLanguageAndUpdate() {
    // به‌روزرسانی متن‌های نمایشی به زبان جدید
    updateGraphPageLanguage();
}

// ایجاد رویداد تغییر زبان
function createLanguageEvent() {
    // این تابع باید در فایل اصلی سایت فراخوانی شود
    const event = new Event('languageChanged');
    document.dispatchEvent(event);
}

// ایجاد رویداد تغییر تم
function createThemeEvent() {
    // این تابع باید در فایل اصلی سایت فراخوانی شود
    const event = new Event('themeChanged');
    document.dispatchEvent(event);
}

// اضافه کردن این توابع به window برای دسترسی از خارج
window.showGraphPage = showGraphPage;
window.closeGraphPage = closeGraphPage;
window.createLanguageEvent = createLanguageEvent;
window.createThemeEvent = createThemeEvent;

     // تنظیمات هوش مصنوعی
document.addEventListener('DOMContentLoaded', function() {
    // یافتن دکمه هوش مصنوعی در صفحه اصلی و اضافه کردن رویداد کلیک
    const aiButton = document.querySelector('.icon-button:nth-child(5)');
    if (aiButton) {
        aiButton.addEventListener('click', function() {
            showAIPage();
        });
    }

    // تنظیم رویدادهای مربوط به صفحه هوش مصنوعی
    setupAIPage();
});

// نمایش صفحه هوش مصنوعی
function showAIPage() {
    const aiPage = document.getElementById('aiPage');
    if (aiPage) {
        aiPage.classList.add('active');
    } else {
        console.error('AI page element not found');
    }
}

// بستن صفحه هوش مصنوعی
function closeAIPage() {
    const aiPage = document.getElementById('aiPage');
    if (aiPage) {
        aiPage.classList.remove('active');
        resetAIPage(); // بازگشت به حالت اولیه
    }
}

// بازگشت به حالت اولیه
function resetAIPage() {
    const aiIntro = document.getElementById('aiIntro');
    const chatInterface = document.getElementById('chatInterface');

    if (aiIntro && chatInterface) {
        aiIntro.classList.remove('hidden');
        chatInterface.classList.remove('active');
    }

    // پاک کردن پیام‌های قبلی (به جز پیام خوش‌آمدگویی)
    const chatMessages = document.getElementById('chatMessages');
    if (chatMessages) {
        const welcomeMessage = chatMessages.querySelector('.bot-message');
        chatMessages.innerHTML = '';
        if (welcomeMessage) {
            chatMessages.appendChild(welcomeMessage);
        }
    }

    // پاک کردن فیلد ورودی
    const userInput = document.getElementById('userInput');
    if (userInput) {
        userInput.value = '';
        userInput.style.height = 'auto';
    }
}

// باز کردن رابط چت
function openChatInterface() {
    const aiIntro = document.getElementById('aiIntro');
    const chatInterface = document.getElementById('chatInterface');

    if (aiIntro && chatInterface) {
        aiIntro.classList.add('hidden');
        setTimeout(() => {
            chatInterface.classList.add('active');
            const userInput = document.getElementById('userInput');
            if (userInput) {
                userInput.focus();
            }
        }, 300);
    }
}

// تنظیم رویدادهای مربوط به صفحه هوش مصنوعی
function setupAIPage() {
    // دکمه بازگشت
    const backButton = document.getElementById('aiBackButton');
    if (backButton) {
        backButton.addEventListener('click', function() {
            closeAIPage();
        });
    }

    // دکمه شروع گفتگو
    const startChatBtn = document.getElementById('startChatBtn');
    const startChatBtnEn = document.getElementById('startChatBtnEn');

    if (startChatBtn) {
        startChatBtn.addEventListener('click', function() {
            openChatInterface();
        });
    }

    if (startChatBtnEn) {
        startChatBtnEn.addEventListener('click', function() {
            openChatInterface();
        });
    }

    // انتخاب مدل
    const modelSelectBtn = document.getElementById('modelSelectBtn');
    const modelDropdown = document.getElementById('modelDropdown');
    const modelOptions = document.querySelectorAll('.model-option');

    if (!modelSelectBtn || !modelDropdown) {
        return;
    }

    // مدل پیش‌فرض
    let selectedModel = "gpt-4o";

    // باز و بسته کردن منوی انتخاب مدل
    modelSelectBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        modelSelectBtn.classList.toggle('active');
        modelDropdown.classList.toggle('active');
    });

    // انتخاب مدل
    modelOptions.forEach(option => {
        option.addEventListener('click', function(e) {
            e.stopPropagation();

            // حذف کلاس active از همه گزینه‌ها
            modelOptions.forEach(opt => opt.classList.remove('active'));

            // اضافه کردن کلاس active به گزینه انتخاب شده
            this.classList.add('active');

            // ذخیره مدل انتخاب شده
            selectedModel = this.getAttribute('data-model');

            // نمایش مدل انتخاب شده در دکمه
            const modelName = this.textContent;
            const btnText = document.documentElement.lang === 'fa' ? 'مدل: ' + modelName : 'Model: ' + modelName;
            modelSelectBtn.innerHTML = btnText + '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>';

            // بستن منوی انتخاب مدل
            modelDropdown.classList.remove('active');
            modelSelectBtn.classList.remove('active');
        });
    });

    // بستن منوی انتخاب مدل با کلیک بیرون از آن
    document.addEventListener('click', function(event) {
        if (modelSelectBtn && modelDropdown && !modelSelectBtn.contains(event.target) && !modelDropdown.contains(event.target)) {
            modelDropdown.classList.remove('active');
            modelSelectBtn.classList.remove('active');
        }
    });

    // ارسال پیام کاربر
    const userInput = document.getElementById('userInput');
    const sendButton = document.getElementById('sendButton');
    const chatMessages = document.getElementById('chatMessages');

    if (!userInput || !sendButton || !chatMessages) {
        return;
    }

    // تنظیم ارتفاع خودکار برای textarea
    userInput.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
        if (this.scrollHeight > 150) {
            this.style.overflowY = 'auto';
        } else {
            this.style.overflowY = 'hidden';
        }
    });

    // ارسال پیام با دکمه Enter
    userInput.addEventListener('keydown', function(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            sendMessage();
        }
    });

    // ارسال پیام با دکمه ارسال
    sendButton.addEventListener('click', sendMessage);

    // تابع ارسال پیام
    function sendMessage() {
        const message = userInput.value.trim();
        if (message === '') return;

        // نمایش پیام کاربر
        addUserMessage(message);

        // پاک کردن فیلد ورودی
        userInput.value = '';
        userInput.style.height = 'auto';

        // نمایش نشانگر در حال تایپ
        addTypingIndicator();

        // ارسال پیام به API
        sendToAPI(message, selectedModel);
    }

    // اضافه کردن پیام کاربر به چت
    function addUserMessage(message) {
        const messageElement = document.createElement('div');
        messageElement.className = 'message user-message';

        messageElement.innerHTML = `
            <div class="message-avatar">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </div>
            <div class="message-content">
                <p>${message.replace(/\n/g, '<br>')}</p>
            </div>
        `;

        chatMessages.appendChild(messageElement);
        scrollToBottom();
    }

    // اضافه کردن پیام بات به چت
    function addBotMessage(message) {
        // حذف نشانگر در حال تایپ
        const typingIndicator = document.querySelector('.typing-indicator');
        if (typingIndicator) {
            typingIndicator.parentElement.parentElement.remove();
        }

        const messageElement = document.createElement('div');
        messageElement.className = 'message bot-message';

        // پردازش کد و فرمول‌های ریاضی در پیام
        let processedMessage = message;

        // تبدیل کد به بلوک کد
        processedMessage = processedMessage.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');

        // تبدیل خط جدید به <br>
        processedMessage = processedMessage.replace(/\n/g, '<br>');

        messageElement.innerHTML = `
            <div class="message-avatar">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="40" fill="#0066cc" />
                    <path d="M30 50 Q50 20 70 50 Q50 80 30 50 Z" fill="white" />
                </svg>
            </div>
            <div class="message-content">
                <p>${processedMessage}</p>
            </div>
        `;

        chatMessages.appendChild(messageElement);
        scrollToBottom();
    }

    // اضافه کردن نشانگر در حال تایپ
    function addTypingIndicator() {
        const typingElement = document.createElement('div');
        typingElement.className = 'message bot-message';

        typingElement.innerHTML = `
            <div class="message-avatar">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="40" fill="#0066cc" />
                    <path d="M30 50 Q50 20 70 50 Q50 80 30 50 Z" fill="white" />
                </svg>
            </div>
            <div class="message-content">
                <div class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        `;

        chatMessages.appendChild(typingElement);
        scrollToBottom();
    }

    // اسکرول به پایین چت
    function scrollToBottom() {
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // ارسال پیام به API
    function sendToAPI(message, model) {
        // تنظیم پیام با محدودیت مربوط به ریاضی
        const messages = [
            {
                "role": "system",
                "content": "شما یک دستیار هوش مصنوعی متخصص در ریاضیات هستید. لطفاً فقط به سؤالات مرتبط با ریاضی پاسخ دهید و از راهنمایی و کمک در زمینه‌های دیگر خودداری کنید. در صورتی که سؤال مرتبط با ریاضی نباشد، با احترام توضیح دهید که فقط می‌توانید در زمینه ریاضیات کمک کنید. سعی کنید پاسخ‌های خود را با مثال‌ها و توضیحات روشن همراه کنید تا به درک بهتر مفاهیم ریاضی کمک نمایید."
            },
            {
                "role": "user",
                "content": message
            }
        ];

        // تنظیمات درخواست API
        const apiKey = "sk-rRbtNpsqbiXliS4wJtTPx5HUz3qH46CTiDJM9VYk";
        const url = "https://free.yunwu.ai/v1/chat/completions";

        fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${apiKey}`
            },
            body: JSON.stringify({
                model: model,
                messages: messages
            })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const reply = data.choices[0].message.content;
            addBotMessage(reply);
        })
        .catch(error => {
            addBotMessage("متأسفانه خطایی در ارتباط با سرور رخ داد. لطفاً دوباره تلاش کنید.");
        });
    }
}



</script>
</body>
</html>
